window.Xwb||(Xwb={});
(function(q,l){var u=document,t=RegExp("(?:^\\s*)|(?:\\s*$)","g");window.__debug=!!window.__debug;var o=0,m=u.selection;if(window.__debug===false)window.onerror=function(){return true};var g=q.util={templ:function(a,e,k,s){return a.replace(/\{([\w_$]+)\}/g,function(d,j){var p=e[j];if(s&&typeof p==="string")p=argument.callee(p,e,k,s);if(p===void 0||p===null)return"";return k?encodeURIComponent(p):p})},extendIf:function(a,e){a||(a={});if(e)for(var k in e)if(a[k]===void 0)a[k]=e[k];return a},extend:function(a,
e,k){a||(a={});if(e)for(var s in e)if(a[s]===void 0||k)a[s]=e[s];return a},trim:function(a){return a.replace(t,"")},queryString:function(a){if(!a)return"";var e=[],k;for(k in a){var s=a[k];k=encodeURIComponent(k);var d=typeof s;if(d==="undefined")e.push(k,"=&");else if(d!="function"&&d!="object")e.push(k,"=",encodeURIComponent(s),"&");else if(s instanceof Array)if(s.length){d=0;for(var j=s.length;d<j;d++)e.push(k,"=",encodeURIComponent(s[d]===void 0?"":s[d]),"&")}else e.push(k,"=&");else if(d==="object")for(var p in s)e.push(k,
"[",p,"]","=",encodeURIComponent(s[p]),"&")}e.pop();return e.join("")},bind:function(a,e){return function(){return a.apply(e,arguments)}},ajax:function(a){var e,k=a.url;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(s){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}}if(e){a.method=a.method?a.method.toUpperCase():"GET";var j=a.data,p=!a.cache;if(j||p){var r=k.indexOf("?")>=0;if(p)k=r?k+"&_="+ +new Date:k+"?_="+ +new Date;
if(j){if(typeof j==="object")j=g.queryString(j);if(a.method==="GET"){if(!r&&!p)k+="?";k=k+"&"+j}}}e.open(a.method,k,true);if(a.method==="POST")e.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset="+(a.encoding?a.encoding:""));e.onreadystatechange=function(){if(e.readyState===4){var w=e.status===200;if(w&&a.success){try{var x=!a.dt||a.dt==="json"?eval("("+e.responseText+");"):e.responseText}catch(y){__debug&&console.error("服务器返回JSON格式有误，请检查。\n",y,"\n",e.responseText);w=false}if(w)a.success.call(a.scope||
this,x,e)}if(!w&&a.failure)a.failure.call(a.scope||this,e.responseText,e)}};e.send("POST"===a.method?j:void 0);return e}},jsonp:function(a){function e(){if(!r){try{delete window[k];j.parentNode.removeChild(j);j=null}catch(w){}r=true}}var k="jsonp_"+ +new Date,s=a.doc||document,d=a.url,j=s.createElement("script");s=s.getElementsByTagName("head")[0];var p;if(typeof a=="function"){p=a;a={}}else p=a.success;j.type="text/javascript";a.charset&&(j.charset=a.charset);a.deffer&&(j.deffer=a.deffer);d+=d.indexOf("?")>=
0?"&"+(a.jsonp||"jsonp")+"="+k:"?"+(a.jsonp||"jsonp")+"="+k;if(a.data)d+="&"+g.queryString(a.data);if(a.script){g.extend(j,a.script);delete a.script}j.src=d;var r=false;window[k]=function(){e();if(p)p.apply(a.scope||this,arguments)};j.onreadystatechange=j.onload=function(){var w=this.readyState;if(!r&&(!w||w==="loaded"||w==="complete")){e();if(a.failure)a.failure.call(a.scope||this)}};s.appendChild(j);return j},arrayRemove:function(a,e){a.splice(e,1)},arrayIndexOf:function(a,e){for(var k=0,s=a.length;k<
s;k++)if(a[k]===e)return k;return-1},create:function(){var a=function(){this.init.apply(this,arguments)};if(arguments.length===0)return a;var e,k,s,d=l.makeArray(arguments);if(typeof d[0]==="string"){s=d[0];k=d[1];d.shift()}else k=d[0];d.shift();if(k)k=k.prototype;if(k){e=function(){};e.prototype=k;a.prototype=e=new e}if(s){e.type=s;g.ns(s,a)}s=0;for(var j=d.length;s<j;s++)e=l.extend(e,typeof d[s]==="function"?d[s](k):d[s]);return e.constructor=a},domUp:function(a,e,k){k=k||u.body;for(var s=typeof e===
"string";a;){if(s){if(l(a).is(e))break}else if(e(a))break;a=a.parentNode;if(a===k)return null}return a},ns:function(a,e){for(var k=a.split("."),s=window,d,j=0,p=k.length-1;j<p;j++){d=k[j];s[d]||(s[d]={});s=s[d]}s[k[j]]=e},calWbText:function(a,e){if(e===void 0)e=140;var k=a.match(/[^\x00-\xff]/g);return Math.floor((e*2-a.length-(k&&k.length||0))/2)},byteLen:function(a){var e=a.length;if(a=a.match(/[^\x00-\xff]/g))e+=a.length;return e},byteCut:function(a,e){if(g.byteLen(a)>e){var k=a.replace(/&/g," ").replace(/[^\x00-\xff]/g,
"&&");a=a.slice(0,k.slice(0,e).replace(/&&/g," ").replace(/&/g,"").length)}return a},stringReplace:function(a,e,k,s){return a.substring(0,k)+e+a.substring(s)},focusEnd:function(a,e){a.focus();if(e===void 0)e=a.value.length;if(u.selection){var k=a.createTextRange();k.collapse();k.moveStart("character",e);k.moveEnd("character",e);k.select()}else a.selectionStart=a.selectionEnd=e},selectionStart:function(a){if(!m)return a.selectionStart;var e=m.createRange(),k,s=u.body.createTextRange();s.moveToElementText(a);
try{for(k=0;s.compareEndPoints("StartToStart",e)<0;k++)s.moveStart("character",1)}catch(d){k=this.getCursorPos(a)}return k},selectionBefore:function(a){return a.value.slice(0,this.selectionStart(a))},selectText:function(a,e,k){a.focus();if(m){a=a.createTextRange();a.collapse(1);a.moveStart("character",e);a.moveEnd("character",k-e);a.select()}else a.setSelectionRange(e,k)},hasSelectionSupport:function(){return!l.browser.msie},getCursorPos:function(a){var e=0;if(this.hasSelectionSupport()){if(a.selectionStart||
a.selectionStart=="0")e=a.selectionStart}else try{a.focus();var k=null;k=m.createRange();var s=k.duplicate();s.moveToElementText(a);s.setEndPoint("EndToEnd",k);a.selectionStart=s.text.length-k.text.length;a.selectionEnd=a.selectionStart+k.text.length;e=a.selectionStart}catch(d){}return e},getSelectionText:function(a){var e="";return e=window.getSelection?a.selectionStart!=void 0&&a.selectionEnd!=void 0?a.value.substring(a.selectionStart,a.selectionEnd):"":m.createRange().text},setCursor:function(a,
e,k){e=e==null?a.value.length:e;k=k==null?0:k;a.focus();if(a.createTextRange){a=a.createTextRange();a.move("character",e);a.moveEnd("character",k);a.select()}else a.setSelectionRange(e,e+k)},replaceSelection:function(a,e){a.focus();var k=this.selectionStart(a),s=this.getSelectionText(a).length,d=a.value;s=s===0?k:k+s;a.value=g.stringReplace(d,e,k,s);this.setCursor(a,k+e.length);return k},escapeHtml:function(a){return a?a.replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},disable:function(a,e,k){e?l(a).addClass(k||
"btn-s1-disabled"):l(a).removeClass(k||"btn-s1-disabled")},getBind:function(a,e){var k="_xwbbnd_"+e,s=a[k];s||(s=a[k]=g.bind(a[e],a));return s},uniqueId:function(){return++o},formQuery:function(a){var e="",k="";a=l(a)[0];for(var s=a.elements,d=s.length,j=0;j<d;j++){k=s[j];if(k.tagName==="INPUT")if(k.type==="radio"||k.type==="checkbox")if(!k.checked)continue;if(a=k.name||k.id){if(e!="")e+="&";e+=encodeURIComponent(k.name||k.id)+"="+encodeURIComponent(k.value)}}return e},appendParam:function(a,e){var k=
typeof e!=="string"?this.queryString(e):e;return a+(a.indexOf("?")!==-1?"&"+k:"?"+k)},dequery:function(a){var e={};if(a=a.substr(a.indexOf("?")+1)){a=a.split("&");for(var k=0,s=a.length;k<s;k++){var d=a[k].split("=");e[d[0]]=decodeURIComponent(d[1])}}return e},getFileName:function(a,e){if(a.indexOf("\\"))a=a.split("\\").pop();if(a.length>e)a=a.substr(0,e-4)+".."+a.substr(a.length-4);return a},split:function(a,e,k){var s,d=[],j=[];k||(k="\\");for(var p=0,r=a.length;p<r;p++){s=a.charAt(p);if(s===e){d.push(j.join(""));
j.length=0}else{if(s===k&&a.charAt(p+1)===e){s=e;p++}j[j.length]=s}}j.length&&d.push(j.join(""));return d},parseKnV:function(a){var e={},k,s=this.split(a||"",",");try{for(var d=0,j=s.length;d<j;d++)if(s[d].indexOf(":")===-1)e[s[d]]=true;else{k=g.split(s[d],":");e[k[0]]=k[1]}}catch(p){__debug&&console.trace();throw"Syntax Error:rel字符串格式出错。"+a;}return e},ancestorOf:function(a,e,k){if(a.contains&&!l.browser.webkit)return a.contains(e);else if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(e)&
16);if(k===void 0)k=65535;e=e.parentNode;for(var s=u.body;e!=s&&k>0&&e!==null;){if(e==a)return true;e=e.parentNode;k--}return false},getClassByName:function(a,e){for(var k=function(y){for(var z=a.length,B=0;B<z;B++)if(y.toLowerCase()==a[B])return true;return false},s=function(y){if(typeof e=="string")return y.indexOf(e)<0?false:true;else{for(var z=0;z<e.length;z++)if(y.indexOf(e[z])>-1)return true;return false}},d={},j=0;j<document.styleSheets.length;j++){var p;if(e)if(!document.styleSheets[j].href||
!s(document.styleSheets[j].href))continue;p=document.styleSheets[j].cssRules?document.styleSheets[j].cssRules:document.styleSheets[j].rules;if(typeof a=="string")for(var r=0;r<p.length;r++){if(p[r].selectorText&&p[r].selectorText.toLowerCase()==a)d=p[r].style}else{r=0;for(var w=p.length;r<w;r++){var x=p[r].selectorText&&p[r].selectorText.toLowerCase()||"";if(x&&k(x))d[x]=p[r].style}}}return d},setClassAttr:function(a,e,k){a.slice(0);if(k=this.getClassByName(a,k))if(typeof a=="string")for(var s in e)k[s]=
e[s];else for(var d=0,j=a.length;d<j;d++)if(k[a[d]])for(s in e[d])k[a[d]][s]=e[d][s]},getCursorOffset:function(){function a(s){var d={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":!k?"<span style='white-space:pre-wrap;'> </span>":"<pre style='overflow:hidden;display:inline;word-wrap:break-word;'> </pre>"};return s.replace(/<|>|\'|\"|&|\\|\r\n|\n| /gi,function(j){return d[j]})}function e(s){this.ele=s;this.init()}var k=false;if(l.browser.msie&&l.browser.version<
8)k=true;e.prototype={$p:null,$f:null,css:["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX"],init:function(){var s=this.$p=l("<div></div>"),d={opacity:0,position:"absolute",left:0,top:0,zIndex:2E4},j=this.ele;l.each(this.css,function(p,r){d[r]=j.css(r)});s.css(d);l("body").append(s)},setContent:function(s,d,j){var p=this.$p;
p.html("<span>"+a(s)+"</span>");this.$f=s=l("<span>"+a(d)+"</span>");p.append(s);p.append("<span>"+a(j)+"</span>")},getPos:function(){return this.$f.position()}};return function(s,d){var j=l(s);j.data("mirror")||j.data("mirror",new e(j));var p=j.data("mirror");if(!p)return{};var r=j.val();j=r.substring(0,d);var w=r.charAt(d);r=r.substring(d+1);p.setContent(j,w,r);return p.getPos()}}()};if(window.__debug){if(!window.console)window.console={};g.extendIf(console,{debug:l.noop,trace:l.noop,log:l.noop,
warn:l.noop,error:l.noop,group:l.noop,groupEnd:l.noop})}if(l.browser.msie&&l.trim(l.browser.version)=="6.0"){g.ie6=true;u.execCommand("BackgroundImageCache",false,true)}q.ax={};var h=/\[\?(!?)\.([\w_$]+?)\?([\S\s]*?)\?\]/g,i=/\{(\.?[\w_$]+)\}/g,b=q.ax.Tpl={tpls:{},parse:function(a,e){e||(e={});if(a.charAt(0)!=="<"){var k=b.tpls[a];if(k)a=k}a=a.replace(h,function(s,d,j,p){if(d==="!")return!e[j]?p:"";return e[j]===void 0?"":p});return a.replace(i,function(s,d){var j=d.charAt(0)==="."?e[d.substr(1)]:
b.tpls[d];if(j===void 0||j===null)return"";if(j.toString().charAt(0)==="<")return b.parse(j,e);if(b.tpls[j])return b.parse(b.tpls[j],e);return j})},forNode:function(a,e){if(e)a=this.parse(a,e);return l(a).get(0)},get:function(a){return this.tpls[a]},reg:function(a){l.extend(this.tpls,a)}};(q.ax.Cache={MAX_ITEM_SIZE:3,reg:function(a,e,k){if(this[a])this[a][1]=e;else this[a]=[null,e];k!==void 0&&this.sizeFor(a,k)},get:function(a){a=this[a];if(a===void 0)return null;var e=a[1];a=a[0];if(a===null)return e();
if(a.length>1)return a.pop();if(e)return e();return null},put:function(a,e){var k=this[a];if(k){var s=k[0];s||(k[0]=s=[this.MAX_ITEM_SIZE]);s.length-1>=s[0]||s.push(e)}else this[a]=[[this.MAX_ITEM_SIZE,e]]},remove:function(a){this[a]&&delete this[a]},sizeFor:function(a,e){var k=this[a];k||(this[a]=k=[[]]);k[0]||(k[0]=[]);k[0][0]=e}}).reg("div",function(){return u.createElement("DIV")});q.getCfg=function(a){return q.cfg&&q.cfg[a]};q.getSiteUid=function(){return parseInt(q.getCfg("siteUid"))};q.getUid=
function(){var a=q.getCfg("uid");return a!=="0"&&a};q.getWb=function(a){var e=q.getCfg("wbList");return a?e&&e[a]:e};q.setWb=function(a,e){q.cfg.wbList&&(q.cfg.wbList[a]=e)};l.extend(q,{_cls:{},reg:function(a,e,k){if(this._cls[a]!==void 0&&!k){__debug&&console.trace();throw"已定义类"+a;}return this._cls[a]=e},use:function(a,e){var k=this._cls[a];if(k){if(typeof k==="object")return k;if(typeof e==="function")return new k(e(k.prototype));return new k(e)}return null},isModule:function(a){return this.getModule()===
a},getModule:function(){if(this._mod===void 0)this._mod=this.getCfg("page")||"";return this._mod}});q.ax.Uploader=q.reg("Uploader",function(a){this.init(a)});q.ax.Uploader.prototype={init:function(a){l.extend(this,a);a=this.form;var e=this.formEl=l(a)[0],k="xwb_upload_frame_"+g.uniqueId();this.iframe=b.forNode('<iframe src="about:blank" style="display:none;" id="'+k+'" name="'+k+'"></iframe>');l('<input type="hidden" name="callback"/>').appendTo(a);l(this.iframe).appendTo(u.body);e.target=k;if(!this.action)this.action=
e.action||q.request.apiUrl("action","upload_pic")},setAction:function(a){this.action=a;return this},isLoading:function(){return!!this.jsonpFn},beforeUpload:l.noop,upload:function(a){if(this.beforeUpload(this.form)!==false){this.isLoading()&&this.abort();var e=this,k=this.jsonpFn="jsonp"+(new Date).getTime();window[k]=function(s){window[k]=null;delete e.jsonpFn;s=q.request.parseProtocol(s);(a||e.onload).call(e,s);delete e.jsonpFn};this.formEl.action=g.appendParam(this.action,{callback:"parent."+k,
_:g.uniqueId()});this.formEl.submit()}},onload:l.noop,abort:function(){if(this.isLoading()){var a=this.jsonpFn;window[a]=function(){window[a]=null}}}};var c=q.lang={texts:{},getText:function(a,e){var k=c.texts;if(a in k)a=k[a];if(e!==void 0)return g.templ(a,l.isArray(e)||typeof e=="object"?e:[e]);return a}}})(Xwb,$);(function(q){q.texts={"确&nbsp;定":"確&nbsp;定","关&nbsp;闭":"關&nbsp;閉","转 发":"轉 發","您还可以输入{0}字":"您還可以輸入{0}字","转发微博":"轉發微博","回复":"回覆","无效链接":"無效鏈接","转发":"轉發","转发到我的微博":"轉發到我的微博","评论":"評論","确定要删除该评论吗？":"確定要刪除該評論嗎？","请在这里输入自定义话题":"請你在這裡輸入自定义話題","图片正在上传，请稍候..":"圖片正在上傳，請稍候..","正在发布,请稍候..":"正在發布，請稍候..","只支持{0}格式的图片。":"只支援{0}格式的圖片","分享图片":"分享圖片","图片发布":"圖片發布","发微博":"發微博","发私信":"發私信","内容长度不能超过140个字。":"內容長度不能超過140個字。","请输入要发送的用户昵称。":"請輸入要發送的用戶的暱稱","请输入私信内容。":"請輸入私信內容","邮箱地址":"郵箱地址","至少填写一种联系方式":"至少填寫一種聯絡方式","确定将{nick}加入到黑名单吗？<span>你和{gender}将自动解除关注关系，并且{gender}不能再关注你，给你发评论、私信和@你。</span>":"確定將{nick}加入到黑名單嗎？<span>你和{gender}將自動解除關注關係，并且{gender}不能再關注你，給你發評論、私信和@你。</span>",
"你今天已经关注了足够多的人，先去看看他们在说些什么吧？":"你今天已經關注了足夠多的人了，先去看看他們在說些什麼吧？","确定要取消关注":"確定要取消關注","关注他":"關注他","确定删除该微博吗？":"確定刪除該微博嗎？","确定要关闭此活动？":"確定要關閉此活動？","确定要删除此活动？":"確定要刪除此活動？","确定要删除该私信？":"確定要刪除該私信？","移除之后将取消{0}对你的关注?":"移除之後將取消{0}對你的關注？","取消关注":"取消關注","已关注":"已關注","关注该话题":"關注該話題","保存失败":"存储失敗","封面上传中，请稍候...":"封面上載中，請稍候...","请填写正确的费用数":"請填寫正確的費用額","费用不能超过10000元":"費用不能超過10000元","开始时间不能晚于结束时间":"開始時間不能晚於結束時間","已设置提醒":"已設定提醒","确定删除所有选择评论？":"確定刪除所有選擇的評論嗎？","确定要删除该回复吗？":"確定要刪除該回覆嗎？","回复成功！":"回覆成功！","个人设置保存成功！":"個人設定儲存成功！",
"你输入的个人简介不能超过70个字。":"個人簡介不能超過70個字.","抱歉，目前不允许修改个人资料，请联系网站管理员！":"抱歉，目前不允許修改個人資料，請聯繫網站管理員！","显示设置已保存。":"顯示設定已儲存。","提醒设置已保存。":"提醒設定已儲存。","确认要使用这个域名吗？保存后将不能修改":"確認要使用這個域名嗎？保存後將不能修改。","您已设置域名，不能更改。":"您已設定域名，不能更改。","格式不正确":"格式不正確","域名已被占用，请重新设置。":"域名已被佔用，請重新設定。","6至20位的英文或数字（必须包含英文字符且不能以数字开头）":"6至20位的英文或數字（必須包含英文字符且不能以數字開頭）","我的主页":"我的主頁","链接复制成功！你可以利用快捷方式Ctrl+V键粘贴到UC、QQ或MSN等聊天工具中":"鏈接復制成功！你可以利用快捷方式Ctrl+V鍵粘貼到UC、QQ或MSN等聊天工具中","您的浏览器不支持脚本复制或你拒绝了浏览器安全确认，请尝试手动[Ctrl+C]复制。":"您的瀏覽器不支援腳本復制或你拒絕了瀏覽器安全確認，請嘗試手動[Ctrl+C]復制。",
"取消绑定":"取消綁定","你确定要取消当前绑定关系吗？":"你確定要取消當前綁定關係嗎？","选择最适合你的词语，多个请用空格分开":"選擇最適合你的詞語，多個請用空格分開","请至少输入一个标签":"請至少輸入一個標籤","标签创建成功！":"標籤創建成功！","含有非法字符，请修改":"含有非法字符，請修改","您已添加{0}个标签，达到标签上限":"您已添加{0}個標籤，達到標籤上限","单个标签长度不多于7个汉字或14个字母":"單個標籤長度不多於7個漢字或14個字母","原文评论":"原文評論","原文转发":"原文轉發","上传失败!":"上載失敗！","上传图片失败":"上載圖片失敗","上传背景图片的大小不能超过2M，请重新选择":"上載背景圖片的大小不能超過2M，請重新選擇","上传图片类型不符合要求":"上載圖片類型不符合要求","请选择皮肤":"請選擇皮膚","请选择您要关注的人。":"請選擇您要關注的人","万":"萬","删除":"刪除","参加成功！":"參加成功！","已参加":"已參加","请输入联系方式！":"請輸入聯絡方式","请填写备注":"請填寫備註",
"备注长度超过100！":"備註長度超過100！","发布成功":"發布成功","该项不能为空":"該項不能為空","不是有效的日期格式":"不是有效的日期格式","请输入正确的邮箱格式":"請輸入正確的郵箱格式","该项为数字格式":"該項為數字格式",'支持中英文、数字、"_"或减号':'支援中英文、數字、"_"或減號',"代码已复制至粘贴版。":"代碼已復制至粘貼板","您的浏览器禁止自动复制，请手动复制。":"您的瀏覽器禁止自動復制，請手動復制。","请输入有效宽度":"請輸入有效寬度","请输入数字":"請輸入數字","宽度":"寬度","信息已进入审核中":"信息已進入審核中","话题长度太长":"話題長度太長","转发成功":"轉發成功","系统不给力，请稍后再试试吧。":"系統不給力，請稍後再試試吧。","分享给大家":"分享給大家","联系电话":"聯繫電話","已超出{0}字":"已超出{0}字"};q.ERRORMAP={"0":"發布失敗。","5":"超過字數了！","1":"圖片正在上傳，請稍候。","2":"正在發布，請稍候。","3":"請先輸入內容。",
"4":"請寫上你要說的話題。","1010005":"超出字數了哦！","1020002":"請不要重複發布相同的內容。","1010006":"不能采用sina域下的郵箱。","1010007":"已經提交，請耐心等待管理員審核，謝謝！","20011":"評論字數超過限制","20016":"他還沒有關注你，不能發私信","30000":"信息已進入審核中","30001":"皮膚保存失敗，請重試。","20020":"上載圖片為空","20021":"上載圖片大小超過限制","20022":"上載的圖片類型不符合","20023":"上載圖片失敗，重新試試看？","20024":"非法的上載圖片","1021200":"此暱稱不存在","1020500":"此微博已被作者移除。","1020301":"此微博已被作者移除。","1020700":"此微博已被作者移除。","1020402":"此微博已被作者移除。","1020504":"此微博已被作者移除。","1020501":"此評論已被作者移除。","1020600":"此評論已被作者移除。","1040003":"您尚未登入，請先登入再操作",
"1040000":"您尚未登入，请先登入再操作","1050000":"系統繁忙，請稍候再試。","1040007":"發評論太多啦，休息一會兒吧。","1040006":"發微博太多啦，休息一會兒吧。","1040005":"你已經被禁止發言","1040004":"請不要發表違法和不良信息。","1021301":"該暱稱已存在，請換一個暱稱。","1020104":"不要太貪心哦，發一次就夠啦。","1020809":"你的關注人數已達到上限","1020808":"你不能關注自己。","1020801":"關注的用戶不存在。","1020800":"關注失敗","1020805":"已關注該用戶","1050000":"操作失敗，重新試試看？","1020404":"由於用戶設定，你暫不能發表評論。","1020405":"根據對方的設定，你不能進行此操作。","1020806":"你使用的帳戶或IP關注過于頻繁，今日無法再進行同類操作，請諒解！","2010009":"上載圖片大小超過限制。","2010010":"上載圖片大小超過限制。","2010011":"上載圖片的數據不完整，重新試試看？",
"2010012":"圖片上載失敗，重新試試看？","2010013":"上載圖片失敗，重新試試看？","2010014":"上載圖片失敗，重新試試看？","1040016_def":"出錯啦，該網站調用API次數已超過限制，請聯繫站長解決！","1040016":"抱歉，目前{0}功能暫不可用，請聯繫網站管理員！","1040017":"只能使用POST方法","1040018":"缺少參數","1040019":"參數格式不正確","1040020":"創建備份目錄失敗","1040021":"錯誤的帳號密碼","1040022":"指定的數據庫可能不存在","1040023":"請填寫數據庫的相關信息","1040024":"沒有可以恢復的數據","1040025":"請先使用connect()方法連接數據庫","1040026":"指定的存放路徑不存在","1040027":"找不到文件要恢復的文件","1040028":"執行備份的SQL時出錯","1040029":"連接時出錯，可能輸入的帳號信息不正確","1020100":"沒有上載圖片或圖片內容為空。 ","1020101":"上載圖片格式類型不符合要求。 ",
"1020102":"上載圖片大小超過限制。 ","1010000":"參數不能為空​​","1010002":"參數必須為數字","1010003":"參數格式必須為email格式","1010004":"參數格式必須為json格式","1040001":"當前用戶沒有開通微博","1040002":"api訪問超時或拒絕訪問","1040003":"token為空","1040014":"不要太貪心哦，發一次就夠啦","1040015":"接口不可用","1020000":"發微博內容不能為空","1020001":"發微博內容超過140個字","1020003":"請不要重複發送類同內容","1020100":"上傳的不是圖片或圖片內容為空","1020103":"分享圖片微博內容超過140個字","1020200":"轉發微博id為空","1020201":"轉發微博內容超過140個字","1020300":"刪除微博id為空","1020302":"刪除的微博不是本人發的","1020400":"評論微博id為空","1020401":"評論微博內容為空","1020502":"回複評論評論內容為空",
"1020503":"回複評論評論內容超過140個字","1020601":"刪除評論id不存在或不是本人發的","1020602":"刪除評論失敗","1020701":"刪除收藏微博微博id為空或不存在","1020802":"取消關注的用戶id為空或不存在","1020803":"取消關注的用戶name為空或不存在","1020804":"關注失敗","1020807":"你已經把此用戶加入黑名單，加關注前請先解除","1020900":"發私信的內容為空","1020901":"發送方的id為空或本人","1020902":"發送方的不是本人的粉絲","1020903":"刪除私信id為空或不是本人發的","1020904":"刪除私信id不存在","1021001":"訂閱分類名稱為空","1021100":"設定用戶提醒參數為空","1021300":"更改的暱稱已經存在","1021302":"請重寫簡介","1021500":"標籤為空","1021501":"添加標籤失敗","1021502":"刪除標籤的標籤id為空","1021600":"要加入黑名單的用戶不存在",
"1021700":"要更新的選項值都為空","1021800":"id為空","1021900":"註冊失敗使用sina的email註冊","1021901":"ip被封或不合法","1021902":"暱稱重複或者非法","1021903":"該郵箱地址已被註冊","1021904":"ip受限制","1020810":"hi 超人，你今天已經關注很多嘍，...問題，請聯繫新浪客服：400 690 0000","1020811":"hi 超人，你今天已經關注很多嘍，接下來的時間想想如何讓大家都來關注你吧！如有問題，請聯繫新浪客服：400 690 0000"}})(Xwb.lang);(function(q){window.__debug||(__debug=false);var l=location.hostname,u=/:\/\/(.[^\/]+)/,t=q.util,o={init:function(g){this.basePath=g;return this},direct:function(g){g||(g={});var h=g.success;g.success=function(b,c){var a=new (g.responseDefinition||o.DefaultResponseDefinition)(b,g,c);__debug&&console.log("req e:",a);g.scope?h.call(g.scope,a):h(a)};var i=g.url.match(u);return!i||i[1]==l?t.ajax(g):t.jsonp(g)},postReq:function(g,h,i,b){!b&&(b={});b.method="POST";return this.q(g,h,i,b)},q:function(g,h,
i,b){!b&&(b={});b.url=g;if(b.data)t.extend(b.data,h);else b.data=h;b.success=i;return this.direct(b)},basePath:"/",act:function(g,h,i,b){return this.postReq(this.apiUrl("action",g),h,function(){i&&i.apply(this,arguments);for(var c=["api."+g],a=0,e=arguments.length;a<e;a++)c.push(arguments[a]);q.fire.apply(q,c)},b)},mkUrl:function(g,h,i,b){g=(b||"")+"?m="+g;if(h)g+="."+h;if(i){g+="&";typeof i==="string"?g+=i:g+=t.queryString(i)}return this.basePath+g},apiUrl:function(g,h,i){return this.mkUrl("api/weibo/"+
g,h,i)},parseProtocol:function(g){return new o.DefaultResponseDefinition(g)},event:function(g,h,i,b){this.postReq(this.mkUrl("event",g),h,i,b)},post:function(g,h,i,b){g={text:g};if(i)g.pic=i;o.act("update",g,h,b)},postImgText:function(g,h,i,b){o.act("upload",{text:g,pic:h},i,b)},repost:function(g,h,i,b,c){o.act("repost",{id:g,text:h,rtids:i},b,c)},getEmotion:function(g){o.act("emotions",null,g)},del:function(g,h,i,b){o.act("destroy",{id:g,v:h},i,b)},comment:function(g,h,i,b,c,a){o.act("comment",{id:g,
text:h,forward:i,type:b},c,a)},delComment:function(g,h,i){o.act("comment_destroy",{id:g},h,i)},reply:function(g,h,i,b,c,a,e){o.act("reply",{id:g,cid:h,text:i,forward:b,type:c},a,e)},follow:function(g,h,i,b){o.act("createFriendship",{uid:g,type:h},i,b)},unfollow:function(g,h,i,b){o.act("deleteFriendship",{id:g,name:h,is_follower:0},i,b)},removeFans:function(g,h,i,b){o.act("deleteFriendship",{id:g,name:h,is_follower:1},i,b)},fav:function(g,h,i){o.act("createFavorite",{id:g},h,i)},delFav:function(g,
h,i){o.act("deleteFavorite",{id:g},h,i)},updateHeadPic:function(g,h,i){o.act("updateProfileImage",{image:g},h,i)},setProfile:function(g,h,i){o.act("saveProfile",g,h,i)},unread:function(g,h,i){o.act("unread",{id:g},h,i)},clearUnread:function(g,h,i){o.act("clearTip",{type:g},h,i)},getComments:function(g,h,i,b,c){o.act("getComments",{id:g,page:h,type:i||1},b,c)},msg:function(g,h,i,b,c){o.act("sendDirectMessage",{id:h?"":g,name:h?g:"",text:i},b,c)},delMsg:function(g,h,i){o.act("deleteDirectMessage",{id:g},
h,i)},followed:function(g,h,i,b,c,a){var e={};if(i)e.t_name=g;else e.t_id=g;if(b)if(c)e.s_name=b;else e.s_id=b;o.act("friendShip",e,h,a)},setting:function(g,h,i){o.act("setting",{type:g},h,i)},shieldBlog:function(g,h,i){o.postReq(o.mkUrl("show","disabled"),{id:g},h,i)},reportSpam:function(g,h,i,b){o.postReq(o.mkUrl("show","reportSpam"),{cid:g,content:h},i,b)},createTags:function(g,h,i){o.act("createTags",{tagName:g},h,i)},delTag:function(g,h,i){o.act("deleteTags",{tag_id:g},h,i)},updateShowProfile:function(g,
h,i){o.act("saveShow",g,h,i)},updateNoticeProfile:function(g,h,i){o.act("saveNotice",g,h,i)},notice:function(g,h,i,b,c,a){o.postReq(o.apiUrl("action","sendNotice"),{available_time:b,uid:g,title:h,content:i},c,a)},saveSkin:function(g,h,i){o.postReq(o.mkUrl("setting","setSkin"),g,h,i)},saveMgrSkin:function(g,h,i){o.postReq(o.mkUrl("mgr/setting","setSkin"),g,h,i)},counts:function(g,h,i){o.act("getCounts",{ids:g},h,i)},blacklistAdd:function(g,h,i,b){o.act("createBlocks",{id:g,name:h},i,b)},blacklistDel:function(g,
h,i,b){o.act("deleteBlocks",{id:g,name:h},i,b)},getProvinces:function(g){o.act("getProvinces",null,g)},feedback:function(g,h,i){this.postReq(this.mkUrl("feedback","save"),g,h,i)},sinaurl:function(g,h){o.act("sinaurl",{id:g},h)},eventSave:function(g,h){o.event("saveEvent",g,h)},eventJoin:function(g,h){g=$.extend({},g,{action:"join"});o.event("joinEvent",g,h)},eventClose:function(g,h){o.event("closeEvent",{eid:g},h)},eventDelete:function(g,h){o.event("deleteEvent",{eid:g},h)},eventExit:function(g,h,
i){o.event("doAction",{action:"exit",eid:g},h,i)}};o.DefaultResponseDefinition=function(g,h,i){this.raw=g;this.reqCfg=h;if(i)this.connector=i};o.DefaultResponseDefinition.prototype={getRequestCfg:function(){return this.reqCfg},getConnector:function(){return this.connector},getRaw:function(){return this.raw},getData:function(){return this.getRaw().rst},isOk:function(){return!this.getCode()},getCode:function(){return this.getRaw().errno},getError:function(){return this.getRaw().err},getMsg:function(g,
h){var i=this.getCode(),b=i+"_def";b=m[h?i:b]||m[i];if(__debug)b||console.warn("未定义错误码消息："+i,"@",this.getRaw());i=b||g;return(h?t.templ(i,$.isArray(h)||typeof h=="object"?h:[h]):i)||q.lang.getText("系统不给力，请稍后再试试吧。")},each:function(g,h){var i=0,b=this.getData(),c;for(c in b)if(!isNaN(c)){if(h){if(g.call(h,b[c],i)===false)break}else if(g(b[c],i)===false)break;i++}}};var m=o.ERRORMAP=q.lang.ERRORMAP;if(!q.fire)q.fire=function(){};q.request=o})(window.Xwb);(function(q,l){var u=true,t=parseInt,o=!!(l.browser.msie&&l.browser.version=="6.0"),m=function(){this.cid="imageCtrler";this.canvas=null;this.maxWidth=440;this.curAngle=this.height=this.width=0};m.prototype={init:function(g){g=g.el;this.width=g.offsetWidth;this.height=g.offsetHeight;var h=this.browserVer=parseInt(l.browser.version);if(l.browser.msie&&(document.documentMode||h)<9){g.style.filter="progid:DXImageTransform.Microsoft.Matrix()";g.filters.item("DXImageTransform.Microsoft.Matrix").SizingMethod=
"auto expand";l(g).addClass("narrow-move")}else{this.canvas=l("<canvas></canvas>").attr({height:this.height,width:this.width}).addClass("narrow-move").attr("rel","e:zo").insertBefore(g)[0];if(this.canvas.getContext){l(g).hide();this.canvas.getContext("2d")}}h=g.parentNode;this._clientWidth=h.clientWidth;this._clientHeight=h.clientHeight;this.element=g},rotate:function(g){if(this.element){if(g==="right"){g=this.curAngle+90;this.curAngle=g>=360?0:g}else if(g==="left"){g=this.curAngle-90;this.curAngle=
g<0?360+g:g}var h,i;g=this.width;var b=this.height;this.width=b;this.height=g;if(b>this.maxWidth){g=t(this.maxWidth*g/b);b=this.maxWidth}if(this.canvas){var c=this.canvas.getContext("2d"),a=this.element,e=0,k=0;l(this.canvas).attr({width:b,height:g});c.clearRect(0,0,b,g);switch(this.curAngle){case 0:k=e=0;h=b;i=g;break;case 90:e=b;k=0;h=g;i=b;break;case 180:e=b;k=g;h=b;i=g;break;case 270:e=0;h=k=g;i=b}c.save();c.translate(e,k);c.rotate(this.curAngle*Math.PI/180);c.drawImage(a,0,0,h,i);c.restore()}else{a=
this.curAngle*Math.PI/180;c=Math.cos(a);e=Math.sin(a);a=this.element;a.filters.item("DXImageTransform.Microsoft.Matrix").M11=c;a.filters.item("DXImageTransform.Microsoft.Matrix").M12=-e;a.filters.item("DXImageTransform.Microsoft.Matrix").M21=e;a.filters.item("DXImageTransform.Microsoft.Matrix").M22=c;switch(this.curAngle){case 0:case 180:h=b;i=g;break;case 90:case 270:h=g;i=b}a.width=h;a.height=i;if((document.documentMode||this.browserVer)==8){h=l(a);l(a).css({display:"block","margin-left":(this._clientWidth-
a.offsetWidth)/2}).parent().height(h.height())}}}}};l.extend(l.fn,{zoomText:function(g,h){this.each(function(){var i,b=l(this),c=b.offset(),a=b.text();h=isNaN(h)?2:h;isNaN(+a)||(a=+a+(g||1));b.text(a);i=b.clone().attr("id","").css({position:"absolute",top:c.top,left:c.left,font:b.css("font"),color:b.css("color")}).appendTo(l(document.body));a=h*parseInt(b.css("font-size"));i.animate({"font-size":a,top:c.top-b.height()/4,left:c.left-b.width()/2,opacity:0.1},{duration:300,complete:function(){i.remove()}})});
return this},imgRotate:function(g){this.each(function(){if(this.tagName!=="IMG")return false;var h=l(this).data("img");if(!h){h=new m;h.init({el:this});h.maxWidth=l(this).parent().width();l(this).data("img",h)}h.rotate(g)});return this},focusText:function(g,h,i,b){this.each(function(){l(this).focus(function(){if(this.value===g){var c=l(this).data("xwb_selholder");if(c)c.setText("");else this.value=""}if(h)b?l(i||this).removeClass(h):l(i||this).addClass(h)}).blur(function(){if(l.trim(this.value)===
""){var c=l(this).data("xwb_selholder");if(c)c.setText(g);else this.value=g}if(h)b?l(i||this).addClass(h):l(i||this).removeClass(h)})})},cssDisplay:function(g){var h=this.length;if(h)if(h===1)if(g===undefined)return!this.hasClass("hidden");else g?this.removeClass("hidden"):this.addClass("hidden");else this.each(function(){g?l(this).removeClass("hidden"):l(this).addClass("hidden")});return this},checkClass:function(g,h){g&&this.each(function(){var i=l(this),b=i.hasClass(g);if(h)b||i.addClass(g);else b&&
i.removeClass(g)});return this},switchClass:function(g,h){this.each(function(){var i=l(this);i.removeClass(g);i.addClass(h)});return this},absolutePos:function(){var g=this.offset(),h=l(document),i=h.scrollTop();h=h.scrollLeft();g.left-=h;g.top-=i;return g},slideMenu:function(g,h){this.each(function(){(function(i){function b(){a.show().cssDisplay(true);h&&i.addClass(h)}function c(){h&&i.removeClass(h);a.cssDisplay(false)}var a=i.find(g),e,k;i.hover(function(){if(k){clearTimeout(k);k=false}e=setTimeout(b,
100)},function(){if(e){clearTimeout(e);e=false}k=setTimeout(c,80)})})(l(this))})},substrText:function(g,h){var i=RegExp("(?:<a.*?>.*?<\\/a>)|(?:<img.*?>)|.","gi");this.each(function(){var b=b||"...",c=this.innerHTML;c=c.match(i);g=g||10;if(c&&c.length>g){c=c.slice(0,g).join("");c=h?c:c.replace(/<img.*?title=\"(.*?)\".*?>/gi,"[$1]");l(this).html(c+b)}});return this},fixPng:function(){if(o){var g=function(){if(this.tagName=="IMG"){var h=l("<span></span>").css({width:this.offsetWidth,height:this.offsetHeight,
display:"inline-block"});h[0].style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+this.src+'", sizingMethod="crop")';l(this).replaceWith(h)}};this.each(function(){if(this.complete)g.call(this);else this.onload=g})}return this},makeScroll:function(g){function h(){if(g.ldisabledCs){var x=k.scrollWidth>k.offsetWidth;p.cssDisplay(x);j.cssDisplay(x);p.checkClass(g.ldisabledCs,k.scrollLeft==0);j.checkClass(g.rdisabledCs,k.scrollLeft+k.offsetWidth===k.scrollWidth)}}function i(){var x=
k.scrollLeft+g.pace*d;if(x<0)x=0;if(x>k.scrollWidth)x=k.scrollWidth;k.scrollLeft=x;h();s=setTimeout(arguments.callee,g.interval||20)}function b(){r=false;i()}function c(){r=true;d=-1;mid=setTimeout(b,200);return false}function a(){r=true;d=1;mid=setTimeout(b,200);return false}function e(){if(r){var x=k.scrollLeft+g.pace*d*4;if(x<0)x=0;if(x>k.scrollWidth)x=k.scrollWidth;l(k).animate({scrollLeft:x},"fast",function(){h()})}clearTimeout(s);clearTimeout(mid)}var k=this[0],s,d=1,j=l(g.nextBtn),p=l(g.prevBtn);
g.pace=g.pace||25;var r;g.nextBtn&&l(g.nextBtn).mousedown(a).mouseup(e).click(function(){return false});g.prevBtn&&l(g.prevBtn).mousedown(c).mouseup(e).click(function(){return false});if(g.moveScorll){j.hover(a,e);p.hover(c,e)}var w=0;if(g.items){l(k).find(g.items).each(function(){w+=l(this).outerWidth(true)});l(k).find(g.ct||":first-child").css("width",w)}h();return g},scrollView:function(){function g(a){var e=l(h.children(":last")),k=e.height();e.height(0).css({opacity:0,"font-size":0,overflow:"hidden"}).remove().prependTo(h).animate({height:k},
1E3,"cubicOut",function(){e.css({"font-size":"12px"})}).animate({opacity:1},500,function(){!b&&l.isFunction(a)&&a()})}var h=this,i=h.children(),b;if(i.length){var c=0;l.each(i,function(a,e){c+=l(e).height()});if(c>h.height()){h.hover(function(){if(b)b=window.clearInterval(b)},function(){b||(b=window.setInterval(g,4E3))});b||(b=window.setInterval(g,4E3))}}},scrollMass:function(g,h,i){function b(){a.animate({marginLeft:-s},i?i:1E3,function(){if(k!=0){a.css("marginLeft",0);a.append(a.children(":lt("+
g+")"))}d||c()})}function c(){k=window.setTimeout(b,h)}var a=this,e=a.children().length,k;h=h;var s=a.children()[0].offsetWidth*g,d=false;if(e<=g)return this;this.hover(function(){d=true;clearTimeout(k)},function(){d=false;c()});c();return this}});(function(){function g(){c=/INPUT|IMG|SCRIPT|STYLE|HEAD|MAP|AREA|TEXTAREA|SELECT|META|OBJECT|IFRAME/i;a=/^\s+$/;e=/(\.|\\|\/|\*|\?|\+|\[|\(|\)|\]|\{|\}|\^|\$|\|)/g;k=/</g;s=/>/g;d=u}function h(j,p){if(j){d||g();if(typeof j==="string")j=l.trim(j).split(a);
for(var r=[],w=0,x=j.length;w<x;w++)if(j[w]&&!a.test(j[w]))r[r.length]=j[w].replace(k,"&lt;").replace(s,"&gt;").replace(e,"\\$1");var y=RegExp("("+r.join("|")+")","gi"),z='<span class="'+(p||h.cls)+'">$1</span>',B=document.createElement("DIV");this.each(function(){i(this,y,z,B)});return this}}function i(j,p,r,w){var x=j.childNodes,y=[],z,B;z=0;for(B=x.length;z<B;z++)c.test(x[z].tagName)||y.push(x[z]);z=0;for(B=y.length;z<B;z++){x=y[z];if(x.nodeType===3)try{x=x;var C=p,A=r,D=w,E=x.data;if(!a.test(E)){E=
E.replace(k,"&lt;").replace(s,"&gt;");if(C.test(E)){D||(D=document.createElement("DIV"));D.innerHTML=E.replace(C,A);var F=D.childNodes;C=[];var G=document.createDocumentFragment();A=0;for(var H=F.length;A<H;A++)C[A]=F[A];for(A=0;A<H;A++)G.appendChild(C[A]);x.parentNode.replaceChild(G,x)}}}catch(I){}else arguments.callee(x,p,r,w)}}function b(j,p){var r=j.childNodes,w=[],x,y,z;x=0;for(y=r.length;x<y;x++)c.test(r[x].tagName)||w.push(r[x]);x=0;for(y=w.length;x<y;x++){r=w[x];z=r.nodeType;if(z!==3)if(z===
1&&r.tagName==="SPAN"&&r.className===p){z=r.childNodes[0];var B=r.parentNode,C=r.previousSibling,A=r.nextSibling;if(C&&C.nodeType===3){B.removeChild(C);z.data=C.data+z.data}if(A&&A.nodeType===3){B.removeChild(A);z.data+=A.data}B.replaceChild(z,r)}else arguments.callee(r,p)}}var c,a,e,k,s,d;l.fn.highlight=h;l.fn.clearHighlight=function(j){d||g();j=j||h.cls;this.each(function(){b(this,j)})};h.cls="search-txt"})();l.cookie=function(g,h,i){if(typeof h!="undefined"){i=i||{};if(h===null){h="";i.expires=
-1}var b="";if(i.expires&&(typeof i.expires=="number"||i.expires.toUTCString)){if(typeof i.expires=="number"){b=new Date;b.setTime(b.getTime()+i.expires*24*60*60*1E3)}else b=i.expires;b="; expires="+b.toUTCString()}var c=i.path?"; path="+i.path:"",a=i.domain?"; domain="+i.domain:"";i=i.secure?"; secure":"";document.cookie=[g,"=",encodeURIComponent(h),b,c,a,i].join("")}else{h=null;if(document.cookie&&document.cookie!=""){i=document.cookie.split(";");for(b=0;b<i.length;b++){c=jQuery.trim(i[b]);if(c.substring(0,
g.length+1)==g+"="){h=decodeURIComponent(c.substring(g.length+1));break}}}return h}};l.easing.cubicOut=function(g,h,i,b,c){return b*((h=h/c-1)*h*h+1)+i}})(Xwb,jQuery);Xwb.ax.Tpl.reg({Box:'<div class="win-pop {.cs}"><div class="win-t"><div></div></div><div class="win-con"><div class="win-con-in">[?.title?{BoxTitlebar}?]<div class="win-box" id="xwb_dlg_ct">{.contentHtml}</div></div><div class="win-con-bg"></div></div><div class="win-b"><div></div></div>[?.closeable?<a href="#" class="ico-close-btn" id="xwb_cls" title="關閉"></a>?]{.boxOutterHtml}</div>',DialogContent:'{.dlgContentHtml}<div class="btn-area" id="xwb_dlg_btns">{.buttonHtml}</div>',BoxTitlebar:'<h4 class="win-tit x-bg"><span id="xwb_title">{.title}</span></h4>',
Mask:'<div class="shade-div"></div>',ForwardDlgContentHtml:'<p id="xwb_forward_text"></p><div class="forward-tool"><span id="xwb_warn_tip">還可以輸入140字</span><a href="#" class="icon-face-choose" id="xwb_face_trig"></a></div><textarea id="xwb_fw_input" class="style-normal"></textarea><div id="xwb_fw_lbl"></div>',ForwardDlgLabel:'<label><input type="checkbox" value="{.uid}">同時作為{.nick}的評論發布</label>',MsgDlgContent:'<div class="tips-c"><div class="icon-alert" id="xwb_msgdlg_icon"></div><p id="xwb_msgdlg_ct"></p></div>',
Button:'<a href="#" class="btn-s1 {.cs}" id="xwb_btn_{.id}"><span>{.title}</span></a>',EmotionHotList:'<div class="hot-e-list" id="hotEm">{.hotList}</div>',EmotionBoxContent:'<div class="win-tab bottom-line" id="cate">\t{.category} </div><div class="emotion-box" id="box">{EmotionHotList}<div class="e-list" id="flist0">{.faces}</div></div>',ArrowBoxBottom:'<div class="arrow"></div>',EmotionIcon:'<a href="javascript:;" title="{.title}" rel="e:em"><img src="{.src}"></a>',Loading:'<div id="xweibo_loading" class="loading"></div>',
CommentArea:'<div class="feed-comment box-style hidden"><div class="box-t skin-bg"><span class="skin-bg"></span></div><div class="box-content">{.cmtBoxHtml}<ul id="cmtCt" class="hidden"></ul><div class="more-comment" id="more">還有<span id="lefCnt"></span>條評論，<a href="{.cmtUrl}">點擊查看</a></div></div><div class="box-b skin-bg"><span class="skin-bg"></span></div><span class="box-arrow skin-bg"></span></div>',CmtBox:'<div class="post-comment" id="cmtBox"><div class="post-comment-main"><a href="javascript:;" class="icon-face-choose" rel="e:ic"></a><a class="btn-s1" href="javascript:;" rel="e:sd"><span>評論</span></a><div class="comment-keyin style-normal"><div><textarea class="comment-textarea" id="inputor"></textarea></div></div></div><div><span class="keyin-tips" id="warn">您還可以輸入70字</span><label><input type="checkbox" id="sync"/>同時發一條微博</label></div></div>',
atwho:'<div class="atwho">    [?!.noAt?<h4 id="title">想用@提到誰？</h4>?]\t<ul id="mainUL">\t</ul></div>',MBCmtBox:'<div class="feed-comment box-style" id="cmtBox"><div class="box-t skin-bg"><span class="skin-bg"></span></div><div class="box-content"><div class="post-comment"><div class="post-comment-main"><a class="icon-face-choose" href="#" rel="e:ic"></a><a href="javascript:;" class="btn-s1" rel="e:sd"><span>評論</span></a><div class="comment-keyin style-normal"><div><textarea id="inputor" class="comment-textarea style-normal"></textarea></div></div></div><div><span class="keyin-tips" id="warn">您還可以輸入70字</span><label><input type="checkbox" id="sync">同時發一條微博</label></div></div></div><div class="box-b skin-bg"><span class="skin-bg"></span></div><span class="box-arrow skin-bg"></span></div>',
Comment:'<li rel="c:{.id},n:{.nick}"><div class="user-pic"><a href="{.usrUrl}"><img src="{.profileImg}" title="{.nick}" alt="{.nick}的頭像" width="{.picSz}" height="{.picSz}" /></a></div><div class="comment-content"><p><a href="{.usrUrl}">{.nick}{.verifiedHtml}</a>：{.text}<span>({.time})</span></p><div>[?.canDel?<a class="ico-del" href="javascript:;" rel="e:dl">刪除</a>?]<a class="ico-reply" href="javascript:;" rel="e:rp">回覆</a></div></div></li>',MBlogCmt:'<li rel="c:{.id},n:{.nick}"><div class="user-pic"><a href="{.usrUrl}"><img alt="" src="{.profileImg}" /></a></div><div class="comment-c"><p class="c-info"><a href="{.usrUrl}">{.nick}{.verifiedHtml}</a> {.text}({.time}) </p><div class="c-for" id="trigs"><a href="javascript:;" class="ico-reply" rel="e:rp">回覆</a>[?.canDel?<a href="javascript:;" class="ico-del" rel="e:dl">刪除</a>?]</div>{.cmtBoxHtml}</div></li>',
Followed:'<span class="followed-icon {.cs}">已關注</span>',MediaBoxContentHtml:'<div class="insert-box"><p>請輸入<a href="http://video.sina.com.cn" target="_blank">新浪播客</a>、<a href="http://www.youku.com" target="_blank">優酷網</a>、<a href="http://www.tudou.com" target="_blank">土豆網</a>、<a href="http://www.ku6.com/" target="_blank">酷6網</a>等視頻網站的視頻播放頁鏈接</p><input type="text" id="xwb_inputor" class="style-normal"><a href="#" class="btn-s1" rel="e:ok"><span>確定</span></a><p class="error-tips hidden" id="xwb_err_tip">你輸入的鏈接地址無法識別<span><a href="#" rel="e:cc">取消操作</a>或者<a href="#" rel="e:nm">作為普通的鏈接</a>發布。</span></p></div>',
PictureBox:'<div class="box-style" style="display:none">\t<div class="box-t skin-bg"><span class="skin-bg"></span></div>\t<div class="box-content">   <div class="show-img"><p><a href="#" rel="e:zo" class="ico-piup">收起</a>   <a href="{.org}" target="_blank" class="ico-src ">查看原圖</a>   <a href="#" class="ico-turnleft" rel="e:tl">向左轉</a>   <a href="#" class="ico-turnright" rel="e:tr">向右轉</a></p>   <div name="img"></div></div>   </div>\t<div class="box-b skin-bg"><span class="skin-bg"></span></div>\t<span class="box-arrow skin-bg"></span></div>',
PictureBoxForward:'<div class="show-img cutline" style="display:none"><p><a class="ico-piup" rel="e:zo" href="#">收起</a><a class="ico-src" target="_blank" href="{.org}">查看原圖</a><a rel="e:tl" class="ico-turnleft" href="#">向左轉</a><a rel="e:tr" class="ico-turnright" href="#">向右轉</a></p><div name="img"></div></div>',PreviewBox:'<div class="preview-img"></div>',VideoThumbHtml:'<div class="feed-img"><img width="120px" height="90px" src="{.img}" alt=""><div class="video-view" rel="e:pv,i:{.id}"></div></div>',
VideoBox:'<div class="box-style showbox" style="display:none">\t<div class="box-t skin-bg"><span class="skin-bg"></span></div>\t<div class="show-video box-content">   <p><a rel="e:cv" href="#" class="ico-piup">收起</a><span>|</span><a title="{.title}" target="_blank" href="{.href}">{.title}</a></p>   <div>{.flash}</div></div>\t<div class="box-b skin-bg"><span class="skin-bg"></span></div>\t<span class="box-arrow skin-bg"></span></div>',VideoBoxForward:'<div class="cutline show-video"><p><a rel="e:cv" href="#" class="ico-piup">收起</a><span>|</span><a title="{.title}" target="_blank" href="{.href}">{.title}</a></p><div>{.flash}</div></div>',
MusicBoxContentHtml:'<div class="insert-box music-box"><p>请输入<a href="http://music.sina.com.cn/yueku/" target="_blank">新浪樂庫</a>等音樂站點的音樂播放鏈接</p><input type="text" id="xwb_inputor" class="style-normal"><a href="#" class="btn-s1" rel="e:ok"><span>確定</span></a><p class="error-tips hidden" id="xwb_err_tip">你的輸入的鏈接地址無法識別<span><a href="#" rel="e:cc">取消操作</a>或者<a href="#" rel="e:nm">作為普通的鏈接</a>發布。</span></p></div>',UploadImgBtn:'<a href="#" rel="e:dlp" class="ico-close-btn" title="刪除"></a>',SearchDropdownList:'<ul class="head-searchlist"><li class="mouseover">含<span></span>的微博</li><li>名<span></span>的人</li></ul>',
PrivateMsgContent:'<div class="field"><label>發私信給：</label><input class="style-normal" type="text" id="sender" /><span class="tips-wrong hidden" id="warnPos">她還沒有關注你,暫時不能發私信</span></div><div class="field"><label>私信内容：</label><textarea class="style-normal" id="content"></textarea></div><input type="hidden" id="uid" value=""><div class="field-area"><div class="icon-face-choose" rel="e:ic"></div><a class="btn-s1 btn-s1-light fl" href="javascript:;" rel="e:sd"><span>发送</span></a><span class="tips-txt" id="word">您還可以輸入140字</span></div>',
NoticeLayer:'<div class="new-tips-fixed hidden"><h4 id="xwb_title">提示</h4><p id="wbs" class="hidden"><span id="c">0</span>條新微博，<a href="{.wbsUrl}">點擊查看</a></p><p id="fans" class="hidden"><span id="c">0</span>個新粉絲，<a href="{.fansUrl}">點擊查看</a></p><p id="cmts" class="hidden"><span id="c">0</span>條新評論，<a href="{.cmtsUrl}">點擊查看</a></p><p id="msgs" class="hidden"><span id="c">0</span>封新私信，<a href="{.msgsUrl}">點擊查看</a></p><p id="refer" class="hidden"><span id="c">0</span>條微博提到了，<a href="{.referUrl}">點擊查看</a></p><p id="notify" class="hidden"><span id="c">0</span>條通知，<a href="{.notifyUrl}">點擊查看</a></p><a href="#" class="ico-close-btn" id="xwb_cls" ></a></div>',
NoticeLayer2:'<div class="new-tips"><a id="wbs" class="hidden" href="{.wbsUrl}"><span id="c">0</span>條新微博</a><a id="fans" class="hidden" href="{.fansUrl}"><span id="c">0</span>個新粉絲</a><a id="cmts" class="hidden" href="{.cmtsUrl}"><span id="c">0</span>條新評論</a><a id="msgs" class="hidden" href="{.msgsUrl}"><span id="c">0</span>封新私信</a><a id="refer" class="hidden" href="{.referUrl}"><span id="c">0</span>條微博提到你</a><a id="notify" class="hidden" href="{.notifyUrl}"><span id="c">0</span>條通知</a><a href="javascript:;" class="ico-close-btn" id="xwb_cls"></a></div>',
Login:'<div class="login-area">\t<span><a href="{.regUrl}">註冊帳戶</a></span><a class="btn-web-account bind-btn-bg" href="{.siteLoginUrl}">{.siteName}登入</a>\t<span><a href="{.sinaRegUrl}" target="_blank">開通微博</a></span><a class="btn-sina-account bind-btn-bg" href="#" id="oauth">新浪微博帳戶登入</a></div><div class="bind-tips">提示：您可以使用{.siteName}帳戶或新浪微博帳戶登入本網站</div>',PostBoxContent:'<div class="post-box"><div class="post-title" id="postTitle">有什麼新鮮事告訴大家？</div><div class="key-tips" id="xwb_word_cal">您還可以輸入<span>140</span>字</div><div class="post-textarea" id="focusEl"><div class="inner"><textarea id="xwb_inputor"></textarea></div></div><div class="add-area"><a class="ico-face" href="#" rel="e:ic">表情</a><span class="pic_uploading hidden" id="xwb_upload_tip">正在上載..</span><span class="pic-name hidden" id="xwb_photo_name"><a class="ico-close-btn" href="#" ></a></span><div class="share-upload-pic" id="uploadBtn"><form class="upload-pic"  method="post"  enctype="multipart/form-data" id="xwb_post_form" action="" target=""><input type="file" name="pic" id="xwb_img_file" value="" /></form><a class="ico-pic" href="#" id="xwb_btn_img">圖片</a></div><a class="ico-video" href="#" id="xwb_btn_vd" rel="e:vd">視頻</a><a class="ico-music" href="#" id="xwb_btn_ms" rel="e:ms">音樂</a><a class="ico-topic" href="#" id="xwb_btn_tp" rel="e:tp">話題</a></div><div class="share-btn" rel="e:sd"></div><div class="post-success hidden" id="xwb_succ_mask"><span clsss="icon-success"></span>發布成功！</div><div class="post-verify ico-verify hidden" id="xwb_veri_mask">信息已進入審核中</div></div>',
AnchorTipContent:'<div class="tips-c"><div class="tips-ok"></div><p id="xwb_title"></p></div>',AnchorDlgContent:'<div class="tips-c"><div class="ico-ask"></div><p id="xwb_title"></p></div>',SpanBoxContent:'<div class="win-box-inner"><p class="desc">不良信息是指含有色情、暴力、廣告或其他難捱你正常微博生活的內容。</p><p>你要舉報的是“{.nick}”發的微博：</p><div class="report-box"><div>{.text}</div><img src="{.img}" class="user" width="30px" height="30px" ></div><p>你可以填寫更多舉報說明：（選填）</p><p><textarea rows="" cols="" id="content"></textarea></p><div class="foot-con"><p>請放心，您的隱私將會得到保護。<br>舉報電話：400 690 0000</p><div class="btn-area"><a href="#" class="btn-s1 btn-s1-light" rel="e:ok"><span>確認舉報</span></a><a href="#" class="btn-s1" rel="e:cancel"><span>取消</span></a></div></div></div>',
addFollowContent:'<input type="text" id="Content"/><a class="btn-s1" href="javascript:;" rel="e:submit" ><span>儲存</span></a><p>請添加想關注的話題</p><p class="warn hidden">添加關注話題失敗</p>',evevtApplicants:'<div class="field"><label>聯絡方式：</label><input type="text" name="contact" id="contact"/></div>        <div class="field"><label>備註：</label><textarea name="note" id="note"></textarea></div>          <div class="field-area">            <a href="javascript:;" class="btn-s1 btn-s1-light fl" rel="e:sd"><span>發送</span></a>            <span class="tips-txt" id="tips">說明：長度不能超過100個字</span>            <span class="tips-wrong hidden" id="wrong">這裡是提示信息</span>        </div>',
colorBox:'<ul><li class="cur" rel="e:getCls,c:#000,w:bg1"><span style="background:#000"></span></li><li rel="e:getCls,c:#808080,w:bg2"><span style="background:#808080"></span></li><li rel="e:getCls,c:#f66,w:bg3"><span style="background:#f66"></span></li><li rel="e:getCls,c:#90c,w:bg4"><span style="background:#90c"></span></li><li rel="e:getCls,c:#e7f2fb,w:bg5"><span style="background:#e7f2fb"></span></li><li rel="e:getCls,c:#fff,w:bg6"><span style="background:#fff"></span></li><li rel="e:getCls,c:#f00,w:bg7"><span style="background:#f00"></span></li><li rel="e:getCls,c:#f60,w:bg8"><span style="background:#f60"></span></li><li rel="e:getCls,c:#fc0,w:bg9"><span style="background:#fc0"></span></li><li rel="e:getCls,c:#090,w:bg10"><span style="background:#090"></span></li></ul><div class="btn-area"><a href="#" class="btn-s1" rel="e:comf"><span>確定</span></a></div>',
colorpicker:'<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div><div class="cp-oper"><span class="txt" id="cltitle">主鏈接色</span><span class="c-view" id="cRealColor"><span style="background:#0082cb;"></span></span><label>#<input value="" class="input-txt" id="colorshow" /></label></div><a href="#" class="btn-close" rel="e:closeCls"></a></div>',
verify:'<div class="verify-c tips ico-verify">該信息在審核中，請稍後再試！</div>'});(function(q,l){var u=q.util.arrayRemove,t=q.ax.Eventable=function(o){o&&l.extend(this,o);l.extend(this,t.prototype)};t.prototype={fire:function(o){__debug&&console.log("发送:%o",arguments);if(this.events){var m=this.events[o];if(m){var g=l.makeArray(arguments),h,i,b,c,a;g.shift();h=g.length;m._evtLocked=true;b=0;for(c=m.length;b<c;b++){a=m[b];if(!a.removed){if(a.args)g[h]=a.args;i=a.ds?a.cb.apply(a.ds,g):a.cb.apply(this,g);if(i===false)break}}m._evtLocked=false}}return i},on:function(o,m,g,h){if(!o||
!m){__debug&&console.trace();throw"eid or callback can not be null";}if(!this.events)this.events={};var i=this.events[o];i||(i=this.events[o]=[]);i[i.length]={cb:m,ds:g,args:h};return this},un:function(o,m){if(!this.events)return this;if(m===undefined){delete this.events[o];return this}var g=this.events[o];if(g){if(g._evtLocked)g=this.events[o]=g.slice(0);for(var h=0;h<g.length;h++){var i=g[h];if(i.cb==m){u(g,h);i.removed=true;break}}}return this},fireOnce:function(o){var m=this.fire.apply(this,arguments);
this.un(o);return m}}})(Xwb,$);(function(q,l,u){q.ax.SelectionHolder=function(t){u.extend(this,t);l.hasSelectionSupport()||this.initEvent(this.elem)};q.ax.SelectionHolder.prototype={pos:-1,length:0,initEvent:function(){var t=this,o=function(){try{t.saveSpot()}catch(m){}};u(this.elem).mouseup(o).keyup(o).data("xwb_selholder",this)},saveSpot:function(){var t=this.elem;this.pos=l.getCursorPos(t);this.length=l.getSelectionText(t).length},insertText:function(t){var o=this.elem,m=o.value;if(l.hasSelectionSupport())l.replaceSelection(o,
t);else if(this.pos===-1){o.value=m+t;l.focusEnd(o)}else{o.value=l.stringReplace(m,t,this.pos,this.pos+this.length);l.setCursor(o,this.pos+t.length)}this.saveSpot()},setText:function(t){this.elem.value=t;try{this.focusEnd()}catch(o){}},clearSpot:function(){this.length=0;this.pos=-1},focusEnd:function(){l.focusEnd(this.elem);this.saveSpot()},focusStart:function(){l.setCursor(this.elem,0);this.saveSpot()},replaceString:function(t,o,m){this.elem.value=l.stringReplace(this.elem.value,t,o,m);l.setCursor(this.elem,
o+t.length);this.saveSpot()}};q.reg("SelectionHolder",q.ax.SelectionHolder)})(Xwb,Xwb.util,$);(function(q,l,u){function t(m){this.q=m;this.idx=-1;this.end=this.q.length-1}t.prototype={prevented:void 0,stopPropagationed:void 0,get:function(m){var g=this.getRel(m);return g&&g.data&&g.data[m]},escape:function(m){m=this.get(m);if(m!==void 0)return escape(m)},getEl:function(m){return(m=this.getRel(m))&&m.src},clear:function(m){m=m?this.getRel(m):this;m=u(m.src);m.data("xwb_rel",null);m.attr("rel","")},save:function(m,g,h){var i=h?this.getRel(h):this;h=u(i.src);var b=h.data("xwb_rel");if(b)b=b[m]=
g;else{b=q.ax.ActionMgr.parseRel(h.attr("rel"));b[m]=g}i.data=b;h.data("xwb_rel",b);m=[];for(var c in b)m.push(c+":"+(b[c]||"").replace(":","\\:").replace(",","\\,"));m=m.join(",");h.attr("rel",m)},jq:function(m,g){var h=u(this.getEl(m));if(g)h=h.find(g);return h},getRel:function(m){for(var g=this.q,h=this.idx,i=this.end;h<=i;h++)if(g[h].data[m]!==void 0)return g[h]},_next:function(){var m=this.q[++this.idx];if(m===void 0)this.idx=0;return m},clone:function(){var m=new t(this.q);m.idx=0;return m},
preventDefault:function(m){this.prevented=m},stopPropagation:function(m){this.stopPropagationed=m},lock:function(m,g){var h="xwb_e_"+this.data.e;if(g)h+="_"+g;if(m===void 0)return u(this.src).data(h);u(this.src).data(h,m)}};q.ax.ActionMgr=q.reg("ActionMgr",function(m){m&&u.extend(this,m);if(!this.actions)this.actions={};if(!this.filters)this.filters=[];if(this.target){this.bind(this.target);delete this.target}});var o=[];q.ax.ActionMgr.parseRel=function(m){if(typeof m==="string")return l.parseKnV(m);
return l.parseKnV(u(m).attr("rel"))};q.ax.ActionMgr.collectRels=function(m,g,h){var i,b,c=this;if(h===void 0)h=true;l.domUp(m,function(a){var e=u(a);if(h){b=e.data("xwb_rel");if(!b)if(b=e.attr("rel")){b={src:a,data:c.parseRel(b)};e.data("xwb_rel",b)}}else if(b=e.attr("rel"))b={src:a,data:c.parseRel(b)};if(b){i||(i=[]);i[i.length]=b}},g);return i};q.ax.ActionMgr.wrapRel=function(m,g,h){m=this.collectRels(m,g,h);m=new t(m);m._next();return m};q.ax.ActionMgr.getRel=function(m,g,h){return this.wrapRel(m,
h).get(g)};q.ax.ActionMgr.prototype={trigEvent:"click",cacheNodeData:true,reg:function(m,g,h){g={n:m,h:g};h&&u.extend(g,h);this.actions[m]=g;return this},get:function(m){return this.actions[m]},addFilter:function(m,g){g?o.push(m):this.filters.push(m);return this},bind:function(m,g){var h=this;u(m).bind(g||this.trigEvent,function(i){var b=q.ax.ActionMgr.collectRels(i.target,this,this.cacheNodeData);b&&h.fireRels(b,i)});return this},doAct:function(m,g,h){m=q.ax.ActionMgr.collectRels(m,g,h);return!(m&&
this.fireRels(m))},fireRels:function(m,g){var h=new t(m);h.evt=g;__debug&&console.log("act e:",h);for(var i,b,c=o.length,a=this.filters.length,e,k,s;i=h._next();){b=i.data;if(b.e){h.src=i.src;h.data=b;if(h.lock()){__debug&&console.warn("action e:"+h.data.e+" has been locked for resubmiting");k=s=e=true;break}else{i=this.actions[b.e];if(c){e=true;if(this._fireArray(o,h,i)===false){s=h.stopPropagationed;k=h.prevented;break}}if(a){e=true;if(this._fireArray(this.filters,h,i)===false)break}s=h.stopPropagationed;
k=h.prevented;if(i){var d=h.clone();d.src=h.src;d.data=b;d.evt=g;__debug&&console.log("act e:",d);e||(e=true);if(i.h.call(this,d)===false){if(d.stopPropagationed!==void 0)s=d.stopPropagationed;if(d.prevented!==void 0)k=d.prevented;break}if(d.stopPropagationed!==void 0)s=d.stopPropagationed;if(d.prevented!==void 0)k=d.prevented}}}}if(g&&e){if(k===void 0)k=true;if(s===void 0)s=true;k&&g.preventDefault();s&&g.stopPropagation()}},_fireArray:function(m,g,h){for(var i=0,b=m.length;i<b;i++)if(m[i].call(this,
g,h)===false)return false}};q.reg("action",q.use("ActionMgr"))})(Xwb,Xwb.util,$);(function(){function q(o,m){this.elem=m;this.context=o;this.nextChain=u.bind(this._doNextChain,this)}var l=Xwb,u=l.util;q.prototype={validate:function(o){if(this.validating)throw"Concurrent validation exception.";this.setValue(this._getRawValue(this.elem));this._finalChain=o;this.idx=-1;this.error=0;this.msgs=[];this._doNextChain()},_getRawValue:function(o){o=o.value;if(typeof o==="string")o=$.trim(o);return o},getValue:function(){return this.value},setValue:function(o){this.value=o},getErrors:function(){return this.msgs},
addError:function(o){this.msgs.push(o)},doPrehandling:function(){for(var o=this.context,m=0,g;(g=o.nextValidatorData(m++,this.elem))&&g.isPreCmd;)if(typeof g[0]==="string"){var h=o.getValidator(g[0]);if(!h)throw"ValidationException:Undefined validator '"+g[0]+"' in element "+this.elem.name;h.call(this,this.elem,g[1])}else g[0].call(this,this.elem,g[1])},_doNextChain:function(){this.idx++;var o=this.context.nextValidatorData(this.idx,this.elem);if(o)if(o.isPreCmd)this.nextChain();else if(typeof o===
"function"){o[1]={};o.call(this,this.elem,this.getValue(),o[1],this.nextChain)}else if(typeof o[0]==="string"){var m=this.context.getValidator(o[0]);if(!m)throw"ValidationException:Undefined validator ["+o[0]+"] in element "+this.elem.name;m.call(this,this.elem,this.getValue(),o[1],this.nextChain)}else o[0].call(this,this.elem,this.getValue(),o[1],this.nextChain);else{if(!this.error){__debug&&console.log("onpass",this.elem,this);this.context.onpass(this.elem,this)}this._finalChain&&this._finalChain();
this._finalChain=null}},report:function(o,m){o||this.error++;var g=this.elem;this.context.report(o,m,g,this);if(!o){__debug&&console.log("onerror",g,m);this.context.onerror(g,m,this)}}};var t;l.ax.ValidationMgr=function(o){$.extend(this,o);this.init()};l.ax.ValidationMgr.prototype={nextValidatorData:function(o,m){var g=this._getBindingValidators(m);return g&&g[o]},getValidator:function(o){var m=this.validators,g;if(m)g=m[o];if(!g&&t)g=t[o];return g},report:function(o,m,g,h){if(!o)if(h.multival){this.error++;
if(this.error===1&&this.autoFocus)try{g.focus()}catch(i){}}},getMgr:function(){return this},trigOnSubmit:true,onfinal:$.noop,autoFocus:true,init:function(){t||(t={});this.nextChain=u.getBind(this,"_doNextChain");this.form=$(this.form)[0];var o=this;$.each(this._getElements(),function(){(new q(o,this)).doPrehandling()});var m=function(){o.validate();return false};if(this.trigOnSubmit)this.form.onsubmit=m;if(this.trigger){this.trigger=$(this.trigger)[0];$(this.trigger).click(function(){return m()})}},
validateElement:function(o){this.isGlobalVal||this._validateElem(o)},validate:function(){if(!this.isGlobalVal){this.elems=this._getElements();this.currElIdx=-1;this.error=0;this.isGlobalVal=true;this.data={};this.param&&$.extend(this.data,this.param);this.uniqueId=u.uniqueId();this.decorateTrigger&&this.trigger&&u.disable(this.trigger,true);this._doNextChain()}return false},reg:function(o,m){t||(t={});if($.isArray(o))for(var g=0,h=o.length;g<h;g++)this.reg.apply(this,o[g]);else t[o]=m;return this},
onsuccess:function(o,m){m()},_getElements:function(){return this.elements||this.form.elements},_doNextChain:function(){var o=this.elems.length;this.currElIdx>=0&&this.currElIdx<o&&!this.error&&this._collectValue(this.elems[this.currElIdx]);this.currElIdx++;if(this.currElIdx===o)if(this.error)this._finalChain();else{__debug&&console.log("onsuccess",this.data);this.onsuccess(this.data,this.nextChain)!==false&&this.form.submit()}else if(this.currElIdx>o)this._finalChain();else{o=this.elems[this.currElIdx];
o.disabled?this._doNextChain():this._validateElem(o,this.nextChain,true)}},_validateElem:function(o,m,g){if($(o).attr("vrel")){o=new q(this,o);if(g){o.multival=true;this.currentChain=o}o.validate(m)}else m&&m()},lock:function(o){this.isGlobalVal=o?true:false},_finalChain:function(){this.onfinal();this.isGlobalVal=false;this.data&&delete this.data;delete this.currentChain;this.decorateTrigger&&this.trigger&&u.disable(this.trigger,false)},_collectValue:function(o){if(this.currentChain&&this.currentChain.elem===
o)this.data[o.name]=this.currentChain.getValue();else{if(o.tagName==="INPUT")if(o.type==="radio"||o.type==="checkbox"){if(!o.checked)return}else if(o.type==="submit")return;this.data[o.name]=o.value}},_getBindingValidators:function(o){var m,g=$(o);if(this.useCache)if(g.data("xwb_vd_cmds"))m=g.data("xwb_vd_cmds");else{m=this.parseCmd(g.attr("vrel"));this._mergeExtraValidators(m,o);g.data("xwb_vd_cmds",m)}else{m=this.parseCmd(g.attr("vrel"));g.data("xwb_vd_cmds",m);this._mergeExtraValidators(m,o)}return m},
_mergeExtraValidators:function(o,m){var g=this.extraValidators;if(g&&g[m.name||m.id])$.merge(o,g[m.name||m.id])},parseCmd:function(o){if(!o)return[];var m=[];o=u.split(o,"|");for(var g,h=0,i=o.length;h<i;h++){if(o[h].indexOf("=")===-1)g=[o[h],{}];else{g=u.split(o[h],"=");g[1]=u.parseKnV(g[1])}if(g[0].charAt(0)==="_"){g.isPreCmd=true;g[0]=g[0].substr(1)}m[m.length]=g}return m},errTipName:"warntip",tipTextNode:"#tle",warnType:1,tipTextType:"",comForm:false,focusCss:"style-focus",disableCss:"style-disabled",
errCss:"style-wrong",haveSpace:true,okTip:"oktip",onerror:function(o,m,g){var h=true;g.addError(m.m);if(m=$(o).attr(this.errTipName)){m=this.getWarnTip(o,m);if(this.isGlobalVal&&g.error==1){var i=m.data("vrel_previd"),b=m.data("vrel_errors")||0;if(this.uniqueId!=i){m.data("vrel_previd",this.uniqueId);m.data("vrel_errors",0);b=0}else h=b==0;m.data("vrel_errors",++b)}}if(h){g=g.getErrors();if(this.warnType===1){if(g.length!=0)g=g[0]}else g=g.join("，");this.tipWarn(o,g)}},getWarnTip:function(o,m){var g=
$(o).find(m);g.length||(g=$(m));return g},onpass:function(o){var m=$(o).attr(this.errTipName),g=true;if(m){m=this.getWarnTip(o,m);if(this.isGlobalVal){var h=m.data("vrel_previd"),i=m.data("vrel_errors")||0;if(this.uniqueId!=h){m.data("vrel_previd",this.uniqueId);m.data("vrel_errors",0)}else g=i==0}}g&&this.tipPass(o)},tipWarn:function(o,m){var g=$(o).attr(this.errTipName);if(g){g=this.getWarnTip(o,g);var h=g.cssDisplay(true).find(this.tipTextNode);h.length||(h=g);this.tipTextType==="text"?h.text(m):
h.html(m);return g}if(g=$(o).attr(this.okTip))this.haveSpace?$(g).css("visibility","hidden"):$(g).cssDisplay(false)},tipPass:function(o){var m=$(o).attr(this.errTipName);m&&$(m).cssDisplay(false);if(o=$(o).attr(this.okTip))this.haveSpace?$(o).css("visibility",""):$(o).cssDisplay(true)}};l.reg("Validator",l.ax.ValidationMgr)})();(function(q,l,u){q.ax.Shortlink=function(t){u.extend(this,t);this._c={}};q.ax.Shortlink.prototype={EXTERNAL_URL:"http://t\\.cn|http://sinaurl\\.cn",local:"",_getReg:function(t){var o=this.slReg;if(!o){o=this.local;o=this.slReg=[o?RegExp("(?:"+o.replace(".","\\.")+"|"+this.EXTERNAL_URL+")/([0-9a-z]+)","gi"):RegExp("(?:"+this.EXTERNAL_URL+")/([0-9a-z]+)","gi"),o?RegExp("(?:"+o.replace(".","\\.")+"|"+this.EXTERNAL_URL+")/([0-9a-z]+)","i"):RegExp("(?:"+this.EXTERNAL_URL+")/([0-9a-z]+)","i")]}return o[t]},
getUrls:function(){return this._c},search:function(t){var o=[];if(t)for(var m=this._getReg(0);m.exec(t)!=null;)o.push(RegExp.$1);return o},is:function(t){return this._getReg(1).test(t)&&RegExp.$1},from:function(t,o){var m={},g=[],h,i,b,c,a,e;for(e in t){a=t[e].shortlinks=[];h=this.search(t[e].tx);i=0;for(b=h.length;i<b;i++){c=h[i];if(!m[c]){m[c]=true;g.push(c)}a.push([c])}if(t[e].rt){h=this.search(t[e].rt.tx);i=0;for(b=h.length;i<b;i++){c=h[i];if(!m[c]){m[c]=true;g.push(c)}a.push([c,true])}}if(t[e].s){h=
this.search(t[e].s);i=0;for(b=h.length;i<b;i++){c=h[i];if(!m[c]){m[c]=true;g.push(c)}a.push([c])}}}this.info(g,function(k){for(var s in t)for(var d=t[s].shortlinks,j,p=0,r=d.length;p<r;p++){j=d[p][0];if(k[j]){d[p][0]=k[j];k[j].id=j}else d[p][0]=null;d[j]=d[p]}o(t)})},info:function(t,o){for(var m=this._c,g=t.length-1;g>=0;g--)m[t[g]]&&l.arrayRemove(t,g);t.length?q.request.sinaurl(t.join(","),function(h){if(h.isOk()){u.each(h.raw.data,function(i,b){m[i]||(m[i]=b)});o(m)}}):o(m)},render:function(t,o){var m=
this,g=[],h=[];u(t).find("a").each(function(){if(sl=m.is(this.href)){g.push([sl,this]);h.push(sl)}});this.info(h,function(i){for(var b=0,c=g.length;b<c;b++)o(i[g[b][0]],g[b][1])})}}})(Xwb,Xwb.util,$);(function(q,l){function u(){return this.view}var t=q.util,o=q.ax.Tpl,m=document,g=l(window),h=l(m),i=q.ui={Base:t.create()},b=i.Base;i.Base.prototype={autoRender:false,titleNode:"#xwb_title",init:function(c){this.cacheId="c"+t.uniqueId();c&&l.extend(this,c);this.initUI();this.autoRender&&this.getView()},initUI:l.noop,clsNode:"#xwb_cls",initClsBehave:function(c){this.jq(this.clsNode).click(t.bind(this.onClsBtnClick,this));this.setCloseable(c)},setCloseable:function(c){l(this.clsNode).cssDisplay(c);
this.closeable=c},onClsBtnClick:function(){this.close(true);return false},close:function(){if(!this.onclose||this.onclose()!==false)this.destroyOnClose?this.destroy():this.display(false)},tplData:false,createView:function(){var c=this.view;if(typeof c==="string")c=this.view=o.forNode(o.get(c)||c,this.tplData||this,true);else this.view=c=m.createElement("DIV");return l(c)[0]},innerViewReady:l.noop,setTitle:function(c){this.jq(this.titleNode).html(c);return this},getView:function(){var c=this.view;
if(!c||!c.tagName)c=this.createView();this.getView=u;if(this.appendTo){l(this.appendTo).append(c);delete this.appendTo}this.closeable!==void 0&&this.initClsBehave(this.closeable);if(this.actionMgr){this.actionMgr=q.use("ActionMgr",this.actionMgr);this.actionMgr.bind(c);if(this.onactiontrig){var a=this;this.actionMgr.addFilter(function(k){return a.onactiontrig(k)})}}this.innerViewReady(c);this.onViewReady&&this.onViewReady(c);if(this.hidden!==void 0){var e=this.hidden;this.hidden=void 0;this.display(!e)}return c},
fly:function(c){this.view=c&&c[0]||c;return this},beforeShow:l.noop,afterShow:l.noop,beforeHide:l.noop,afterHide:l.noop,jqExtra:function(){for(var c=arguments,a=0,e=c.length;a<e;a++){var k=c[a],s=this.jq("#"+k);if(s){k=k.charAt(0).toUpperCase()+k.substring(1);this["jq"+k]=s}}return this},display:function(c){var a=this.jq();if(c===void 0)return!a.hasClass("hidden");c=!c;if(this.hidden!==c)if(c){if(this.beforeHide()!==false){this.hidden=c;a.addClass("hidden");this.afterHide&&this.afterHide();this.contexted&&
this.setContexted(false)}}else{this.hidden=c;a.css("visibility","hidden").removeClass("hidden");this.beforeShow();a.css("visibility","");this.contextable&&!this.contexted&&this.setContexted(true);this.afterShow()}return this},onContextRelease:function(){this.display(false)},appendAt:function(c){l(c).append(this.getView());return this},ancestorOf:function(c,a){c=c.view||c;return t.ancestorOf(this.view,c,a)},jq:function(c){return c===void 0?l(this.getView()):l(this.getView()).find(c)},destroy:function(){this.display(false);
this.jq().remove()},domEvent:function(c,a,e){if(c==="mousedown"){var k=this,s=function(d){k.contexted||q.use("contextMgr").releaseAll(d);return a.apply(k,arguments)};if(!this._mousedownFns)this._mousedownFns={};this._mousedownFns[a]=s;this.jq(e).bind(c,s)}else this.jq(e).bind(c,a)},unDomEvent:function(c,a,e){if(c==="mousedown"){var k=this._mousedownFns[a];this.jq(e).unbind(c,k);delete this._mousedownFns[a]}else this.jq(e).unbind(c,a)},setContexted:function(c){if(this.contexted!==c)c?q.use("contextMgr").context(this):
q.use("contextMgr").release(this);return this},templ:function(c){for(var a in c)this.jq(a).html(c[a]);return this},offset:function(){if(arguments.length){this.jq().css(arguments[0]);return this}return this.jq().offset()},offsetsTo:function(c){c=c instanceof l&&c[0]||c;c=c==window?{left:h.scrollLeft(),top:h.scrollTop()}:l(c).offset();var a=this.jq().offset();return[a.left-c.left,a.top-c.top]},scrollIntoView:function(c,a){var e=c?c.view||c[0]||c:m.body,k=this.getHiddenAreaOffsetVeti(e);if(k!==false)e.scrollTop=
k;if(a){k=this.getHiddenAreaOffsetHori(c);if(k!==false)e.scrollLeft=k}return this},getHiddenAreaOffsetVeti:function(c){var a=c.view||c[0]||c,e=this.view,k=this.offsetsTo(a);c=parseInt(a.scrollTop,10);k=k[1]+c;e=e.offsetHeight;var s=k+e;a=a.clientHeight;var d=c+a;if(e>a||k<c)return k;else if(s>d){s-=a;if(c!=s)return s}return false},getHiddenAreaOffsetHori:function(c){var a=c.view||c[0]||c,e=this.view;c=parseInt(a.scrollLeft,10);var k=this.offsetsTo(a)[0]+c;e=e.offsetWidth;a=a.clientWidth;var s=k+e,
d=c+a;if(e>a||k<c)return k;else if(s>d){s-=a;if(s!=c)return s}return false},anchor:function(c,a,e,k){var s=l(c);c=this.jq();var d=s.offset(),j=s.width(),p=s.height();s=c.width();var r=c.height(),w=a.charAt(0),x=a.charAt(1);a=d.left;d=d.top;switch(w){case "t":d-=r;break;case "b":d+=p;break;case "c":d+=Math.floor((p-r)/2)}switch(x){case "c":a+=Math.floor((j-s)/2);break;case "r":a+=j-s}if(e){j=j=[a,d];e(j,s,r);a=j[0];d=j[1]}if(k){if(d<0)d=0;else{e=g.height();if(d+r-h.scrollTop()>e)d=e-r+h.scrollTop()}if(a<
0)a=0;else{e=g.width();if(a+s-h.scrollLeft()>e)a=e-s+h.scrollLeft()}}c.css("left",a+"px").css("top",d+"px")},center:function(){var c=this.jq(),a=[g.width(),g.height()];c=[c.width(),c.height()];var e=(a[1]-c[1])*0.8;this.view.style.left=Math.max((a[0]-c[0])/2|0,0)+(this.isFixed&&!t.ie6?0:h.scrollLeft())+"px";this.view.style.top=Math.max(e-e/2|0,0)+(this.isFixed&&!t.ie6?0:h.scrollTop())+"px";return this},clip:function(){if(!b.CLIP_WRAPPER_CSS){b.CLIP_WRAPPER_CSS={position:"absolute",clear:"both",overflow:"hidden"};
b.CLIPPER_CSS={position:"absolute",left:0,top:0}}if(!this.jqClipWrapper){var c=l(q.ax.Cache.get("div")),a=this.getView(),e=this.jq(),k=a.parentNode,s=e.offset();c.css(b.CLIP_WRAPPER_CSS).css(s).css("width",e.width()+"px").css("height",e.height()+"px").css("z-index",e.css("z-index")).append(a);s=this._tmpClipedCss={};for(var d in b.CLIPPER_CSS)s[d]=a.style[d];e.css(b.CLIPPER_CSS);k&&c.appendTo(k);this.jqClipWrapper=c}return this.jqClipWrapper},unclip:function(){if(this.jqClipWrapper){var c=this.jqClipWrapper[0],
a=c.style,e=this.jq(),k=e[0].style,s;for(s in b.CLIP_WRAPPER_CSS)a[s]="";this.jqClipWrapper.css("overflow","").css("width","").css("height","");a=this._tmpClipedCss;for(s in a)k[s]=a[s];delete this._tmpClipedCss;c.removeChild(e[0]);c.parentNode&&this.jqClipWrapper.replaceWith(e);q.ax.Cache.put("div",c);delete this.jqClipWrapper}},slide:function(c,a,e,k,s,d){var j=this.jq(),p=j.width(),r=j.height(),w=0,x=0,y=0,z=0;this.clip();var B=c.charAt(0);c=c.charAt(1);switch(B){case "l":w=0-p;break;case "r":w=
0+p;break;case "t":x=0-r;break;case "b":x=0+r}switch(c){case "l":y=0-p;break;case "r":y=0+p;break;case "t":z=0-r;break;case "b":z=0+r}j.css("left",w).css("top",x);k||(k={});if(y!=w)k.left=k.left===void 0?y:k.left+y;if(z!=x)k.top=k.top===void 0?z:k.top+z;a&&j.css("visibility","");var C=this;j.animate(k,s||"fast",d,function(){if(!a){C.display(false);j.css("visibility","")}setTimeout(function(){C.unclip();e&&e(C)},0)})}};q.reg("base",b)})(Xwb,$);Xwb.reg("contextMgr",function(){var q=Xwb,l=q.util,u=document,t={context:function(o){o.contexted&&this.release(o);var m=this.q;if(!m)this.q=m=[];m.length||$(u).mousedown(this._getDocEvtHandler());m[m.length]=o;this._setCompEvtHandler(o,true);o.contexted=true;__debug&&console.log("contexted",o)},release:function(o,m){o.contexted=false;if(o.onContextRelease(m)!==false){this._setCompEvtHandler(o,false);l.arrayRemove(this.q,o);this.q.length||$(u).unbind("mousedown",this._getDocEvtHandler())}else o.contexted=
true;__debug&&console.log("release context",o)},releaseAll:function(o){var m=this.q;if(m){if(o)var g=o.target;for(var h=m.length-1;h>=0;h--)if(!g||!m[h].ancestorOf(g))this.release(m[h],o)}},_setCompEvtHandler:function(o,m){m?o.domEvent("mousedown",this._compEvtStopHandler):o.unDomEvent("mousedown",this._compEvtHandler)},_getDocEvtHandler:function(){var o=this.docEvtHd;if(!o)o=this.docEvtHd=l.bind(this._docHandler,this);return o},_releaseFollower:function(o,m){var g=this.q;if(g){var h=g.length-1;if(h!==
-1&&g[h]!==o)for(;h>=0;h--){if(g[h]===o)break;this.release(g[h],m)}}},_compEvtStopHandler:function(o){if(o.target.nodeName=="SELECT"||o.target.nodeName=="INPUT")return true;t._releaseFollower(this,o);return false},_compEvtHandler:function(o){t._releaseFollower(this,o)},_docHandler:function(o){this.releaseAll(o)}};q.ax.contextMgr=t;q.reg("contextMgr",t,true);return t});(function(q,l){var u=q.util,t=q.ax.Tpl,o=document,m=q.ui.Base,g=q.ui,h=10001,i=l(window),b={layers:[],hash:{},keyListeners:0,add:function(a){var e=a.cacheId;if(!this.hash[e]){this.layers.push(a);if(a.keyEvent){if(this.keyListeners===0){__debug&&console.log("bind key listener");l(o).bind("keydown",this.getEvtHandler())}this.keyListeners++}this.hash[e]=true}},remove:function(a){var e=a.cacheId;if(this.hash[e]){var k=this.layers;k[k.length-1]===a?k.pop():u.arrayRemove(k,a);this.keyListeners--;if(this.keyListeners===
0){__debug&&console.log("remove key listener");l(o).unbind("keydown",this.getEvtHandler())}delete this.hash[e]}},getEvtHandler:function(){var a=this._onDocKeydown;if(!a)a=this._onDocKeydown=u.bind(this.onDocKeydown,this);return a},onDocKeydown:function(a){var e=this.layers[this.layers.length-1];if(e&&e.keyEvent)return e.onKeydown(a)}},c=g.Layer=u.create(m,{hidden:true,onViewReady:l.noop,frameMask:u.ie6,trackZIndex:function(){if(this.z!==h){h+=3;this.mask&&l(this.mask).css("z-index",h-1);this.frameMask&&
l(this.getFrameMask()).css("z-index",h-2);this.jq().css("z-index",h);this.z=h}},keyEvent:true,onKeydown:function(a){if(a.keyCode===27&&!this.cancelEscKeyEvent){this.close();return false}},beforeShow:function(){this.mask&&this._applyMask(true);var a=this.jq().css("position");if(a==="absolute"||a==="fixed")this.trackZIndex();b.add(this);this.autoCenter&&this.center()},afterHide:function(){this.mask&&this._applyMask(false);b.remove(this)},getFrameMask:function(){if(this.frameMaskEl)return this.frameMaskEl;
return this.frameMaskEl=t.forNode('<iframe class="shade-div shade-iframe" frameborder="0"></iframe>')},_applyMask:function(a){var e=this.mask;if(!e||e===true)e=this.mask=t.forNode(t.get("Mask"));var k=i.height();if(a){l(e).height(k).appendTo(o.body);this.frameMask&&l(this.getFrameMask()).height(k).appendTo(o.body);i.bind("resize",u.getBind(this,"onMaskWinResize"))}else{l(e).remove();this.frameMask&&l(this.getFrameMask()).remove();i.unbind("resize",u.getBind(this,"onMaskWinResize"))}},onMaskWinResize:function(){var a=
this.mask,e=i.height();a&&l(a).height(e);this.frameMask&&l(this.getFrameMask()).height(e);this.autoCenter&&this.center()}});c.setCurrentZ=function(a){h=a};q.reg("Layer",c);g.Switcher=function(a){a&&l.extend(this,a);this.initUI()};q.reg("Switcher",g.Switcher);g.Switcher.prototype={trigMode:"click",initUI:function(){this.items&&this.add(this.items,this.contents)},select:function(a){var e=this.selectedItem;this.autoRecover&&this.clearTimer(1);if(this.selectedCS){e&&l(e).removeClass(this.selectedCS);
l(a).addClass(this.selectedCS)}this.onselect&&this.onselect(a);this.selectedItem=a;if(a.contentEl){var k=a.contentEl;setTimeout(function(){e&&e.contentEl&&l(e.contentEl).cssDisplay(false);l(k).cssDisplay(true)},0)}},unselect:function(a){this.selectedCS&&l(a).removeClass(this.selectedCS);a.contentEl&&l(a.contentEl).cssDisplay(false);this.mouseoutTimer&&this.clearTimer(1);this.selectedItem=NULL},clearTimer:function(a){if(a!==0){if(this.mouseoutTimer){clearTimeout(this.mouseoutTimer);this.mouseoutTimerFn=
this.mouseoutTimer=false}}else if(this.mouseoverTimer){clearTimeout(this.mouseoverTimer);this.mouseoverTimerFn=this.mouseoverTimer=false}},add:function(a,e){if(a.length)if(e)for(var k=0,s=a.length;k<s;k++)this.add(a[k],e[k]);else{k=0;for(s=a.length;k<s;k++)this.add(a[k])}else{k=l(a);var d=this;if(k.hasClass(this.selectedCS)){this.selectedItem&&this.unselect();this.selectedItem=a}if(e)a.contentEl=e;if(this.trigMode==="hover"||this.autoRecover)k.hover(function(){d.autoRecover&&d.mouseoutTimer&&d.clearTimeout(1);
if(d.trigMode==="hover")if(this!==d.selectedItem)if(d.delaySelect){d.mouseoverTimer&&d.clearTimeout(0);d.mouseoverTimer=setTimeout(function(){d.select(a)},d.delaySelect)}else d.select(this);return!d.enableBubble},function(j){d.mouseoverTimer&&d.clearTimeout(0);if(d.trigMode==="hover"){if(this!==d.selectedItem&&d.mouseoutTimerFn){d.mouseoutTimerFn();d.mouseoutTimerFn=NULL}j=j.target;if(d.autoRecover&&(j===this||u.ancestorOf(this,j)))if(!d.mouseoutTimer){var p=this;d.mouseoutTimerFn=function(){d.unselect(p)};
d.mouseoutTimer=setTimeout(d.mouseoutTimerFn,d.delayHide||500)}}return!d.enableBubble});if(this.trigMode==="click")k.bind(this.clickEvent||"mousedown",function(){d.select(this);return false})}}};g.Box=q.reg("Box",u.create(g.Layer,{view:"Box"}));g.Tip=q.reg("Tip",u.create(g.Box,{cs:"win-fixed",autoHide:true,timeoutHide:1E3,timeoutShow:200,stayHover:false,offX:25,offY:-10,innerViewReady:function(){var a=this.jq();this.stayHover&&a.hover(u.bind(this.onMouseover,this),u.bind(this.onMouseout,this))},onMouseover:function(){this.clearHideTimer()},
onMouseout:function(){this.setHideTimer()},clearHideTimer:function(){if(this.hideTimerId){clearTimeout(this.hideTimerId);this.hideTimerId=false}},beforeShow:function(){if(c.prototype.beforeShow.apply(this,arguments)===false)return false;this.autoHide&&this.setHideTimer()},setShowTimer:function(a){if(a)this.showTimerId=setTimeout(u.getBind(this,"onTimerShow"),this.timeoutShow);else if(this.showTimerId){clearTimeout(this.showTimerId);this.showTimerId=false}},setHideTimer:function(){this.clearHideTimer();
this.hideTimerId=setTimeout(u.getBind(this,"onTimerHide"),this.timeoutHide)},onTimerHide:function(){this.display(false);this.clearHideTimer()},onTimerShow:function(){this.display(true);this.setShowTimer(false)}}))})(Xwb,$);(function(q,l){var u=q.util,t=document,o=q.ax.Tpl,m=q.ui,g=q.lang.getText;m.Dialog=q.reg("Dlg",u.create(m.Box,function(h){return{cs:"win-tips win-fixed",contentHtml:"DialogContent",focusBtnCs:"btn-s1-light",mask:true,closeable:true,initUI:function(){if(this.buttons&&!this.buttonHtml){for(var i=[],b=0,c=this.buttons,a=c.length;b<a;b++)i.push(o.parse(this.buttonTpl||"Button",c[b]));this.buttonHtml=i.join("")}h.initUI.call(this)},onClsBtnClick:function(){this.onbuttonclick("cancel")!==false&&this.close();
return false},setFocus:function(i){if(i||this.defBtn)this.jq("#xwb_btn_"+(i||this.defBtn)).focus().addClass(this.focusBtnCs)},afterShow:function(){h.afterShow.call(this);this.defBtn&&this.setFocus()},onbuttonclick:function(i){__debug&&console.log(i+" clicked")},setHandler:function(i){this.onbuttonclick=i;return this},getButton:function(i){return this.jq("#xwb_btn_"+i)},innerViewReady:function(i){h.innerViewReady.call(this,i);var b=this;l(i).find("#xwb_dlg_btns").click(function(c){if(c=u.domUp(c.target,
function(e){return e.id&&e.id.indexOf("xwb_btn_")===0},this)){var a=c.id.substr(8);b.buttons&&l.each(b.buttons,function(){if(this.id===a){var e;if(this.onclick)e=this.onclick(b);if(e!==false&&b["on"+a])e=b["on"+a]();e!==false&&b.onbuttonclick(a)!==false&&b.close()}});return false}})}}}));m.MsgBox=q.reg("msgbox",{getSysBox:function(){var h=this.sysBox;if(!h)h=this.sysBox=q.use("Dlg",{appendTo:t.body,title:g("提示"),dlgContentHtml:"MsgDlgContent",mask:true,buttons:[{title:g("确&nbsp;定"),id:"ok"},{title:g("取&nbsp;消"),
id:"cancel"},{title:g("&nbsp;是&nbsp;"),id:"yes"},{title:g("&nbsp;否&nbsp;"),id:"no"},{title:g("关&nbsp;闭"),id:"close"}],setContent:function(i){this.jq("#xwb_msgdlg_ct").html(i)},setIcon:function(i){var b=h.jq("#xwb_msgdlg_icon");b.attr("className",b.attr("className").replace(/icon\-\S+/i,"icon-"+i))},afterHide:function(){m.Dialog.prototype.afterHide.call(this);this.onbuttonclick=m.Dialog.prototype.onbuttonclick}});return h},getTipBox:function(){var h=this.tipBox;if(!h)h=this.tipBox=q.use("Tip",{cs:"win-tips win-fixed",
contentHtml:"DialogContent",appendTo:t.body,title:"提示",timeoutHide:1200,dlgContentHtml:"MsgDlgContent",setContent:function(i){this.jq("#xwb_msgdlg_ct").html(i)},setIcon:function(i){var b=h.jq("#xwb_msgdlg_icon");b.attr("className",b.attr("className").replace(/icon\-\S+/i,"icon-"+i))},afterHide:function(){m.Tip.prototype.afterHide.call(this);if(this.onhide){this.onhide();this.onhide=false}}});return h},getAnchorDlg:function(){var h=this._anchorDlg;if(!h)h=this._anchorDlg=q.use("Dlg",{cs:"win-tips-ask",
mask:false,dlgContentHtml:"AnchorDlgContent",appendTo:t.body,defBtn:"ok",buttons:[{title:g("确&nbsp;定"),id:"ok"},{title:g("取&nbsp;消"),id:"cancel"}],setAnchor:function(i){this.anchorEl=i;return this},beforeShow:function(){m.Dialog.prototype.beforeShow.call(this);if(this.anchorEl){this.anchor(this.anchorEl,"tc",function(b){b[1]-=2});var i=this;this.slide("bc",true,function(){m.Dialog.prototype.afterShow.call(i)})}},afterShow:l.noop,beforeHide:function(){if(this.anchorEl){this.slide("cb",false);delete this.anchorEl;
return false}else m.Dialog.prototype.beforeHide.call(this)},afterHide:function(){m.Dialog.prototype.afterHide.call(this);this.onbuttonclick=m.Dialog.prototype.onbuttonclick}});return h},getAnchorTip:function(){var h=this._anchorTip;if(!h)h=this._anchorTip=q.use("Tip",{view:"Box",cs:"operate-success",contentHtml:"AnchorTipContent",appendTo:t.body,timeoutHide:1800,setAnchor:function(i){this.anchorEl=i;return this},beforeShow:function(){if(this.anchorEl){this.anchor(this.anchorEl,"tc",function(i){i[1]-=
8});this.slide("bc",true)}m.Tip.prototype.beforeShow.call(this)},beforeHide:function(){if(this.anchorEl){this.slide("cb",false);delete this.anchorEl;return false}else m.Tip.prototype.beforeHide.call(this)},afterHide:function(){m.Tip.prototype.afterHide.call(this);if(this.onhide){this.onhide();this.onhide=false}}});return h},tipError:function(h,i){this.tip(h,"error",i)},tipOk:function(h,i){this.tip(h,"success",i)},tipWarn:function(h,i){this.tip(h,"alert",i)},anchorTipOk:function(h,i,b){this.anchorTip(h,
i,"",b)},anchorConfirm:function(h,i,b){this.getAnchorDlg().setTitle(i).setHandler(b||l.noop).setAnchor(h).display(true)},tip:function(h,i,b){var c=this.getTipBox();c.setIcon(i||"alert");c.setContent(h||"");c.display(true);b&&(c.onhide=b)},anchorTip:function(h,i,b,c){b=this.getAnchorTip();b.setTitle(i).setAnchor(h).display(true);c&&(b.onhide=c)},alert:function(h,i,b,c,a,e){var k=this.getSysBox(),s=k.buttons;c||(e=c="ok");a||(a="alert");for(var d=0,j=s.length;d<j;d++)k.jq("#xwb_btn_"+s[d].id).cssDisplay(c.indexOf(s[d].id)>=
0);k.defBtn=e;h&&k.setTitle(h);i&&k.setContent(i);a&&k.setIcon(a);b&&(k.onbuttonclick=b);k.display(true);return k},confirm:function(h,i,b,c){this.alert(h||g("提示"),i,b,"ok|cancel","ask",c||"ok")},success:function(h,i,b,c,a){this.alert(h,i,b,c||"ok","success",a||"ok")},error:function(h,i,b,c,a){this.alert(h,i,b,c||"ok","error",a||"ok")}})})(Xwb,$);(function(q){q.ax.Eventable.apply(q);q.ax.PipeMgr={pages:{},instances:{},reg:function(u,t,o){if(!o&&this.pages[u])throw"Object existed exception.["+u+"]";this.pages[u]=t;return this},start:function(u){q.cfg=u;q.fireOnce("pipe.start",u,this)},load:function(u){q.fire("page.before",u,this);var t=this.pages[u.pagelet]||this.pages[u.data&&u.data.cls];t||(t=l);t=typeof t==="function"?new t:new (t.pipe||l)(t);this.instances[u.id]=t;t.load(u);q.fire("page.after",t,this)},end:function(){q.fireOnce("pipe.end",
this)},getPage:function(u){return this.instances[u]}};q.reg("pipeMgr",Xwb.ax.PipeMgr);var l=q.ax.Pagelet=q.util.create();l.prototype={htmlMode:1,init:function(u){u&&$.extend(this,u)},load:function(u){this.id=u.id;this.type=u.pagelet;if(u.data&&u.data.cls)this.cls=u.data&&u.data.cls;if(u.perch){this.applyHtml(this.createContent(u));this.ui&&this.getUI();this.onViewReady(u)}},createContent:function(u){return u.html||""},applyHtml:function(u){var t=this._getPlaceholder();if(this.htmlMode===1){u=$(u);
if(u.length>1){var o=q.ax.Cache.get("div");u.appendTo(o);u=$(o)}$(t).replaceWith(u);this.contentView=u[0]}else if(this.htmlMode===2){$(t).html(u).cssDisplay(true);this.contentView=t}},getUI:function(){var u=this.ui;if(!u||!u.cacheId){this.ui=u=new (u?u.cls||q.ui.Base:q.ui.Base)($.extend({view:this.contentView},u));u.getView()}return u},jq:function(){var u=this.getUI();return u.jq.apply(u,arguments)},_getPlaceholder:function(){return document.getElementById(this.id)},onViewReady:$.noop};if(__debug)l.prototype.toString=
function(){return"#"+this.id+"["+this.type+"]"}})(Xwb);(function(q,l){var u=q.ui,t=q.util,o=document,m=u.Base,g=q.ax.Tpl,h=q.request,i=q.use("msgbox"),b=q.getCfg,c=q.getUid,a=q.getWb,e=q.setWb,k=q.lang.getText;if(!q.mod)q.mod={};var s=q.mod;q.reg("emotion",function(){var d=q.use("Box",{contentHtml:"Loading",boxOutterHtml:"ArrowBoxBottom",cs:"win-emotion",appendTo:o.body,closeable:true,actName:"em",contextable:true,actionMgr:true,emotions:null,$categorySelected:null,$categoryShowed:null,cateMaps:{},onactiontrig:function(j){switch(j.data.e){case "em":if(this.onselect)if(this.onselect(this.findEmotionText(j),
j)===false)break;this.display(false);break;case "sc":this.emSwitch(j.data.idx,j.src)}},setHandler:function(j){this.onselect=j;return this},setSelectionHolder:function(j,p,r){this.setHandler(function(w){j.insertText(w);p&&p.call(r||this,j,w)});return this},showAt:function(j){j=l(j).offset();j.left-=24;j.top+=20;this.offset(j).display(true)},initEmotion:function(j){if(j.isOk()){j=j.getData();var p={},r=[],w=[],x=0,y={};l.each(j,function(C,A){if(A.type=="face"){var D=A.category?A.category:"默认";if(p[D])p[D].push(A);
else{p[D]=[A];y[x]=p[D];w.push(['<a href="#" rel="e:sc,idx:',x,'">',D,"</a>"].join(""));x++}A.is_hot&&r.push(['<a href="#" rel="e:em" title="',A.phrase,'"><img width="22px" height="22px" src="',A.url,'" /></a>'].join(""))}});var z=[],B=0;l.each(p["默认"],function(C,A){A.is_hot&&B++;if(!A.is_hot||B>15)z.push(['<a href="#" rel="e:em" title="',A.phrase,'"><img width="22px" height="22px" src="',A.url,'" /></a>'].join(""))});if(r.length>15)r=r.slice(0,15);j={category:w.join(""),faces:z.join(""),hotList:r.join("")};
j=l(g.parse("EmotionBoxContent",j));this.jq("#xweibo_loading").hide();this.jq("#xwb_dlg_ct").append(j);this.$categorySelected=this.jq("#cate>a:first").addClass("current");this.$categoryShowed=this.jq("#flist0");this.emotions=p;this.cateMaps=y}},createEmArea:function(j){var p=['<div class="e-list" id="flist'+j+'">'];l.each(this.cateMaps[j],function(r,w){p.push(['<a href="#" rel="e:em" title="',w.phrase,'"><img width="22px" height="22px" src="',w.url,'" /></a>'].join(""))});p.push("</div>");return l(p.join(""))},
emSwitch:function(j,p){var r=l(p);if(!r.hasClass("current")){this.$categorySelected.removeClass("current");this.$categorySelected=r.addClass("current");this.$categoryShowed.addClass("hidden");j>0?this.jq("#hotEm").addClass("hidden"):this.jq("#hotEm").removeClass("hidden");r=this.jq("#flist"+j);r.length||(r=this.createEmArea(j).appendTo(this.jq("#box")));this.$categoryShowed=r.removeClass("hidden")}},loadEmotion:function(){var j=this;h.getEmotion(function(p){j.initEmotion(p)})},onViewReady:function(){this.loadEmotion()},
findEmotionText:function(j){return j.src.title}});q.reg("emotion",d,true);return d});q.reg("forwardBox",function(){var d=q.use("Dlg",{cs:"win-forward",appendTo:o.body,autoCenter:true,dlgContentHtml:"ForwardDlgContentHtml",title:k("转发到我的微博"),defBtn:"forward",buttons:[{title:k("转 发"),id:"forward"},{title:k("取 消"),id:"cancel"}],checkText:function(){var j=l.trim(this.jqInputor.val()),p=t.calWbText(j);p>=0?this.jqWarn.html(k("您还可以输入{0}字",p)):this.jqWarn.html(k("已超出{0}字",Math.abs(p)));this.jqWarn.checkClass("out140",
p<0);return p>=0&&j},onViewReady:function(){this.jq("#xwb_face_trig").click(t.bind(this.onFaceTrig,this));this.jqInputor=this.jq("#xwb_fw_input");this.jqWarn=this.jq("#xwb_warn_tip");this.jqContent=this.jq("#xwb_forward_text");this.jqLabelCt=this.jq("#xwb_fw_lbl");this.jqInputor.bind("keyup",t.bind(this.onInputorKeyup,this));this.selectionHolder=q.use("SelectionHolder",{elem:this.jqInputor[0]});this.atWho=q.use("atWho",{appendTo:o.body,Inputor:this.jqInputor,autoRender:true})},onInputorKeyup:function(j){if(this.checkText())if(j.ctrlKey&&
(j.which==13||j.which==10))this.submit()},onFaceTrig:function(j){q.use("emotion").setSelectionHolder(this.selectionHolder,this.checkText,this).showAt(j.target);return false},setContent:function(j,p,r){this._predCfg={id:j,data:p,uid:r};this.jq();var w=[];r!==p.u.id&&w.push(g.parse("ForwardDlgLabel",{uid:j,nick:p.u.sn}));if(r=p.rt){j=r.tx;p="//@"+p.u.sn+":"+p.tx;w.push(g.parse("ForwardDlgLabel",{uid:r.id,nick:r.u.sn}))}else{j=p.tx;p=""}this.jqContent.text(t.escapeHtml(j));this.selectionHolder.setText(p);
this.checkText();this.jqLabelCt.html(w.join(""));return this},submit:function(){if(this.isLoading)return false;this.isLoading=true;var j=this.checkText();if(j==="")j=k("转发微博");else if(!j){this.jqInputor.focus();return this.isLoading=false}var p=[];this.jq('input[type="checkbox"]:checked').each(function(){p[p.length]=l(this).val()});var r=this._predCfg,w=l.extend({_route:q.getModule()},this.getParam());t.disable(this.getButton("forward"),true);h.repost(r.id,j,p.join(","),t.getBind(this,"onSubmitLoad"),
{data:w})},getParam:function(){return{}},onSubmitLoad:function(j){t.disable(this.getButton("forward"),false);this.close();j.isOk()?i.tipOk(k("转发成功")):i.tipWarn(j.getMsg(null,k("微博转发")));this.isLoading=false},onbuttonclick:function(j){if(j==="forward"){this.submit();return false}}});q.reg("forwardBox",d,true);return d});u.getFlash=function(d,j){var p=l.browser.msie;d=d||{};var r='<object width="'+d.width+'" height="'+d.height+(d.id?'" id="'+d.id:"")+(d.name?'" name="'+d.name:"")+'"';if(d.nocache)d.src+=
(d.src.indexOf("?")!=-1?"&":"?")+Math.random();r+=d.w3c||p?' data="'+d.src+'" type="application/x-shockwave-flash"':' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"';r+=">";if(d.w3c||p)r+='<param name="movie" value="'+d.src+'" />';d.width=d.height=d.id=d.w3c=d.src=null;d.onFail=d.version=d.expressInstall=null;for(var w in d)if(d[w])r+='<param name="'+w+'" value="'+d[w]+'" />';p="";if(j){for(var x in j)if(j[x]){w=j[x];p+=x+"="+(/function|object/.test(typeof w)?f.asString(w):w)+"&"}p=p.slice(0,
-1);r+='<param name="flashvars" value=\''+p+"' />"}r+="</object>";return r};u.WbElement=q.reg("WbElement",t.create(m,{state:0,init:function(){m.prototype.init.apply(this,arguments);this.picLoadState=0;this.isFw=this.state?this.$wb.find(".forward").length?1:0:this.wbData.rt?1:0;this.$preview=this.$wb.find("div.preview-img")},playVideo:function(d){d.get("w");d=d.get("i");d=q.mod.shortlink.getUrls()[d];var j=this.$wb.find("div.feed-content").width()-35,p=parseInt(j/1.25);p=u.getFlash({src:d.flash,width:j,
height:p,w3c:1,id:"sinaVideo_"+ +new Date,quality:"high",allowScriptAccess:"always",wmode:"transparent",allowFullscreen:"true",flashvars:"playMovie=true&auto=1"});this.$video&&this.$video.remove();var r;if(this.isFw){j="div.forward>p";r="VideoBoxForward"}else{j="p.feed-main";r="VideoBox"}d=g.parse(r,{href:d.url,title:d.title,flash:p});this.$video=l(d).insertAfter(this.$wb.find(j));this.switchView("video",1)},closeVideo:function(){this.switchView("video",0)},picSrc:function(d){d=d||"bmiddle";if(this.state)d=
"http://ww"+Math.ceil(Math.random()*4)+".sinaimg.cn/"+d+"/"+this.psrc+".jpg";else{var j=this.wbData;d=(this.isFw?j.rt:j)[d=="thumbnail"?"mp":"op"]}return d},loadPic:function(){this.picLoadState=1;var d=this,j={org:this.picSrc("large"),img:this.picSrc("bmiddle")},p=this.$thumbImg=this.$wb.find("img.zoom-move");this.$loadEl=l('<div class="loading-img"></div>').appendTo(p.parent());this.$picBox=l(g.parse(this.isFw?"PictureBoxForward":"PictureBox",j));p=this.img=new Image;l(p).bind("load",function(){d.onPicLoaded()}).addClass("narrow-move").attr("rel",
"e:zo").attr("src",j.img)},onPicLoaded:function(){var d=this.$wb.find(this.isFw?"div.forward":"div.feed-content:first"),j=this.img,p=this.$picBox;d.css("visibility","hidden");var r=this.$wb.find("div.feed-content").width()-35;l(j).appendTo(p.find("div[name=img]"));d.children("div.preview-img").after(p);this.switchView("pic",1);if(j.width>r){if(l.browser.msie)j.height*=r/j.width;j.width=r}d.css("visibility","");this.$loadEl.remove();this.picLoadState=2},zoomIn:function(){if(this.picLoadState==0)this.loadPic();
else this.picLoadState==2&&this.switchView("pic",1)},zoomOut:function(){this.switchView("pic",0)},trun:function(d){l(this.img).imgRotate(d)},switchView:function(d,j){if(j){if(d=="pic"){this.$picBox.show();this.$video&&this.$video.remove();this.$video=null}else if(d=="video"){this.$video.show();this.$picBox&&this.$picBox.hide()}this.$preview.hide()}else{if(d=="pic")this.$picBox&&this.$picBox.hide();else if(d=="video"){this.$video&&this.$video.remove();this.$video=null}this.$preview.show()}}}));s.CmtBox=
q.reg("CmtBox",t.create(m,{actionMgr:true,view:"CmtBox",exceedCS:"over-limit",autoH:true,wbUid:null,headPicType:1,innerViewReady:function(d){this.wbUid=q.getUid();m.prototype.innerViewReady.call(this,d);this.jqExtra("inputor","warn","sync");this.selectionHolder=q.use("SelectionHolder",{elem:this.jqInputor[0]});var j=this;this.jqInputor.bind("keyup",function(p){j.onInputorKeyup(p)});this.atWho=q.use("atWho",{appendTo:o.body,Inputor:this.jqInputor,autoRender:true})},reset:function(){this.getView();
this.selectionHolder.setText("");this.jqSync.attr("checked",false);this.checkText()},checkText:function(){var d=this.jqInputor,j=l.trim(d.val()),p=t.calWbText(j,70),r=this.jqWarn;p>=0?r.html(k("您还可以输入{0}字",p)):r.html(k("已超出{0}字",Math.abs(p)));r.checkClass(this.exceedCS,p<0);this.autoH&&d.height()!==d[0].scrollHeight&&d.height(d[0].scrollHeight);return p>=0&&j},send:function(){if(!this.sending){var d=this.checkText();if(d){this.sndBtn&&t.disable(this.sndBtn,true);this.sending=true;var j=this.jqInputor.data("xwb_reply_cid"),
p=RegExp("^"+k("回复")+"@.*?:");j&&p.test(d)?h.reply(this.wbId,j,d,this.jqSync.attr("checked")?1:0,this.headPicType,t.getBind(this,"onSendLoad"),{data:{_route:q.getModule()}}):h.comment(this.wbId,d,this.jqSync.attr("checked")?1:0,this.headPicType,t.getBind(this,"onSendLoad"),{data:{_route:q.getModule()}})}else setTimeout(t.bind(function(){this.jqInputor.focus()},this),0)}},onSendLoad:function(d){if(d.isOk()){this.pCt.afterSend(d);this.reset();d=d.getData();d.html&&this.pCt.postWeibo(d.wb,d.html)}else{i.tipWarn(d.getMsg(null,
k("评论")));d.getCode()=="30000"&&this.reset()}this.pCt.afterNofocus||this.jqInputor.focus();this.sndBtn&&t.disable(this.sndBtn,false);this.sending=false},reply:function(d,j){var p=this.selectionHolder,r=this.jqInputor,w=RegExp("^"+k("回复")+"@.*?:");this.reset();p.setText(k("回复")+"@"+j+":"+r.val().replace(w,""));r.data("xwb_reply_cid",d);this.checkText();setTimeout(function(){p.focusEnd()},0)},onFaceTrig:function(d){q.use("emotion").setSelectionHolder(this.selectionHolder,this.checkText,this).showAt(d.src);
return false},onInputorKeyup:function(d){if(this.checkText())if(d.ctrlKey&&(d.which==13||d.which==10))this.send()},onactiontrig:function(d){switch(d.data.e){case "ic":this.onFaceTrig(d);break;case "sd":if(!this.sndBtn)this.sndBtn=d.src;this.send()}}}));s.CommentArea=q.reg("CmtArea",t.create(m,{view:"CommentArea",readSize:10,cmtType:1,hdPicSz:30,cmtCount:0,page:1,cmtPageSz:20,cmtBoxHtml:"CmtBox",commentHtml:"Comment",actionMgr:true,cmtBox:"CmtBox",initUI:function(){this.cmtUrl=h.mkUrl("show","","id="+
this.wbId);this.jqExtra("pre","first","next");m.prototype.initUI.call(this)},getFromUser:function(){if(!this.wbUid){var d=a(this.wbId);this.wbUid=d&&d.u.id}return this.wbUid},innerViewReady:function(d){m.prototype.innerViewReady.call(this,d);this.jqExtra("cmtCt","more","lefCnt");this.initCmtBox()},decorateLoading:function(){this.isLoading?l(g.get("Loading")).appendTo(this.getView().parentNode):l(this.getView().parentNode).find("#xweibo_loading").remove();this.display(!this.isLoading)},initCmtBox:function(){this.cmtBox=
q.use("CmtBox",{view:this.jq("#cmtBox")[0],wbId:this.wbId,pCt:this,headPicType:this.hdPicSz==30?1:2});this.cmtBox.getView()},load:function(d){this.getView();if(!this.isLoading){this.isLoading=true;this.decorateLoading();d&&(this.onload=d);h.getComments(this.wbId,this.page,this.cmtType,t.getBind(this,"onCmtsLoad"))}},postWeibo:function(){},afterSend:function(d){d=l(this.createCmtUI(d.getData().comment));this.jqCmtCt.prepend(d);this.jqCmtCt.cssDisplay(true);this.updateCmtCountUI(1,true);q.mod.shortlink.render(d,
function(j,p){p.title=j&&j.url||k("无效链接")})},onCmtsLoad:function(d){if(d.isOk()){this.createListUI(d);var j=d.getData().total;j&&this.updateCmtCountUI(j);this.updateCmtPageUI(d.getData())}this.isLoading=false;this.decorateLoading();this.onload&&this.onload(d)},createListUI:function(d){this.jqCmtCt.empty();var j=d.getData();j=j.total-Math.min(j.limit,j.total);var p=[];d.each(function(r){p[p.length]=this.createCmtUI(r)},this);if(p.length){this.jqCmtCt.html(p.join(""));if(j){this.jqMore.cssDisplay(true);
this.jqLefCnt.text(j)}else this.jqMore.cssDisplay(false);this.jqCmtCt.cssDisplay(true)}else{this.jqCmtCt.cssDisplay(false);this.jqMore.cssDisplay(false)}q.mod.shortlink.render(this.jqCmtCt,function(r,w){w.title=r&&r.url||k("无效链接")})},createCmtUI:function(d){var j=this.getFromUser(),p=c();d.verifiedHtml=d.user.verified_html;d.usrUrl=d.user.profileUrl;d.picSz=this.hdPicSz;d.time=d.create_at;if(j===p||d.uid===p)d.canDel=true;return g.parse(this.commentHtml,d)},updateCmtPageUI:function(d){if(this.jqPre.length){this.jqPre.cssDisplay(this.page!==
1);this.jqFirst.cssDisplay(this.page>=3);this.jqNext.cssDisplay(d.total!=0)}},updateCmtCountUI:function(d,j){if(this.trigEl){var p=k("评论");if(j===void 0){l(this.trigEl).text(p+"("+d+")");this.cmtCount=d}else{this.cmtCount+=d;l(this.trigEl).text(p+"("+this.cmtCount+")")}}},onactiontrig:function(d){switch(d.data.e){case "rp":this.onReplyTrig(d);break;case "dl":this.onDelTrig(d);break;case "nx":this.goPage(this.page+1);break;case "pr":this.goPage(this.page-1);break;case "fi":this.goPage(1)}},onDelTrig:function(d){var j=
this;i.anchorConfirm(d.src,k("确定要删除该评论吗？"),function(p){if(p==="ok"&&!j.deletingCmt){j.deletingCmt=true;h.delComment(d.get("c"),function(r){var w=d.getEl("c");if(r.isOk()){l(w).remove();j.updateCmtCountUI(-1,true);j.cmtCount==0&&j.cmtBox.jqInputor.focus()}else i.tipError(r.getMsg());j.deletingCmt=false})}})},onReplyTrig:function(d){var j=this.jq();this.offsetsTo(window)[1]<0&&j[0].scrollIntoView&&j[0].scrollIntoView();j=d.get("c");d=d.get("n");this.cmtBox.reply(j,d)},goPage:function(d){this.topCmtBox.getView().scrollIntoView&&
this.topCmtBox.getView().scrollIntoView();this.page=d;this.load()}}));s.MBlogCmtArea=q.reg("MBlogCmtArea",t.create(s.CommentArea,{commentHtml:"MBlogCmt",cmtType:2,hdPicSz:50,createListUI:function(d){this.jqCmtCt.empty();d.getData();var j=[],p=this.faceSize;d.each(function(r){if(p)r.profileImg=r.profileImg.replace("/30/","/"+p+"/");j[j.length]=this.createCmtUI(r)},this);if(this.cmtCount=j.length){this.jqCmtCt.html(j.join(""));this.jqCmtCt.cssDisplay(true)}else{this.jqCmtCt.cssDisplay(false);this.jqMore.cssDisplay(false)}q.mod.shortlink.render(this.jqCmtCt,
function(r,w){w.title=r&&r.url||k("无效链接")})},initCmtBox:function(){this.cmtBox=q.use("CmtBox",{wbId:this.wbId,pCt:this,view:"MBCmtBox",headPicType:this.hdPicSz==30?1:2});this.cmtBox.getView();this.topCmtBox=q.use("CmtBox",{wbId:this.wbId,pCt:this,autoH:false,view:this.topCmtBox,headPicType:this.hdPicSz==30?1:2});this.topCmtBox.getView()},updateCmtCountUI:l.noop,onReplyTrig:function(d){this.cmtBox.jq().insertAfter(d.jq("c").find("#trigs"));var j=d.get("c");d=d.get("n");this.cmtBox.display(true).reply(j,
d)},postWeibo:l.noop,afterSend:function(d){d=l(this.createCmtUI(d.getData().comment));this.jqCmtCt.prepend(d).cssDisplay(true);this.cmtBox.display(false);this.topCmtBox.jqInputor.focus();q.mod.shortlink.render(d,function(j,p){p.title=j&&j.url||k("无效链接")})},onload:function(){this.jq("#pager").cssDisplay(true);this.topCmtBox.jqInputor.focus()}}));q.reg("videoBox",function(){var d=q.use("Box",{cs:" win-insert",contentHtml:"MediaBoxContentHtml",boxOutterHtml:"ArrowBoxBottom",appendTo:o.body,actionMgr:true,
closeable:true,contextable:true,onViewReady:function(){this.jqInputor=this.jq("#xwb_inputor");this.jqTip=this.jq("#xwb_err_tip");this.selectionHolder=q.use("SelectionHolder",{elem:this.jqInputor[0]})},onactiontrig:function(j){switch(j.data.e){case "ok":if(j=this.checkText()){this.onselect&&this.onselect(j);this.close()}else this.jqInputor.focus();break;case "cc":this.close();break;case "nm":this.onselect&&this.onselect(l.trim(this.jqInputor.val()));this.close()}},checkText:function(){var j=this.jqInputor,
p=this.selectionHolder,r=l.trim(j.val());if(r==""||r=="http://"){setTimeout(function(){j.focus();p.setText("http://");j.select()});return false}else if(!this.checkUrl(r)){this.jqTip.cssDisplay(true);return false}return r},checkUrl:function(j){return j.indexOf("http://")===0},showAt:function(j,p){this.onselect=p;var r=l(j).offset();r.left-=140;r.top+=20;this.offset(r).display(true);var w=this;setTimeout(function(){w.selectionHolder.setText("http://");w.jqInputor.focus();w.jqInputor[0].select()},0);
this.jqTip.cssDisplay(false)}});q.reg("videoBox",d,true);return d});q.reg("musicBox",function(){var d=q.use("Box",{cs:" win-insert",contentHtml:"MusicBoxContentHtml",boxOutterHtml:"ArrowBoxBottom",appendTo:o.body,closeable:true,actionMgr:true,contextable:true,onViewReady:function(){this.jqInputor=this.jq("#xwb_inputor");this.jqTip=this.jq("#xwb_err_tip");this.selectionHolder=q.use("SelectionHolder",{elem:this.jqInputor[0]})},checkText:function(){var j=this.jqInputor,p=l.trim(j.val()),r=this.selectionHolder;
if(p==""||p=="http://"){setTimeout(function(){j.focus();r.setText("http://");j[0].select()});return false}else if(!this.checkUrl(p)){this.jqTip.cssDisplay(true);return false}return p},checkUrl:function(j){return j.indexOf("http://")===0},onactiontrig:function(j){switch(j.data.e){case "ok":if(j=this.checkText()){this.onselect&&this.onselect(j);this.close()}else this.jqInputor.focus();break;case "cc":this.onselect&&this.onselect();this.close();break;case "nm":this.onselect&&this.onselect(l.trim(this.jqInputor.val()));
this.close()}},showAt:function(j,p){this.onselect=p;var r=l(j).offset();r.left-=140;r.top+=20;this.offset(r).display(true);var w=this;setTimeout(function(){w.selectionHolder.setText("http://");w.jqInputor.focus();w.jqInputor[0].select()},0);this.jqTip.cssDisplay(false)}});q.reg("musicBox",d,true);return d});s.atWho=q.reg("atWho",t.create(u.Layer,{view:"atwho",now:0,length:0,key:"",atWhoShow:0,oldXhr:null,flagAt:null,useable:1,run:function(d){if(d===void 0)return this.useable;this.useable=d},onViewReady:function(){var d=
this;this.Inputor.bind("keyup",function(j){d.showWho(j)}).bind("keydown",function(j){return d.onkeydown(j)}).bind("focus",function(j){d.showWho(j)}).bind("click",function(j){d.showWho(j)}).bind("blur",function(){if(d.atWhoShow)this.TimeoutID=setTimeout(function(){d.display(false);d.atWhoShow=false},150)});this.jq("#mainUL").click(function(j){j.target.tagName=="LI"&&d.choose()});this.jq("#mainUL").mousemove(function(j){if(j.target.tagName=="LI"){l(this).find("li:eq("+d.now+")").removeClass("cur");
l(j.target).addClass("cur");d.now=l(this).find("li").index(j.target)}})},showWho:function(){if(this.run()){var d=this.getKey(this.Inputor[0]);__debug&&console.log(d);if(this.txtobj=d)d.text!=this.key&&this.reload(d.text);else{this.key="";this.length=0;this.display(false)}}},onkeydown:function(d){if(this.atWhoShow)switch(d.keyCode){case 38:if(this.now==0)return false;this.jq("#mainUL li:eq("+this.now+")").removeClass("cur").prev().addClass("cur");this.now--;return false;case 40:if(this.now+1==this.length)return false;
this.jq("#mainUL li:eq("+this.now+")").removeClass("cur").next().addClass("cur");this.now++;return false;case 13:if(this.length!=0){this.choose();this.display(false)}return false;default:return true}},choose:function(d){var j=this.Inputor,p=j.data("xwb_selholder");d=d||this.now;var r=this.cache(this.key);if(r&&r.length){d=this.format(r[d]);r=this.txtobj;this.run(0);if(p)p.replaceString(d,r.form,r.to);else{this.Inputor.val(t.stringReplace(j.val(),d,r.form,r.to));t.setCursor(j[0],r.form+d.length)}this.afterChoose();
this.run(1)}},afterChoose:l.noop,format:function(d){return d.nickname+" "},getKey:function(d,j){var p=t.getCursorPos(d);j=d.value;var r=j.substring(p-1,p),w="";if(this.noAt===true)if(j.length!==0){this.flagAt=0;return{text:j,form:0,to:j.length}}else return false;if(r==" "||r=="@")return false;for(r=p;r>0;r--){if(j.substring(r,r-1)==" ")break;if(j.substring(r,r-1)=="@"){w=j.substring(r,p);if(j.length>p)for(var x=p+1;x<=j.length;x++)if(j.substring(x,x-1)==" "||x==j.length){var y=j.substring(r,j.substring(x,
x-1)==" "?x-1:x);l(this.data).each(function(){if(y==this.nickname)p=x})}this.flagAt=r;if(w.length>20)break;return{text:w,form:r,to:p}}}return false},rePosition:function(){var d=t.getCursorOffset(this.Inputor,this.flagAt-1);if(d){var j=this.Inputor.offset(),p=this.Inputor.scrollTop(),r=parseInt(l(this.Inputor).css("lineHeight"));if(isNaN(r))r=20;p=r-p;this.jq().css({top:j.top+d.top+p,left:j.left+d.left})}return this},onResize:l.noop,beforeShow:function(){this.rePosition();u.Layer.prototype.beforeShow.apply(this,
arguments)},afterShow:function(){__debug&&console.log("atWho: listen resize event.");this.onResize=t.bind(this.rePosition,this);l(window).resize(this.onResize);u.Layer.prototype.beforeShow.apply(this,arguments);this.atWhoShow=1},afterHide:function(){__debug&&console.log("atWho: unlisten resize event.");l(window).unbind("resize",this.onResize);this.atWhoShow=0;u.Layer.prototype.afterHide.apply(this,arguments)},highlight:function(d,j){return d.replace(j,"<b>"+j+"</b>")},showUser:function(d){this.length=
d.length;this.data=d;if(!d||!d.length)return this.display(0);var j=[],p=this.highlight,r=this;l.each(d,function(w,x){var y=x.remark,z="<li>"+p(x.nickname,r.key);if(y)z=z+"("+p(y,r.key)+")";z+="</li>";j.push(z)});this.now=0;this.jq("#mainUL").html(j.join("")).find(":first-child").addClass("cur");this.display()&&this.rePosition();this.display(1)},loaded:function(d){if(d.isOk()){d=d.getData();this.cache(d.key,d.data);this.showUser(d.data)}},reload:function(d){this.key=d;var j=this.cache(this.key);__debug&&
console.log("seach:",d,"return:",j,"cache:",s.atWho.cache);if(j!==void 0)this.showUser(j);else{if(this.oldXhr&&(this.oldXhr.readyState!==4||this.oldXhr.status!==200))this.oldXhr.abort();this.oldXhr=h.q(h.apiUrl("action","getAtUsers"),{keyword:this.key},t.getBind(this,"loaded"))}},cache:function(d,j){if(j===void 0)return s.atWho.cache[d];s.atWho.cache[d]=j}}));s.atWho.cache={};s.PostBase={actionMgr:true,defText:"",initEx:function(){var d=this.jqInputor=this.jq("#xwb_inputor"),j=this.jqSendBtn=this.jq("#xwb_send_btn"),
p=this.jq(this.focusEl||"#focusEl");this.jqWarn=this.jq("#xwb_word_cal");this.jqImgFile=this.jq("#xwb_img_file");this.jqBtnImg=this.jq("#xwb_btn_img");this.jqUploadTip=this.jq("#xwb_upload_tip");this.jqPhotoName=this.jq("#xwb_photo_name");this.jqForm=this.jq("#xwb_post_form");this.$uploadBtn=this.jq("#uploadBtn");this.selectionHolder=q.use("SelectionHolder",{elem:this.jqInputor[0]});var r=this;this.jqImgFile.change(function(w){r.onImgFileChange(w)});this.btnHoverCS&&j.hover(function(){j.addClass(r.btnHoverCS)},
function(){j.removeClass(r.btnHoverCS)});this.atWho=q.use("atWho",{appendTo:o.body,Inputor:d,autoRender:true});d.bind("keyup",function(w){r.onInputorKeyup(w)}).bind("focus",function(){p.addClass("post-focus")}).bind("blur",function(){p.removeClass("post-focus")})},getUploader:function(){if(!this.uploader)this.uploader=q.use("Uploader",{form:this.jqForm[0],action:h.mkUrl("api/weibo/action","upload_pic"),onload:t.getBind(this,"onUploadLoad")});return this.uploader},reset:function(){this.jqUploadTip.cssDisplay(false);
this.jqPhotoName.cssDisplay(false);this.$uploadBtn.cssDisplay(1);this.selectionHolder.setText(this.defText);this.jqForm[0].reset();this.uploadPic=false;this.checkText();this.sending=false;return this},onactiontrig:function(d){switch(d.data.e){case "sd":this.post();break;case "ic":q.use("emotion").setSelectionHolder(this.selectionHolder,this.checkText,this).showAt(d.src);break;case "vd":q.use("videoBox").showAt(d.src,t.getBind(this,"onBoxTextReturn"));break;case "ms":q.use("musicBox").showAt(d.src,
t.getBind(this,"onBoxTextReturn"));break;case "tp":this.insertTopic();break;case "dlp":this.uploadPic=false;this.$uploadBtn.cssDisplay(1);this.jqPhotoName.cssDisplay(false);this.jqInputor.focus()}},onBoxTextReturn:function(d){d&&this.selectionHolder.insertText(d);this.checkText()},checkText:function(){var d=l.trim(this.jqInputor.val()),j=t.calWbText(d);j>=0?this.jqWarn.html(k("您还可以输入{0}字","<span>"+j+"</span>")):this.jqWarn.html(k("已超出{0}字","<span>"+-j+"</span>"));this.jqWarn.checkClass("out140",j<
0);return j>=0&&d},checkImg:function(d){d=d.split(".");return d.length&&l.inArray(d.pop().toLowerCase(),["jpg","png","gif","jpeg"])!==-1},onInputorKeyup:function(d){if(this.checkText())if(d.ctrlKey&&(d.which==13||d.which==10))this.post()},TOPIC_TIP:k("请在这里输入自定义话题"),insertTopic:function(d){if(!d)d=this.TOPIC_TIP;var j=this.jqInputor[0],p=RegExp("#"+this.TOPIC_TIP+"#").test(j.value),r=d,w=0,x=0;j.focus();if(document.selection){var y=document.selection.createRange();r=y.text||d;if(r==d&&p){w=RegExp.leftContext.length+
1;x=d.length}else if(r==d){y.text="#"+d+"#";w=j.value.indexOf("#"+d+"#")+1;x=d.length}else y.text="#"+r+"#";if(r==d){y=j.createTextRange();y.collapse();y.moveStart("character",w);y.moveEnd("character",x)}y.select()}else if(j.selectionStart||j.selectionStart=="0"){w=j.selectionStart;x=j.selectionEnd;if(w!=x)r=j.value.substring(w,x);if(p&&r==d){w=RegExp.leftContext.length+1;x=w+r.length}else if(r==d){j.value=j.value.substring(0,w)+"#"+r+"#"+j.value.substring(x,j.value.length);w++;x=w+r.length}else{j.value=
j.value.substring(0,w)+"#"+r+"#"+j.value.substring(x,j.value.length);x=w=w+r.length+2}j.selectionStart=w;j.selectionEnd=x}else j.value+="#"+r+"#";this.checkText();this.selectionHolder.saveSpot()},post:function(){var d=this.checkText();if(d)if(this.getUploader().isLoading())i.tipWarn(k("图片正在上传，请稍候.."));else if(this.sending)i.tipWarn(k("正在发布,请稍候.."));else{var j=l.extend({},this.getParam());if(this.beforeSend){var p=this.beforeSend(d,this.uploadPic,j);if(p===false)return;d=p||d}this.sending=true;h.post(d,
t.getBind(this,"onSendLoad"),this.uploadPic,{data:j})}else this.jqInputor.focus()},getParam:function(){var d=this.param;if(!d)d=this.param={};if(!d._route)d._route=q.getModule();return d},onImgFileChange:function(){var d=this.jqImgFile.val(),j=this;this.uploadPic=null;if(!d||!this.checkImg(d)){this.jqForm[0].reset();i.alert("",k("只支持{0}格式的图片。","jpg、png、gif"),function(){j.jqInputor.focus()})}else{this.jq("#xwb_upload_tip").cssDisplay(true);this.$uploadBtn.cssDisplay(0);this.getUploader().upload()}},
onUploadLoad:function(d){if(typeof d!="object")i.alert("提示","上传失败!");else if(d.isOk()){this.uploadPic=d.getData().msg;this.jqPhotoName.html(t.getFileName(this.jqImgFile.val(),10)+g.get("UploadImgBtn"));this.jqPhotoName.cssDisplay(true);!l.trim(this.jqInputor.val())&&this.selectionHolder.setText(k("分享图片"));this.checkText()}else{i.alert("",d.getMsg(k("图片发布")));this.$uploadBtn.cssDisplay(1)}this.jqUploadTip.cssDisplay(false);this.jqForm[0].reset();this.jqInputor.focus()},onSendLoad:function(d,j){var p=
this.jqInputor;if(d.isOk()||d.getCode()=="30000"){if(!this.jqMask){this.jqMask={succ:this.jq("#xwb_succ_mask"),veri:this.jq("#xwb_veri_mask")};this.jqMaskPt=this.jqMask.succ.parent()}var r=d.isOk()?this.jqMask.succ:this.jqMask.veri;r.cssDisplay(true).show().appendTo(this.jqMaskPt);p.focus();var w=this;w.reset();r.fadeOut(1800,function(){r.remove();r[0].style.filter=null;j&&j.call(w,d)})}else{i.alert("",d.getMsg(),function(){t.focusEnd(p[0])});this.sending=false}}};q.reg("postBox",function(){var d=
l.extend({},s.PostBase);l.extend(d,{title:k("发微博"),closeable:true,autoCenter:true,appendTo:o.body,mask:true,postTitle:"dd",cs:"win-post",contentHtml:"PostBoxContent",onViewReady:function(){this.initEx()},setPostTitle:function(j){this.jq("#postTitle").html(j)},onbuttonclick:function(j){if(j=="ok"){this.post();return false}},onSendLoad:function(j){s.PostBase.onSendLoad.call(this,j,function(p){if(p.isOk()||p.getCode()=="30000"){this.close();this.jqInputor[0].blur()}})}});d=q.use("Box",d);q.reg("postBox",
d,true);return d});s.WeiboList=q.reg("WeiboList",t.create(m,{ctNode:"#xwb_weibo_list_ct",innerViewReady:function(d){m.prototype.innerViewReady.call(this,d);this.jqCt=this.jq(this.ctNode);this.syncList&&q.on("api.update",this.onWbCreate,this)},onWbCreate:function(d){d=d.getData();var j=d.data,p;for(p in j){this.append(p,j[p],d.html);break}},append:function(d,j,p,r){this.item(d,j);r=r||{};if(p){p=l.trim(p);var w=l(p);r.append?w.appendTo(this.jqCt):w.prependTo(this.jqCt);if(r.noSlide){if(!r.cancelParseShortlink){p=
{};p[d]=j;q.mod.shortlink.from(p,function(x){q.mod.shortlink.renderWeiboShortlink(w,x[d],x[d].shortlinks)})}}else w.hide().fadeIn(1E3,function(){if(!r.cancelParseShortlink){var x={};x[d]=j;q.mod.shortlink.from(x,function(y){q.mod.shortlink.renderWeiboShortlink(w,y[d],y[d].shortlinks)})}});return w}},batchAppend:function(d,j,p){var r=[];p={noSlide:true,append:p,cancelParseShortlink:true};for(var w in d)r.push(w,this.append(w,d[w],j[w],p));q.mod.shortlink.from(d,function(x){for(var y=0,z=r.length;y<
z;y+=2){var B=r[y],C=r[y+1];C&&q.mod.shortlink.renderWeiboShortlink(C,x[B],x[B].shortlinks)}})},item:function(d,j){if(j===void 0)return a(d);e(d,j)}}));s.SearchEntry=q.reg("SearchEntry",t.create(m,{focusText:k("搜微博/找人"),focusCs:"search-box-focus",maxLen:30,innerViewReady:function(d){m.prototype.innerViewReady.call(this,d);d=this.jqInputor=this.jq("#xwb_inputor");var j=this;this.jq("#xwb_trig").click(function(){return j.submit()});d.keydown(function(p){p.keyCode===13&&j.submit()});this.focusText&&
d.focusText(this.focusText,this.focusCs,this.getView())},submit:function(){var d=l.trim(this.jqInputor.val());if(d==this.focusText)d="";if(d){d=encodeURIComponent(t.byteCut(d,this.maxLen));d=h.mkUrl("search","","k="+d);window.location.href=d}else this.jqInputor.focus()}}));s.shortlink=new q.ax.Shortlink({renderWeiboShortlink:function(d,j,p){j=d.find("a");var r=this,w,x,y,z=d.find("div.forward"),B=d.find("p.feed-main"),C;j.each(function(){if(w=r.is(this.href)){var A=l(this);if(x=p[w]){y=x[1];if(x=
x[0]){A.attr("title",x.url);switch(x.type){case "music":A.addClass("ico-music-url");break;case "video":A.addClass("ico-video-url");if(y){C=z.find(">div.preview-img");C.length||(C=l(g.parse("PreviewBox")).appendTo(z))}else{C=B.next("div.preview-img");C.length||(C=l(g.parse("PreviewBox")).insertAfter(B))}if(y||!y&&!z.length){A.attr("rel","e:pv,i:"+x.id);l(g.parse("VideoThumbHtml",{img:x.screen,id:x.id})).appendTo(d.find((y?"div.forward ":"")+"div.preview-img"))}}}else A.attr("title",k("无效链接"))}else{__debug&&
console.warn("未解析链接：@"+w+" From "+A.attr("href")+",请在Xwb.ax.Shortlink.from内添加解析区域");A.attr("title",A.attr("href")||"")}}})}});q.reg("myMsg",function(){var d=q.use("Box",function(j){return{contentHtml:"PrivateMsgContent",appendTo:o.body,cs:"win-mes",actionMgr:true,title:k("发私信"),autoCenter:true,closeable:true,mask:true,onViewReady:function(){var p=this;this.jqExtra("word","warn","sender","content","warnPos","uid");this.jqContent.keyup(t.bind(this.checkText,this));this.jqSender.blur(function(){var r=
l.trim(this.value);p.checkFans(r,1,null,true)});this.selectionHolder=q.use("SelectionHolder",{elem:this.jqContent[0]});this.atWho=q.use("atWho",{appendTo:o.body,Inputor:this.jqSender,autoRender:true,format:function(r){return r.nickname},afterChoose:function(){p.jqContent.focus()},noAt:true})},checkText:function(){var p=l.trim(this.jqContent.val()),r=t.calWbText(p,140);this.jqWord.html(r>=0?k("您还可以输入{0}字",r):k("已超出{0}字",Math.abs(r)));return r>=0&&p},afterShow:function(){j.afterShow.call(this);this.jqSender.val()===
""?this.jqSender.focus():this.jqContent.focus()},onactiontrig:function(p){switch(p.data.e){case "sd":this.send();break;case "ic":q.use("emotion").setSelectionHolder(this.selectionHolder,this.checkText,this).showAt(p.src)}},send:function(){if(!this.sending){var p=this.validate(),r=t.getBind(this,"onSendLoad"),w=this.jqSendBtn;p&&this.checkFans(p.u,p.t,function(){t.disable(w,true);h.msg(p.u,p.t,p.c,r)})}},onSendLoad:function(p){if(p.isOk())this.display(false);else{var r;switch(p.getCode()){case 20014:i.alert("",
p.getMsg());break;case 1010005:i.alert(k("内容长度不能超过140个字。"));this.jqContent.focus();break;default:r=p.getMsg(null,"私信")}r&&this.display()&&this.jqWarnPos.cssDisplay(true).text(r)}this.sending=false;t.disable(this.jqSendBtn,false)},checkFans:function(p,r,w,x){var y=this;p?h.followed(p,function(z){if(z.isOk())if(z.getData()){y.jqWarnPos.cssDisplay(false);w&&w.call(this,z)}else{y.jqWarnPos.cssDisplay(true).text(h.ERRORMAP["20016"]);!x&&y.jqSender.focus()}else{y.jqWarnPos.cssDisplay(true).text(z.getMsg());
!x&&y.jqSender.focus()}},r):y.jqWarnPos.cssDisplay(true).text(k("请输入要发送的用户昵称。"))},reset:function(){this.jqSender.attr("disabled",false).val("");this.jqContent.val("");this.jqUid.val("");this.jqWarnPos.cssDisplay(false);this.checkText();return this},validate:function(){var p=l.trim(this.jqSender.val()),r=this.checkText(),w=this.jqUid.val();if(p)if(r){if(w)return{u:w,c:r};return{u:p,c:r,t:1}}else{l.trim(this.jqContent.val()).length?i.tipWarn(k("内容长度不能超过140个字。")):i.tipWarn(k("请输入私信内容。"));this.jqContent.focus()}else this.jqSender.focus()},
reply:function(p,r){this.getView();this.reset();this.display(true);this.jqSender.val(r).attr("disabled",true);this.jqUid.val(p);this.jqContent.focus();this.checkText()}}});q.reg("myMsg",d,true);return d});q.reg("notice",function(d){var j=q.use("Layer",function(p){return l.extend({view:"NoticeLayer2",hidden:true,closeable:true,actionMgr:true,remindType:1,clearOnClose:true,types:["wbs","refer","cmts","fans","msgs","notify"],wbsUrl:h.mkUrl("index"),referUrl:h.mkUrl("index","atme"),cmtsUrl:h.mkUrl("index",
"comments"),msgsUrl:h.mkUrl("index","messages"),fansUrl:h.mkUrl("index","fans"),notifyUrl:h.mkUrl("index","notices"),initUI:function(){if(this.remindType)this.view="NoticeLayer";p.initUI.call(this);this.getView();q.on("api.unread",t.bind(this.unreadLoad,this))},push:function(r,w){var x=this.jq("#"+r),y=x.find("#c"),z=parseInt(y.text());if(w!=z){y.text(w);x.cssDisplay(!!w)}if(w&&!this.display()){this.display(true);Xwb.util.ie6||this.keepTop()}},keepTop:function(){function r(){l(document).scrollTop()>
30?w.css("top","0"):w.css("top","30px")}var w=this.jq();l(window).scroll(r);l(window).resize(function(){r(1)});r()},onclose:function(){this.clearOnClose&&this.clearUnread()},clearUnread:function(){var r=this;l.each(this.types,function(){var w=r.jq("#"+this);w.cssDisplay(false);w.find("#c").text("0")});h.clearUnread("",l.noop)},unreadLoad:function(r){if(r.isOk()){r=r.getData().unread;for(var w=true,x=1,y=this.types.length;x<y;x++)if(r[x]){this.push(this.types[x],r[x]);w=false}w&&this.display(false)}}},
d)});q.reg("notice",j,true);return j});q.reg("feedback",function(d){var j=q.use("Box",l.extend({view:l("#feedbackBox")[0],mask:true,closeable:true,onViewReady:function(){this.view.parentNode!==o.body&&this.appendAt(o.body);var p=this.jq("#fbForm");this.validator=q.use("Validator",{form:p,trigger:this.jq("#trig"),validators:{radio:function(r,w,x,y){r=l(this.context.form).find('input[name="mail"]').val();w=l(this.context.form).find('input[name="tel"]').val();if(r==k("邮箱地址")&&w==k("联系电话")){x.m=k("至少填写一种联系方式");
this.report(false,x)}else this.report(true,x);y()}},onsuccess:function(r,w){h.feedback(r,function(){});j.close();w();return false}})},afterShow:function(){q.ui.Box.prototype.afterShow.call(this);this.reset()},reset:function(){this.jq("[name=content]").val("").focus();this.jq("[name=mail]").val(k("邮箱地址"));this.jq("[name=tel]").val(k("联系电话"));this.jq("#feedbackTip").cssDisplay(false)}},d));q.reg("feedback",j,true);return j});s.authLogin={open:function(d,j){var p=this.logWin;if(p&&!p.closed)p.focus();
else{p=h.mkUrl("account","sinaLogin","popup=1&cb="+(d||""));if(j)p+="&loginCallBack="+encodeURIComponent(j);this.logWin=window.open(p,"logWin","resizable=1,location=0,status=0,scrollbars=0,width=570,height=380");if(!window.loginCallback)window.loginCallback=t.bind(this.onPopupCallback,this)}},direct:function(d){var j=location.href;if(q.getModule()==="account.login")j=t.dequery(j).loginCallBack||j;this.open(d,j);return false},bind:function(d,j){var p=this;l(d).bind(j||"click",function(){p.direct()})},
onPopupCallback:function(d){this.logWin.close();if(d)location.href=d;else{d=q.getModule();if(d.indexOf("pub")||d.indexOf("index"))location.href=h.mkUrl("pub");else location.reload()}}};s.loginBox=q.reg("loginBox",function(){var d=q.use("Box",{contentHtml:"Login",cs:"win-bind-login win-fixed",appendTo:o.body,mask:true,closeable:true,onViewReady:function(){s.authLogin.bind(this.jq("#oauth"))},siteName:b("siteName"),siteLoginUrl:h.mkUrl("account","siteLogin"),regUrl:q.getCfg("siteReg"),sinaRegUrl:q.getCfg("sinaReg")});
q.reg("loginBox",d,true);return d});s.FadeShow=q.reg("FadeBox",t.create(m,{curr:0,length:0,duration:300,delay:5E3,running:false,runTimer:null,onViewReady:function(){this.$list=l(this.view).children();this.length=this.$list.length;var d=this;l(this.view).mouseover(function(){d.stop()}).mouseout(function(j){j=j.relatedTarget;if(!j||!l.contains(d.view,j))d.start()});this.start()},start:function(){if(!(this.length<=1))if(!this.runTimer){var d=this;this.runTimer=setTimeout(function(){d.fade()},this.delay);
this.running=true}},stop:function(){if(this.runTimer){clearTimeout(this.runTimer);this.runTimer=null}this.running=false},fade:function(){var d=this.curr,j=++this.curr,p=this;if(j>=this.length)this.curr=j=0;var r=l(this.$list[d]),w=l(this.$list[j]);r.animate({opacity:0},{duration:p.duration,complete:function(){r.addClass("next");w.removeClass("next").css({opacity:0}).animate({opacity:1},{duration:p.duration,complete:function(){p.runTimer=null;p.running&&p.start()}})}})}}));q.mod.HoverList=t.create(m,
{innerViewReady:function(){m.prototype.innerViewReady.call(this);this.jq(this.itemSelector).hover(this.onMouseOver,this.onMouseOut)},onMouseOver:l.noop,onMouseOut:l.noop});q.reg("addFollow",function(d){d=q.use("Box",l.extend({actionMgr:true,cs:"add-topic",boxOutterHtml:'<div class="arrow"></div>',closeable:true,contentHtml:"addFollowContent",onactiontrig:function(j){var p=this;switch(j.get("e")){case "cls":this.close();break;case "submit":if(t.byteLen(this.jq("#Content").val())<=20){j.lock(1);h.postReq(h.apiUrl("action",
"addSubject"),{text:this.jq("#Content").val()},function(r){if(r.isOk()){q.fire("subrefresh",{subject:p.jq("#Content").val(),type:"add"});p.close()}else{p.jq(".warn").prev("p").cssDisplay(0);p.jq(".warn").cssDisplay(1).html(r.getError())}j.lock(0)})}else{p.jq(".warn").prev("p").cssDisplay(0);p.jq(".warn").cssDisplay(1).html(k("话题长度太长"))}}},beforeShow:function(){var j=this.jq("#Content").val("");setTimeout(function(){j.focus()},1)},onViewReady:function(){var j=this;this.jq("#Content").focus(function(){j.jq(".warn").cssDisplay(false);
j.jq(".warn").prev("p").cssDisplay(true)})}},d));d.display(true);return d});q.reg("verifyBox",function(d){d=q.use("Box",l.extend({contentHtml:"verify",cs:"verify-tips",closeable:true,autoCenter:true,hidden:false,setAnchor:function(j){this.anchorEl=j;return this},beforeShow:function(){u.Box.prototype.beforeShow.call(this);if(this.anchorEl){this.anchor(this.anchorEl,"tc",function(p){p[1]-=2});var j=this;this.slide("bc",true,function(){u.Box.prototype.afterShow.call(j)})}},afterShow:l.noop,beforeHide:function(){if(this.anchorEl){this.slide("cb",
false);delete this.anchorEl;return false}else u.Box.prototype.beforeHide.call(this)},afterHide:function(){u.Box.prototype.afterHide.call(this);this.onbuttonclick=u.Box.prototype.onbuttonclick}},d));q.reg("verifyBox",d,true);return d});q.reg("MoreList",function(d){d=q.use("Layer",l.extend({closeable:true,contextable:true,actionMgr:true,onactiontrig:function(j){var p=j.data,r=j.get("u");switch(p.e){case "abl":p.gender=k(p.gender=="f"?"她":"他");i.confirm(k("提示"),k("确定将{nick}加入到黑名单吗？<span>你和{gender}将自动解除关注关系，并且{gender}不能再关注你，给你发评论、私信和@你。</span>",
p),function(w){w==="ok"&&h.blacklistAdd(r,"",function(x){x.isOk()&&window.location.reload()})})}}},d));q.reg("MoreList",d,true);return d});q.report=function(){function d(){var y=l.cookie("x3w4b");if(!y){y=(y=void 0)||16;for(var z=["u"],B,C=0;C<y;C++){B=Math.ceil(Math.random()*62)-1;z.push("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(B))}y=z.join("");l.cookie("x3w4b",y,{expires:9E4})}return y}function j(y){if(!w.akey)w.akey=b("akey");if(!w.ver)w.ver=b("version");y.random=
Math.random();y.c_id=d();y.p_id=b("page");var z=b("uid");if(z)y.uid=z;y=l.extend(y,w);var B=[];l.each(y,function(C,A){B.push(C+"="+encodeURIComponent(A))});r.src=p+"?"+B.join("&")}var p="http://beacon.x.weibo.com/a.gif",r,w={pjt:"xwb",xt:"stay"},x=function(){function y(){if(!B){c();r=new Image;B=true}}function z(){var D=(new Date).getTime(),E={time:D-(A?A:C)};if(!A&&document.referrer)E.t_id=document.referrer;j(E);A=D}var B=false,C=(new Date).getTime(),A=0;return{start:function(){y();window.setInterval(z,
18E5)},report:function(){!B&&y();z()}}}();return{start:function(){x.start()},report:function(){x.report()}}}();q.mod.AdMgm={init:function(d){d=this.cfgs=d||{};for(var j=!!this.globalHandlers,p=this.handlers,r=0,w=d.length;r<w;r++){var x=d[r];j&&this.fireGlobal(x);p&&p[x.flag]&&p[x.flag](x,this)}this.inited=true},fireGlobal:function(d){var j=this.globalHandlers;if(j)for(var p=0,r=j.length;p<r;p++)j[p](d,this)},reg:function(d,j){if(j===void 0)if(this.globalHandlers)this.globalHandlers.push(d);else this.globalHandlers=
[d];else{if(!this.handlers)this.handlers={};this.handlers[d]=j;this.inited&&this.cfgs[d]&&j(this.cfgs[d],this)}},getAd:function(d){if(!d)return this.cfgs;if(this.cfgs)for(var j=0;j<this.cfgs.length;j++)if(this.cfgs[j].flag==d)return this.cfgs[j]}}})(Xwb,jQuery);(function(q,l){var u=q.request,t=q.ui.MsgBox,o=q.getCfg,m=q.getWb,g=document,h=q.lang.getText;q.use("action").addFilter(function(i,b){if(!b||!b.na){var c=q.getUid(),a=q.getSiteUid(),e=o("loginCfg")||1;if(!c){if(i.get("e")=="lg")e=i.data.t||e;if(a)if(i.get("e")=="lg")q.mod.authLogin.direct("bind");else window.location=u.mkUrl("account","bind");else switch(parseInt(e,10)){case 3:q.use("loginBox").display(true);break;case 2:window.location=u.mkUrl("account","siteLogin");break;default:q.mod.authLogin.direct()}return false}}},
true).reg("sd",function(i){var b=q.use("postBox"),c=i.get("m");(i=i.get("t"))&&i=="share"&&b.setPostTitle(h("分享给大家"));b.display(true).reset().selectionHolder.setText(c||"");c&&b.checkText()}).reg("fw",function(i){var b=i.get("w");(v=i.get("v"))?Xwb.use("verifyBox",{appendTo:g.body}).setAnchor(i.src).display(true):Xwb.use("forwardBox").display(true).setContent(b,m(b),q.getUid()).selectionHolder.focusStart()}).reg("fl",function(i){var b=i.get("u");l(i.src);i.lock(1);u.follow(b,0,function(c){if(c.isOk()||
c.getCode()=="1020805"){c=i.get("t");var a=l(i.src);switch(parseInt(c)){case 1:a.replaceWith('<span class="followed-btn">'+h("已关注")+"</span>");break;case 2:a.replaceWith("<em>"+h("已关注")+"</em>");break;case 3:a.replaceWith('<div class="operated-box"><span class="followed-btn">'+h("已关注")+'</span><em>|</em><a href="#" rel="e:ufl,t:3" class="cancel">'+h("取消")+"</a></div>");break;default:location.reload()}}else c.getCode()=="1020806"?t.confirm("",h("你今天已经关注了足够多的人，先去看看他们在说些什么吧？"),function(e){if(e=="ok")location.href=
Req.mkUrl("ta","","id="+b)}):t.tipWarn(c.getMsg());i.lock(0)})}).reg("ufl",function(i){t.anchorConfirm(i.src,h("确定要取消关注")+"？",function(b){if(b=="ok"){i.lock(1);b=i.get("u");var c=parseInt(i.get("t"));u.unfollow(b,"",function(a){if(a.isOk())switch(c){case 1:l(i.src).replaceWith('<a rel="e:fl,t:2" href="#">'+h("关注他")+"</a>");break;case 3:l(i.src).parent().replaceWith('<a class="skin-bg addfollow-btn" rel="e:fl,t:3" href="#">加关注</a>');break;default:window.location.reload()}else t.tipWarn(a.getMsg());
i.lock(0)})}})}).reg("rs",function(i){var b=i.get("w");i=m(b);var c=Xwb.use("Box",{cs:"win-report",contentHtml:"SpanBoxContent",title:"举报不良信息",appendTo:document.body,closeable:true,mask:true,destroyOnClose:true,actionMgr:true,autoCenter:true,nick:i.u.sn,img:i.u.p,text:i.tx,onactiontrig:function(a){switch(a.data.e){case "ok":a=this.jq("#content").val();u.reportSpam(b,a,function(e){e.isOk()&&t.success("","您的举报已提交，我们将尽快处理，感谢您对我们工作的支持！");c.close()});break;case "cancel":this.close()}}});c.display(true);
c.jq("#content").focus()}).reg("blm",function(i){t.anchorConfirm(i.src,"确定要屏蔽该微博？",function(b){if(b=="ok"){b=i.get("w");i.lock(1);u.shieldBlog(b,function(c){if(c.isOk()){t.anchorTipOk(i.src,"屏蔽成功！");l(i.src).replaceWith("<span>已屏蔽</span>")}i.lock(0)})}})}).reg("rl",function(){location.reload()},{na:true}).reg("fr",function(i){var b=i.get("w");if(i.get("v"))Xwb.use("verifyBox",{appendTo:g.body}).setAnchor(i.src).display(true);else{i.lock(1);u.fav(b,function(c){if(c.isOk()){t.anchorTipOk(i.src,"收藏成功！");
l(i.src).replaceWith("<span>已收藏</span>")}else t.tipWarn(c.getMsg());i.lock(0)})}}).reg("ufr",function(i){t.anchorConfirm(i.src,"确定要删除该收藏？",function(b){if(b=="ok"){i.lock(1);b=i.get("w");u.delFav(b,function(c){if(c.isOk())if(i.data.t==1){var a=l(i.getEl("w"));a.slideUp(500,function(){a.remove();i.lock(0)})}else{l(i.src).replaceWith('<a rel="e:fr" href="#">收藏</a>');i.lock(0)}})}})}).reg("cm",function(i){var b=i.get("w"),c=l(i.getEl("w")),a=c.data("xwb_cmt");if(i.get("v"))Xwb.use("verifyBox",{appendTo:g.body}).setAnchor(i.src).display(true);
else{if(!a){var e=m(b);a=q.use("CmtArea",{wbId:b,wbUid:e&&e.u.id,appendTo:c.find(".feed-content"),trigEl:i.src});c.data("xwb_cmt",a)}if(a.display())a.display(false);else{a.display(true);a.load(function(){a.cmtBox.jqInputor.focus()})}}}).reg("tl",function(i){var b=l(i.getEl("w")),c=b.data("wbEle");if(!c){c=i.get("w");var a=i.get("v");c=q.use("WbElement",{$wb:b,psrc:i.get("p"),psrc:i.get("p"),wid:c,state:a,wbData:m(c)});b.data("wbEle",c)}c.trun("left")},{na:true}).reg("tr",function(i){var b=l(i.getEl("w")),
c=b.data("wbEle");if(!c){c=i.get("w");var a=i.get("v");c=q.use("WbElement",{$wb:b,psrc:i.get("p"),wid:c,state:a,wbData:m(c)});b.data("wbEle",c)}c.trun("right")},{na:true}).reg("zo",function(i){var b=l(i.getEl("w")),c=b.data("wbEle");if(!c){c=i.get("w");var a=i.get("v");c=q.use("WbElement",{$wb:b,psrc:i.get("p"),wid:c,state:a,wbData:m(c)});b.data("wbEle",c)}l(document).scrollTop()>b.find('div[name="img"]').offset().top&&l(document).scrollTop(b.offset().top-21);c.zoomOut()},{na:true}).reg("zi",function(i){var b=
l(i.getEl("w")),c=b.data("wbEle");if(!c){c=i.get("w");var a=i.get("v");c=q.use("WbElement",{$wb:b,psrc:i.get("p"),wid:c,state:a,wbData:m(c)});b.data("wbEle",c)}c.zoomIn()},{na:true}).reg("pv",function(i){var b=l(i.getEl("w")),c=b.data("wbEle");if(!c){c=i.get("w");var a=i.get("v");c=q.use("WbElement",{$wb:b,psrc:i.get("p"),wid:c,state:a,wbData:m(c)});b.data("wbEle",c)}c.playVideo(i)},{na:true}).reg("cv",function(i){var b=l(i.getEl("w")),c=b.data("wbEle");if(!c){c=i.get("w");var a=i.get("v");c=q.use("WbElement",
{$wb:b,psrc:i.get("p"),wid:c,state:a,wbData:m(c)});b.data("wbEle",c)}c.closeVideo(i)},{na:true}).reg("dl",function(i){var b=i.get("w"),c=i.get("v");t.anchorConfirm(i.src,h("确定删除该微博吗？"),function(a){if(a==="ok"){i.lock(1);u.del(b,c,function(e){var k=l(i.getEl("w"));e.isOk()?k.slideUp("normal",function(){k.remove()}):t.tipWarn(e.getMsg());i.lock(0)})}})}).reg("clsevt",function(i){var b=i.get("id");b&&t.anchorConfirm(i.src,h("确定要关闭此活动？"),function(c){if(c==="ok"){i.lock(1);u.eventClose(b,function(a){a.isOk()?
location.reload():t.tipWarn(i.getMsg())})}})}).reg("delevt",function(i){var b=i.get("id");b&&t.anchorConfirm(i.src,h("确定要删除此活动？"),function(c){if(c==="ok"){i.lock(1);u.eventDelete(b,function(a){a.isOk()?location.reload():t.tipWarn(i.getMsg())})}})}).reg("mop",function(i){i=l(i.src);var b=i.data("morelayer");if(!b){b=q.use("MoreList",{view:l("#more_list")[0]});i.data("morelayer",b)}b.display(1)}).reg("sdm",function(i){var b=q.use("myMsg");b.display(true).reset();var c=i.get("c");c&&b.selectionHolder.setText(c);
(i=i.get("n"))&&b.jqSender.val(i);i?b.jqContent.focus():b.jqSender.focus()}).reg("rm",function(i){q.use("myMsg").reply(i.get("u"),i.get("n"))}).reg("dm",function(i){t.anchorConfirm(i.src,h("确定要删除该私信？"),function(b){if(b=="ok"){i.lock(1);b=i.get("m");u.delMsg(b,function(c){c.isOk()&&location.reload();i.lock(0)})}})}).reg("dbl",function(i){function b(){i.lock(1);var a=i.get("u");u.blacklistDel(a,"",function(e){e.isOk()?location.reload():t.tipWarn(e.getMsg());i.lock(0)})}var c=i.data.m;c?t.confirm(h("提示"),
c,function(a){a==="ok"&&b()}):b()}).reg("dfan",function(i){t.confirm(h("提示"),h("移除之后将取消{0}对你的关注?",name),function(b){if(b=="ok"){b=i.get("u");var c=i.getEl("u");i.lock(1);u.removeFans(b,"",function(a){if(a.isOk())l(c).slideUp(500,function(){i.lock(0);l(c).remove()});else{t.tipWarn(i.getMsg());i.lock(0)}})}})}).reg("addSubject",function(i){var b=l(i.src);i.lock(1);u.postReq(u.apiUrl("action","addSubject"),{text:i.get("subject")},function(c){if(c.isOk()){b.parent().replaceWith("<span>"+h("已关注")+'(<a href="javascript:;" rel="e:delSubject">'+
h("取消关注")+"</a>)</span>");q.fire("subrefresh",{subject:i.get("subject"),type:"add"})}else t.alert(h("提示"),c.getError());i.lock(0)})}).reg("delSubject",function(i){var b=l(i.src);i.lock(1);u.postReq(u.apiUrl("action","deleteSubject"),{text:i.get("subject")},function(c){if(c.isOk()){b.parent().replaceWith('<span class="topic-follow"><a href="javascript:;" rel="e:addSubject">'+h("关注该话题")+"</a></span>");q.fire("subrefresh",{subject:i.get("subject"),type:"del"})}else t.alert(h("提示"),c.getError());i.lock(0)})})})(Xwb,
$);(function(q,l){var u=q.lang.getText;Xwb.ax.ValidationMgr.prototype.reg("ft",function(t,o,m,g){if(arguments.length==2){var h=t.value||arguments[1].w;l(t).data("vrel_ft_text",h).focusText(h)}else{h=l(t).data("vrel_ft_text");o==h&&this.setValue("");this.report(true,m);g()}}).reg("ne",function(t,o,m,g){var h=o==="",i=l(t).data("vrel_ft_text")||m.w;if(!h&&i)(h=o==i)&&this.setValue("");if(h&&!m.m)m.m=u("该项不能为空");if(t.tagName==="INPUT"&&(t.type==="radio"||t.type==="checkbox"))h=!t.checked;this.report(!h,
m);g()}).reg("f",function(t,o){var m=this,g=t.tagName.toLowerCase();if(m.context.comForm&&(g=="input"||g=="textarea")){var h=m.context.focusCss;l(t).blur(function(){l(this).removeClass(h);o.ch||m.validate()}).focus(function(){l(this).removeClass(m.context.errCss);l(this).addClass(h)})}else l(t).blur(function(){m.validate()})}).reg("sz",function(t,o,m,g){if(o){t=m.ww?Xwb.util.byteLen(o):o.length;var h;o=m.max;var i=m.min;if(o!==undefined&&parseInt(o)<t)h=true;if(i!==undefined&&parseInt(i)>t)h=true;
this.report(!h,m)}else this.report(true,m);g()}).reg("dt",function(t,o,m,g){if(o){if(!m.m)m.m=u("不是有效的日期格式");t=Date.parse(o);this.report(!isNaN(t),m)}else this.report(true,m);g()}).reg("mail",function(t,o,m,g){if(o){t=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(o);if(!m.m&&m.m!==0)m.m=u("请输入正确的邮箱格式");this.report(t,m)}else this.report(true,m);g()}).reg("int",function(t,o,m,g){if(o!==""){t=o&&/^\d+$/.test(o);if(!m.m&&m.m!==0)m.m=u("该项为数字格式");this.report(t,m)}else this.report(true,m);g()}).reg("bt",
function(t,o,m,g){if(o!==""){t=parseInt(m.min);var h=parseInt(m.max);o=parseInt(o);var i=0;if(o<t)i=1;if(!i&&o>h)i=2;this.report(!i,m)}else this.report(true,m);g()}).reg("sinan",function(t,o,m,g){if(o){if(!m.m)m.m=u('支持中英文、数字、"_"或减号');this.report(/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(o),m)}else this.report(true,m);g()})})(Xwb,$);(function(q,l){function u(m){var g=m.flag,h=m.page;l("#ad_"+g).find("#xwb_ad_cls").mousedown(function(){l("#ad_"+g).cssDisplay(false);l.cookie("ad_"+h+"_"+g+"_hide","1",{expires:1});return false})}function t(){if(!o){var m=l("#container"),g=l("#ad_global_left"),h=l("#ad_global_right"),i=function(){var b=m.offset().left;g.length&&g.css("left",b-g.width()-20);h.length&&h.css("left",b+m.width()+20)};l(window).resize(i);o=true;setTimeout(function(){g.css("visibility","hidden").removeClass("hidden");h.css("visibility",
"hidden").removeClass("hidden");i();g.css("visibility","");h.css("visibility","")},20)}}var o;q.mod.AdMgm.reg(function(m){u(m)});q.mod.AdMgm.handlers=l.extend(q.mod.AdMgm.handlers,{global_left:t,global_right:t})})(Xwb,$);(function(q,l){var u=q.getCfg,t=q.request,o=q.util,m=q.ui.MsgBox,g=q.ax.Pagelet,h=q.lang.getText;o.ns("Xwb.mod.pagelet",{});var i=q.mod.pagelet.WeiboList=o.create(g,{ui:{cls:q.mod.WeiboList},onViewReady:function(b){if(b=b.data){if(b=b.list){var c=q.cfg.wbList;if(!c)q.cfg.wbList=c={};for(var a in b)c[a]||(c[a]=b[a])}q.on("api.getCounts",o.getBind(this,"onUpdateCounter"))}},onUpdateCounter:function(b){if(b.isOk()){var c=this.getUI().jq("#xwb_weibo_list_ct>li"),a=q.cfg.wbList,e=b.getData(),k,s,d,j,p=
this;c.each(function(){k=l(this);s=o.parseKnV(k.attr("rel")).w;(j=e[s])&&p.renderWeiboCounter(k,j);if(d=a[s]){var r=d.rt;if(r&&(j=e[r.id])){k=k.find(".forward");p.renderInnerWeiboCounter(k,j)}}})}},renderWeiboCounter:function(b,c){c[0]&&b.find("#cm").text(h("评论")+"("+c[0]+")");c[1]&&b.find("#fw").text(h("转发")+"("+c[1]+")")},renderInnerWeiboCounter:function(b,c){c[0]&&b.find("#lk_cm").text(h("原文评论")+"("+c[0]+")");c[1]&&b.find("#lk_fw").text(h("原文转发")+"("+c[1]+")")}});q.use("pipeMgr").reg("common.userSkin",
function(){return new g({ui:{actionMgr:true,uploaded:false,skinSelectedCS:"current",colorSelectInit:false,colorSelectId:"csArea",isIE:l.browser.msie,ieStyleId:"customStyle",colorInput:"colorshow",colorHiddenId:"colorSelector",initIscustom:false,isClickCustom:false,customLinkId:"custom_css",address:"http://"+window.location.hostname+t.basePath,backCur:"cur",searchCssFile:["skin_define/skin.css","setting.getSkin","skin_set.css","base.css"],parseRel:Xwb.ax.ActionMgr.parseRel,onViewReady:function(){this.back_form=
this.jq("#xwb_back_form");this.jqForm=this.back_form[0];this.back_file=this.jq("#xwb_back_file");this.pwImg=this.jq("#previewImg");this.delImg=this.jq("#closeImg");var b=this;this.switcher="";this.initIscustom=this.custom=this.jq("#switcherItem #custom").hasClass("current");this.back_file.change(function(){b.change(this.value)});this.isSelectSkin(true);q.use("Switcher",{items:l("#switcherItem>span"),contents:l("#switcherCom>div"),selectedCS:"current",onselect:function(c){if(!b.initIscustom&&c.id==
"custom"&&!b.isClickCustom)b.isClickCustom=true;b.custom=c.id=="custom"?true:false;b.switchBackColor(b.custom?"set":"select")}});this.backInit();this.delImg.click(o.bind(this.closeUploadImg,this));this.initIscustom&&setTimeout(function(){b.initCustomStyle()},10)},initCustomStyle:function(){var b=this.setPhotoColor();b[0].push("html");b[1].push(this.getBackAttr());this.setPageStyle(b[0],b[1],"cover")},closeUploadImg:function(){if(this.pwImg.attr("rel")){var b=u("language");this.pwImg.attr({rel:"",
src:t.basePath+"img/"+(b=="zh_cn"?"/":b+"/")+"upload_pic.png"});this.delImg.cssDisplay(false);this.getBackPhoto(false,"")}},photoBackTile:function(b){var c=this.jq("#bg-repeat").attr("checked")?"repeat":"no-repeat";if(b)return["html",{backgroundRepeat:c}];this.setClassByName("html","backgroundRepeat",c)},photoBackStrong:function(b){var c=this.jq("#bg-fixed").attr("checked")?"fixed":"";if(b)return["html",{backgroundAttachment:c}];this.setClassByName("html","backgroundAttachment",c)},photoBackPlace:function(b){if(!this.jq("#align a.cur").attr("rel"))if(b)return["",
""];else return;var c=this.parseRel(this.jq("#align a.cur").attr("rel")).w;c=c=="1"?"left top":c=="2"?"center top":"right top";if(b)return["html",{backgroundPosition:c}];this.setClassByName("html","backgroundPosition",c)},getBackPhoto:function(b,c){if(b)return["html",{backgroundImage:"url("+c+")"}];this.setClassByName("html","backgroundImage","url("+c+")")},change:function(b){if(b&&!this.checkImg(b)){m.alert("",h("只支持{0}格式的图片。","jpg、png"));this.back_form[0].reset()}else this.getUploader().upload()},
checkImg:function(b){b=b.split(".");return b.length&&l.inArray(b.pop().toLowerCase(),["jpg","png"])!==-1},getUploader:function(){if(!this.uploader)this.uploader=q.use("Uploader",{form:this.jqForm,action:this.back_form.attr("action"),onload:o.getBind(this,"onUploadLoad")});return this.uploader},onUploadLoad:function(b){var c=t.parseProtocol(b);this.back_form[0].reset();if(typeof c!="object")m.alert(h("提示"),h("上传失败!"));else if(c.isOk()&&c.getRaw().raw.rst!==false){this.pwImg.attr({src:c.raw.raw.rst.url,
rel:"u:1"});this.delImg.cssDisplay(true);b=[];var a=[];c=this.getBackPhoto(true,c.raw.raw.rst.url);if(!this.uploaded){!this.jq("#align a.cur").attr("rel")&&this.jq("#align a").eq(0).addClass("cur");var e=this.photoBackTile(true);e=l.extend(e[1],this.photoBackPlace(true)[1])}l.extend(c[1],e);b.push("html");a.push(c[1]);this.setCssByObject(b,a);this.uploaded=true}else{b="";switch(c.raw.raw.errno){case 3040010:b=h("上传图片失败");break;case 3040012:b=h("上传背景图片的大小不能超过2M，请重新选择");break;case 610003:case 3040013:b=
h("上传图片类型不符合要求");break;default:b=h("上传图片失败")}m.alert(h("提示"),b)}},changeCss:function(b,c){function a(d,j){d=d?k.address+d:k.address+"css/default/"+b+e;var p=k.createCss(d,"");if(k.isIE)var r=document.styleSheets.length,w=setInterval(function(){try{if(document.styleSheets.length>r){clearInterval(w);l(j).remove();o.getClassByName("html").backgroundImage="url()";k.loadLanguageCss()}}catch(y){}},10);else var x=setInterval(function(){try{clearInterval(x);l(j).remove();o.getClassByName("html").backgroundImage=
"url()";k.loadLanguageCss()}catch(y){}},10);l("head").append(p)}var e=u("language")==="zh_tw"?"/skin_zh_tw.css":"/skin.css",k=this,s=false;l('link[href$="zh_tw.css"]').remove();l("link[rel=stylesheet]").each(function(){if(this.href.indexOf(e)!==-1&&this.id!=k.customLinkId){s=true;this.href.indexOf("/css/default/"+b+e)>0||a("/css/default/"+b+e,this)}});if(!s){k=this;if(this.isIE&&l.browser.version==6){k.cacheCss=k.getTempStyle();setTimeout(a,100)}else a()}this.switcher=c},createCss:function(b,c){var a=
document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",b);a.setAttribute("id",c);return a},loadLanguageCss:function(){u("language")==="zh_tw"&&l("head").append(this.createCss(this.address+"css/default/language/zh_tw.css",""))},decorateSelected:function(b){if(!this.jqPreSel)this.jqPreSel=this.jq("#switcherCom ."+this.skinSelectedCS);this.jqPreSel.removeClass(this.skinSelectedCS);this.jqPreSel.find(".bg-icon").removeClass("bg-icon");
this.jqPreSel=l(b);this.jqPreSel.addClass(this.skinSelectedCS);this.jqPreSel.find("span").addClass("bg-icon")},isSelectSkin:function(b){if(!this.jqPreSel)this.jqPreSel=this.jq("#switcherCom ."+this.skinSelectedCS);if(b){this.orgBackColor=l("html").css("backgroundColor");this.orgBackBg=l("body").css("backgroundImage")}},switchBackColor:function(b){if(b=="select"){if(!this.jqPreSel)this.jqPreSel=this.jq("#switcherCom ."+this.skinSelectedCS);if(this.jqPreSel.length){this.cacheCss=this.getTempStyle();
b=this.parseRel(this.jqPreSel.attr("rel"));this.changeCss(b.sk,b.id)}}else this.loadLink(this.address+"css/default/skin_define/skin.css.php",this.customLinkId)},loadLink:function(b){var c=u("language")==="zh_tw"?"/skin_zh_tw.css":"/skin.css",a=this,e=function(){l('link[href$="zh_tw.css"]').remove();l("link[rel=stylesheet]").each(function(){this.href.indexOf(c)!==-1&&this.id!=a.customLinkId&&l(this).remove()});if(a.cacheCss){a.addStyle("",a.cacheCss,"cathe");a.cacheCss=""}};if(!this.initIscustom&&
l("head #defaultStyle").length==0){b="css/default/skin_define/skin.css.php";l.get(this.address+b,{},function(k){e();var s=document.getElementsByTagName("head")[0],d=document.createElement("style");d.setAttribute("type","text/css");d.setAttribute("id","defaultStyle");s.appendChild(d);if(d.styleSheet)d.styleSheet.cssText=k;else d.innerHTML=k;a.loadLanguageCss()})}else{e();a.loadLanguageCss()}},getTempStyle:function(){var b=document.getElementById(this.ieStyleId);if(b)return b.styleSheet?b.styleSheet.cssText:
b.innerHTML;return""},setCustomClass:function(){var b=[],c=[],a="",e=this.pwImg.attr("rel");if(e)a=this.parseRel(e).u?this.pwImg.attr("src"):"";e=this.photoBackTile(true);b.push("html");var k=this.photoBackStrong(true);e=l.extend(e[1],k[1]);e=l.extend(e,this.photoBackPlace(true)[1]);(e=l.extend(e,{backgroundImage:"url("+a+")"}))&&c.push(e);b.push(".wrap-in");c.push({backgroundImage:""});b.push("#wrap");c.push({backgroundImage:""});a=this.jq("#color-area a");k=0;for(var s=a.length;k<s;k++){e=this.getChangeClass(k,
"#"+a.eq(k).attr("key"));b=l.merge(b,e[0]);c=l.merge(c,e[1])}return[b,c]},getCustomData:function(){var b={},c=this.jq("#color-area a");b.colors=[];for(var a=0,e=c.length;a<e;a++)b.colors.push(c.eq(a).attr("key"));b.colors=b.colors.join(",");c=this.pwImg.attr("rel");b.bg=c?this.parseRel(c).u?this.pwImg.attr("src"):"":"";b.tiled=this.jq("#bg-repeat").attr("checked")?1:0;b.fixed=this.jq("#bg-fixed").attr("checked")?1:0;c=this.jq("#align a.cur");b.align=c.length?this.parseRel(c.attr("rel")).w:2;c=this.jq("#scheme-select div.cur");
b.colorid=c.length?this.parseRel(c.attr("rel")).t:"";return b},isChangeColor:false,showColorSelect:function(b){var c=this,a=false;this.isChangeColor=false;if(!this.colorSelectInit){this.colorSelectInit=true;l("#"+this.colorHiddenId).ColorPicker({appendTo:"#"+c.colorSelectId,inputId:c.colorInput,color:c.curColor,cpBodyWidth:"212px",onShow:function(e){l("#"+l("#"+c.colorHiddenId).data("colorpickerId")).data("colorpicker").set(c.curColor);l("#"+c.colorSelectId+"#cltitle").html(b);l(e).show();l("#"+c.colorSelectId).css({position:"relative",
"z-index":10005,left:l("#skin_setcolorArea").offset().left-200+"px",top:"35px"}).fadeIn(500);return false},onHide:function(){l("#"+c.colorSelectId).hide();return false},onChange:function(e,k){c.setSelectBox(k,a);c.isChangeColor=true}})}l("#"+this.colorSelectId+" #cltitle").html(b);l("#"+this.colorHiddenId).click();a=true},setSelectBox:function(b){if(this.selectColorObj){l(this.selectColorObj).find("span").css("backgroundColor","#"+b).parent().attr("key",b);l("#"+this.colorSelectId).find("#cRealColor>span").css("backgroundColor",
"#"+b)}if(this.isChangeColor){this.jq("#scheme-select div."+this.backCur).removeClass(this.backCur);if(this.selectColorObj){var c=this.getChangeClass(this.selectColorType,"#"+b),a=this.getPhotoColor(this.selectColorType,"#"+b);b=l.merge(c[0],a[0]);c=l.merge(c[1],a[1]);b.push("html");c.push(this.getBackAttr());this.setPageStyle(b,c,"add")}}},setBackColor:function(b,c){c=l(c);if(!c.hasClass(this.backCur)){this.jq("#"+b+" ."+this.backCur).removeClass(this.backCur);c.addClass(this.backCur)}},reload:function(){window.location=
String(window.location.href).replace(/skinset[^A-Za-z0-9\/]{1}1/g,"")},backPage:1,allBackPage:2,curSelect:1,disableClsl:"arrow-l-s1-disabled",disableClsr:"arrow-r-s1-disabled",slidePx:300,minus:0,ulPx:0,ulId:"scheme-select",sliding:false,selectBox:["#000","#808080","#f66","#90c","#e7f2fb","#fff","#f00","#f60","#fc0","#090"],backInit:function(){var b=this.jq("#"+this.ulId);this.liNum=b.find("li").length;this.setSlideBtn(b.css("margin-left").replace("px",""))},getBackPhotoInfo:function(){var b="",c=
this.pwImg.attr("rel");if(c)b=this.parseRel(c).u?this.pwImg.attr("src"):"";return b},setPageStyle:function(b,c,a){this.mergeMatch(b,c);this.addStyle(b,c,a||"cover")},setCssByObject:function(b,c,a){this.addStyle(b,c,a||"change")},setClassByName:function(b,c,a,e){var k=[],s={};s[c]=a;if(c=="backgroundPosition"||c=="backgroundRepeat"||c=="backgroundAttachment")if(c=this.getBackPhotoInfo())s.backgroundImage="url("+c+")";else return;k.push(s);this.addStyle([b],k,e||"change")},splitArray:function(b,c){for(var a=
function(s,d){var j=d.length;b.splice(s,1,d[0]);for(var p=1;p<j;p++){b.splice(s+p,0,d[p]);c.splice(s+p,0,c[s])}},e=0;e<b.length;e++){var k=b[e].split(", ");if(k.length>1){a(e,k);e+=k.length-1}}},setPhotoColor:function(){for(var b=this.jq("#color-area a"),c=[],a=[],e=[],k=[],s=0,d=b.length;s<d;s++){var j="#"+b.eq(s).attr("key"),p=this.getChangeClass(s,j);j=this.getPhotoColor(s,j);c=l.merge(c,p[0]);a=l.merge(a,p[1]);e=l.merge(e,j[0]);k=l.merge(k,j[1])}c=l.merge(c,e);a=l.merge(a,k);if(b=this.getBackPhotoInfo()){c.push("html");
a.push({backgroundImage:"url("+b+")"})}return[c,a]},getPhotoColor:function(b,c){var a=[],e=[];switch(b){case 0:a.push(".pb-main .pb-list .pb-con .c2");a.push(".pb-aside .pb-block p");e.push({background:c});break;case 1:a.push(".pb-main .pb-list .pb-con");a.push(".pb-aside .pb-more");e.push({background:c});break;case 2:a.push(".skin-set .skin-setcolor .preview-box");break;case 3:a.push(".pb-aside .pb-user-info .ui1");a.push(".pb-aside .pb-block div");e.push({background:c});break;case 4:a.push(".pb-main .pb-list .pb-con .c1");
a.push(".pb-aside .pb-user-info .ui2");e.push({background:c})}e.push({background:c});return[a,e]},mergeMatch:function(b,c){for(var a=function(d){for(var j=d+1;j<b.length;j++)if(b[d]==b[j])return j;return""},e=function(d,j){b.splice(j,1);l.extend(c[d],c[j]);c.splice(j,1)},k=0;k<b.length;k++){var s=a(k);if(s){e(k,s);k--}if(k+1==b.length)break}return[b,c]},isDisable:function(b){return l(b).hasClass(this.disableClsl)||l(b).hasClass(this.disableClsr)},backSlide:function(b){var c=this.jq("#scheme-select"),
a=Number(c.css("margin-left").replace("px",""));this.ulPx=a;this.minus=b=="prev"?this.slidePx:-this.slidePx;this.setSlideBtn(this.minus+a);this.setBackSlide(c,b)},setBackSlide:function(b,c){if(c=="prev"){this.minus-=30;this.ulPx+=30}else{this.minus+=30;this.ulPx-=30}b.css("margin-left",this.ulPx+"px");if(this.minus!=0){var a=this;setTimeout(function(){a.setBackSlide.call(a,b,c)},1)}else this.sliding=false},setSlideBtn:function(b){var c=this.jq("#prev"),a=this.jq("#next"),e=this.jq("#slidePage"),k=
1,s=-(this.liNum-1)*this.slidePx;if(b==0){c.addClass(this.disableClsl);s<0?a.removeClass(this.disableClsr):a.addClass(this.disableClsr)}else{k=b/this.slidePx*-1+1;c.removeClass(this.disableClsl);b==s&&a.addClass(this.disableClsr);b>s&&a.removeClass(this.disableClsr)}e.html(k+"/"+this.liNum)},sixBoxColor:function(b){b=b.split("-");for(var c=this.jq("#color-area a"),a=[],e=[],k=[],s=[],d=0,j=c.length;d<j;d++){c.eq(d).attr("key",b[d].replace("#",""));c.eq(d).find("span").css("backgroundColor",b[d]);
var p=this.getChangeClass(d,b[d]),r=this.getPhotoColor(d,b[d]);a=l.merge(a,p[0]);e=l.merge(e,p[1]);k=l.merge(k,r[0]);s=l.merge(s,r[1])}a=l.merge(a,k);e=l.merge(e,s);a.push("html");e.push(this.getBackAttr());this.setPageStyle(a,e)},getChangeClass:function(b,c){var a=[],e=[];switch(b){case 0:var k="a, .feed-list .feed-filter a, .user-preview .user-total-box a, .user-preview .user-total-box a:hover, .gotop:hover";this.splitByChar(a,e,k,{color:c});if(q.getCfg("remind")=="0"){k=".menu .menu-custom, .menu .menu-over";
this.splitByChar(a,e,k,{background:c})}break;case 1:k=".sub-link, .feed-list .feed-info p a, .feed-list .feed-info span a, .feed-list .forward p span a, .gotop:link, .gotop:visited, .ft-con a, .icon-reply, .icon-del";this.splitByChar(a,e,k,{color:c});k="#home .home-current, #atme .atme-current, #comments .comment-current, #favs .favs-current, #systemnotice .systemnotice-current, #messages .messages-current, .nav-block .cur, .nav-block .cur:hover, .nav .defined-link a:hover, .nav .user-link a:hover, .tab-s4 a:hover, .tab-s4 .current, .tab-s4 .current:visited, .menu li, .menu .menu-bg, .menu .menu-bg .l-bg, .menu .menu-bg .r-bg";
this.splitByChar(a,e,k,{backgroundColor:c});break;case 2:k="html";this.splitByChar(a,e,k,{backgroundColor:c});k=".sub-menu a:hover, .sub-menu a.current";this.splitByChar(a,e,k,{color:c});a.push(".event-classify a:hover");e.push({color:c});k=".event-classify a.curr, .event-classify a.curr:hover";this.splitByChar(a,e,k,{color:c});a.push(".nav-block .cur");a.push(".nav-block .cur:hover");e.push({color:c});e.push({color:c});break;case 3:k=".user-sidebar .hd h3, .user-list-s1 .hd h3, .user-tag .tag-tit h3, .top10 .hd h3, .user-tag .hd h3, .user-preview .user-intro strong, .feed-list .feed-tit h3, .title-box h3, .column-title h3, .account-login h3, .recom-box .hd h3, .att-topic .hd h3, .events-title h3, .recent-event .hd h3, .tit-hd h3, .tit-s1 h3, .tab-s2 span a, .tab-s2 span a:visited, .tab-s3 span a, .tab-s3 span a:visited";
this.splitByChar(a,e,k,{color:c});break;case 4:a.push("body");e.push({color:c})}return[a,e]},splitByChar:function(b,c,a,e){b.push(a);c.push(e)},getBackAttr:function(){var b={},c=this.pwImg.attr("rel");b["background-image"]=c?"url("+(this.parseRel(c).u?this.pwImg.attr("src"):"")+")":'url("")';b["background-repeat"]=this.jq("#bg-repeat").attr("checked")?"repeat":"no-repeat";b["background-attachment"]=this.jq("#bg-fixed").attr("checked")?"fixed":"scroll";c="";if(c=this.jq("#align a.cur").attr("rel")){c=
this.parseRel(c).w;b["background-position"]=c=="1"?"left top":c=="2"?"center top":"right top"}return b},directSetRightBg:function(b){l("#container")[0].className=b[1];b=this.getPhotoColor(3,b[0]);this.setPageStyle(b[0],b[1])},setRightBackColor:function(){var b=this.getChangeClass(this.selectColorType,"#"+hex),c=this.getPhotoColor(this.selectColorType,"#"+hex),a=l.merge(b[0],c[0]);b=l.merge(b[1],c[1]);this.setPageStyle(a,b)},onactiontrig:function(b){switch(b.data.e){case "save":b={};if(this.custom)b=
this.getCustomData();else{if(this.switcher==""){m.alert("",h("请选择皮肤"));break}b={skin_id:this.switcher}}var c=this;t.saveSkin(b,function(a){if(a.isOk()){c.display(false);c.reload()}else m.alert("",a.getMsg())});break;case "cancel":this.reload();break;case "cs":this.custom=false;this.changeCss(b.get("sk"),b.get("id"));this.decorateSelected(b.src);break;case "bgLevel":this.photoBackTile(false);b.preventDefault(false);break;case "bgStrong":this.photoBackStrong(false);b.preventDefault(false);break;case "bgPlace":if(l(b.src).hasClass("cur"))break;
this.jq("#align .cur").removeClass("cur");b.src.className="cur";this.photoBackPlace(false);break;case "cls":this.selectColorObj=b.src;this.selectColorType=Number(b.get("t"));this.setBackColor("color-area",b.src);this.curColor=l(b.src).attr("key");this.showColorSelect(l(b.src).attr("title"));break;case "clbs":this.setBackColor("scheme-select",b.src);this.sixBoxColor(b.get("w"));break;case "slide":if(this.sliding||this.isDisable(b.src))break;this.sliding=true;this.backSlide(b.get("t"),b.src)}},addStyle:function(b,
c,a){var e=this.ieStyleId,k=document.getElementById(e);this.initIscustom||l("#"+this.customLinkId).remove();if(k==null){var s=document.getElementsByTagName("head")[0];k=document.createElement("style");k.setAttribute("type","text/css");k.setAttribute("id",e);s.appendChild(k);if(k.styleSheet)if(a&&a=="create")k.styleSheet.cssText=c;else{b=this.cssObjToString(b,c);k.styleSheet.cssText=b}else if(a&&a=="create")k.innerHTML=c;else{b=this.cssObjToString(b,c);k.innerHTML=b}}else if(k.styleSheet)if(a==="add"){b=
this.cssObjToString(b,c);k.styleSheet.cssText+=b}else if(a==="cover"){b=this.cssObjToString(b,c);k.styleSheet.cssText=b}else if(a==="cathe")k.styleSheet.cssText=c;else{a=k.styleSheet;k=a.rules;e=b.length;for(s=0;s<e;s++){var d=this.isMatchCss(k,b[s]);d>-1?this.setRulesAttr(k[d].style,c[s]):a.addRule(b[s],this.objectToString(c[s],false))}}else if(a==="add"){b=this.cssObjToString(b,c);k.innerHTML+=b}else if(a==="cover"){b=this.cssObjToString(b,c);k.innerHTML=b}else if(a==="cathe")k.innerHTML=c;else{a=
k.sheet.cssRules;e=a.length;for(s=0;s<e;s++){d=this.isMatchCss(a,b[s]);if(d>-1)this.setRulesAttr(a[d].style,c[s]);else(c=this.objectToString(c[s],false))&&k.sheet.insertRule(b[s],this.objectToString(c[s],false))}}},setRulesAttr:function(b,c){for(var a in c)b[a]=c[a]},isMatchName:function(b){var c=n.length;b=b.toLowerCase();for(var a=0;a<c;a++)if(b==n[a])return true;return false},isMatchCss:function(b,c){for(var a=0,e=b.length;a<e;a++)if(c==b[a].selectorText.toLowerCase())return a;return-1},cssObjToString:function(b,
c){for(var a=[],e=0,k=b.length;e<k;e++){var s=this.objectToString(c[e]);a.push(b[e]+"{"+s+"}")}return a.join("")},objectToString:function(b,c){var a="",e;for(e in b){var k=!c?this.getCssKey(e):e;a+=k+":"+b[e]+";"}return a.slice(0,-1)},getCssKey:function(b){switch(b){case "backgroundRepeat":return"background-repeat";case "backgroundAttachment":return"background-attachment";case "backgroundImage":return"background-image";case "backgroundPosition":return"background-position";case "backgroundColor":return"background-color";
default:return b}}}})});q.use("pipeMgr").reg("common.siteNav",{onViewReady:function(){var b=this.getUI(),c=[],a;q.on("api.unread",function(e){if(e.isOk()){if(!b.jqNewWb){b.jqExtra("referMe","myCmt","myMsg","myNotice");a={1:b.jqReferMe,2:b.jqMyCmt,4:b.jqMyMsg,5:b.jqMyNotice}}e=e.getData().unread;for(var k=0;k<e.length;k++)if(c[k]!==e[k]){var s=a[k];if(s){s.cssDisplay(e[k]);e[k]&&s.find("#t").text(e[k])}}c=e}})}}).reg("common.userPreview",{onViewReady:function(){var b=this;q.on("api.update",function(c){if(c.isOk()){c=
b.getUI().jq("#xwb_user_total_wb");c.text(parseInt(c.text())+1)}}).on("api.destroy",function(c){if(c.isOk()){c=b.getUI().jq("#xwb_user_total_wb");c.text(parseInt(c.text())-1)}})}}).reg("input",{ui:q.mod.PostBase,onViewReady:function(){this.getUI().initEx()}}).reg("wblist",i).reg("weibo.weiboList",function(){return new i({ui:{cls:q.mod.WeiboList,syncList:true}})}).reg("weibo.userTimelineList",function(){var b=u("page")=="index.profile";return new i({ui:{cls:q.mod.WeiboList,syncList:b}})}).reg("common.searchMod",
function(){return new g({onViewReady:function(){var b=document.getElementById("k");b&&o.focusEnd(b);l("#searchForm").bind("submit",function(){if(!l.trim(l("#k").val())){l("#searchTip").cssDisplay(true);l("#k").focus();return false}});l("#searchBtn").click(function(){if(q.util.byteCut(l.trim(l("#k").val()),30))l("#searchForm").submit();else{l("#searchTip").cssDisplay(true);l("#k").focus()}return false});var c=this.getUI();q.on("subrefresh",function(a){if(c.jq(".search-field").attr("rel").split(":")[1]==
a.subject){var e=c.jq(".search-field span:last a").attr("rel");if(e=="e:delSubject"||e=="e:addSubject")a.type=="add"?c.jq(".search-field span:last").replaceWith("<span>"+h("已关注")+'(<a href="javascript:;" rel="e:delSubject">'+h("取消关注")+"</a>)</span>"):c.jq(".search-field span:last").replaceWith('<span class="icon-follow"><a href="javascript:;" rel="e:addSubject">'+h("关注该话题")+"</a></span>")}})}})}).reg("user.fameList",function(){return new g({onViewReady:function(){this.getUI().jq().highlight(l("#k").val())}})}).reg("user.userSearchList",
function(){return new g({ui:{actionMgr:true,onactiontrig:function(b){switch(b.data.e){case "allTag":b.lock(1);t.postReq(t.apiUrl("action","getTags"),{uid:b.get("u")},function(c){if(c.isOk()){c=c.getData();var a=l(b.src);l(c).each(function(){var e,k;for(k in this)e=this[k];e!=l("#k").val()&&a.after('<a href="'+t.mkUrl("search","user&",{ut:"tags",k:e})+'">'+e+"</a>")});a.remove()}b.lock(0)});default:b.stopPropagation(false)}}},onViewReady:function(b){var c=l("#k").val(),a=this.getUI();switch(b.data.type){case "tags":a.jq("li p.tag").highlight(c);
break;case "sintro":a.jq("li div.u-info").highlight(c).highlight(c);break;case "nick":a.jq("li a.u-name").highlight(c).highlight(c)}}})}).reg("user.userSearchPreview",function(){return new g({onViewReady:function(){this.getUI().jq().highlight(l("#k").val())}})}).reg("weibo.weiboOnly",function(){return new i({onViewReady:function(){i.prototype.onViewReady.apply(this,arguments);this.getUI().jq("#xwb_weibo_list_ct").highlight(l("#k").val())}})}).reg("user.followersList",function(){return new g({ui:{cls:q.mod.HoverList,
itemSelector:"ul li",onMouseOver:function(){l(this).find("#removeFans,#sendMsg").removeClass("hidden")},onMouseOut:function(){l(this).find("#removeFans,#sendMsg").addClass("hidden")},actionMgr:true,onactiontrig:function(b){switch(b.data.e){case "ufl":var c=b.get("u"),a=b.get("n");m.confirm(h("提示"),h("确定要取消关注")+a+"?",function(e){if(e==="ok"){b.lock(1);q.request.unfollow(c,"",function(k){if(k.isOk()){var s=b.jq("u");s.slideUp(500,function(){b.lock(0);s.remove()})}else{b.lock(0);m.tipWarn(k.getMsg())}})}});
break;default:b.stopPropagation(false)}}}})}).reg("weibo.detail",function(){return new i({onViewReady:function(){i.prototype.onViewReady.apply(this,arguments);var b=this.getUI().jq("#xwb_cmt_list"),c=b.attr("wbid"),a=q.cfg.wbList[c].u.id,e=this.getUI().jq("#topCmtBox");q.use("MBlogCmtArea",{view:b[0],wbId:c,wbUid:a,topCmtBox:e[0],faceSize:50}).display(true).load()}})}).reg("common.message",function(){return new g({onViewReady:function(){this.jq("#messageList li").hover(function(){l(this).find("#del").cssDisplay(true)},
function(){l(this).find("#del").cssDisplay(false)});q.on("api.sendDirectMessage",function(b){b.isOk()&&location.reload()})}})}).reg("weibo.comments",function(){return new g({ui:{cls:q.mod.MyCmt}})}).reg("user.fansList",function(){return new g({ui:{cls:q.mod.HoverList,itemSelector:"ul li",onMouseOver:function(){l(this).find("#removeFans,#sendMsg").removeClass("hidden")},onMouseOut:function(){l(this).find("#removeFans,#sendMsg").addClass("hidden")}}})}).reg("user.outputCelebUserBlock",function(){return new g({ui:{selectedCS:"current",
actionMgr:true,onactiontrig:function(b){switch(b.data.e){case "ck":var c=b.jq("u").find("#pic");c.hasClass(this.selectedCS)?c.removeClass(this.selectedCS):c.addClass(this.selectedCS);break;case "sa":var a=b.src.checked,e=this.selectedCS;this.jq("#pic").each(function(){l(this).checkClass(e,a)});b.preventDefault(false);break;case "submit":var k=[];e=this.selectedCS;var s;this.jq("#pic").each(function(){if(l(this).hasClass(e)){s=q.ax.ActionMgr.wrapRel(this);k.push(s.get("u"))}});k.length?t.follow(k.join(","),
0,function(d){d.isOk()?l(b.src).replaceWith('<span class="followed-btn">'+h("已关注")+"</span>"):m.tipWarn(d.getMsg());b.lock(0)}):m.tipWarn(h("请选择您要关注的人。"))}}}})}).reg("user.hotUser",function(){return new g({onViewReady:function(){var b=this,c,a;this.jq("#followall-btn").click(function(){if(a)return false;var e=[],k;b.jq("li").each(function(){c=q.ax.ActionMgr.wrapRel(this);(k=c.get("u"))&&e.push(k)});if(e.length){a=true;t.follow(e.join(","),0,function(s){(a=s.isOk())&&b.jq("a[name=follow]").replaceWith('<span class="followed-btn">'+
h("已关注")+"</span>")})}return false})}})}).reg("category_user",function(){return new g({onViewReady:function(){q.use("Switcher",{items:this.jq("div.tab-s4>a"),contents:this.jq("div.column-body"),selectedCS:"current"})}})}).reg("component/component_1.run",function(){return new g({onViewReady:function(){var b=this.getUI();q.on("pipe.end",function(){q.use("Switcher",{items:b.jq("div.tab-s2>span"),contents:b.jq("div.hot-mblog-body"),selectedCS:"current"})})}})}).reg("component/component_common.hotWB_getComment",
function(){return new i({renderWeiboCounter:function(b,c){i.prototype.renderWeiboCounter.apply(this,arguments);if(c[0]){var a=c[0];if(a>=1E5){var e=a/1E4>>0;if(e>0){a=a%1E4/1E4>>0;a=a>0?"."+a:"";a=""+e+a+"万"}}b.find("#hotNum").text(a)}}})}).reg("component/component_common.hotWB_getRepost",function(){return new i({renderWeiboCounter:function(b,c){i.prototype.renderWeiboCounter.apply(this,arguments);if(c[1]){var a=c[1];if(a>=1E5){var e=a/1E4>>0;if(e>0){a=a%1E5/1E4>>0;a=a>0?"."+a:"";a=""+e+a+h("万")}}b.find("#hotNum").text(a)}}})}).reg("component/component_8.run",
function(){return new i({onViewReady:function(b){i.prototype.onViewReady.apply(this,arguments);var c=b.data.currRoute,a=b.data.page_id,e=q.use("Layer",{closeable:true,contextable:true,view:this.jq("#win_city")[0],onViewReady:function(){t.getProvinces(o.bind(this.onDataLoaded,this));var k=this;this.jq("#citys").click(function(s){s.target.tagName=="A"&&k.close()})},onDataLoaded:function(k){if(k.isOk()){this.provinces=k.getData().provinces;var s=this;this.jq("#sel-area").change(function(){s.changeProvince(this.value)})}},
changeProvince:function(k){if(this.provinces){var s=this;l.each(this.provinces,function(d,j){if(j.id==k){var p=[];l.each(j.citys,function(r,w){var x,y;for(r in w){x=r;y=w[r]}x=t.mkUrl(c,"",o.queryString({page_id:a,province:k,city:x+"#city"}));p.push('<a href="'+x+'">'+y+"</a>")});s.jq("#citys").html(p.join(""));return false}})}}});this.jq("#cityBtn").click(function(){e.display(true);return false})}})}).reg("common.subjectFollowed",function(){return new g({onViewReady:function(){this.getUI();var b=
function(c){l(c).hover(function(){l(this).attr("class","li-hover");l(this).append('<div class="li-bg" id="BG"></div>');l(this).find("span").removeClass("hidden")},function(){l(this).removeClass("li-hover");l(this).find("span").addClass("hidden");l(this).find("#BG").remove()})};q.on("subrefresh",function(){t.postReq(t.apiUrl("action","getAllSubject"),{},function(c){if(c.isOk()){l("#subjectCount ul li").remove();for(var a=c.getData(),e=0,k=a.length;e<k;e++){var s=a[e].subject;l(' <li rel="subject:'+
s+'"><a href="'+a[e].href+'">'+s+'</a> <span class="close hidden" rel="e:deleteSubject" title="'+h("删除")+'">x</span> </li>').appendTo(l("#subjectCount ul"))}l("#subjectCount ul li").each(function(){b(this)});l("#subjectCount").prev("div.hd").find("h3 span").html("("+c.getData().length+")")}else m.alert(h("提示"),c.getError())})});q.on("pipe.end",function(){l("#subjectCount ul li").each(function(){b(this)});q.use("action").reg("deleteSubject",function(a){l(a.src);a.lock(1);t.postReq(t.apiUrl("action",
"deleteSubject"),{text:a.get("subject")},function(e){e.isOk()?q.fire("subrefresh",{subject:a.get("subject"),type:"del"}):m.alert(h("提示"),e.getError());a.lock(0)})});var c=null;l("#addSubject").click(function(){if(c)c.display(true);else c=q.use("addFollow",{appendTo:l("#subjectCount").parent()})})})}})}).reg("event.eventinfo",function(){return new g({ui:{actionMgr:true,onactiontrig:function(b){var c=function(a,e,k){var s=q.use("postBox");a=e||a.get("m");k&&k=="share"&&s.setPostTitle(h("分享给大家"));s.display(true).reset().selectionHolder.setText(a||
"");a&&s.checkText()};switch(b.get("e")){case "join":b.get("other")=="1"?t.eventJoin({eid:b.get("eid")},function(a){if(a.isOk()){m.tipOk(h("参加成功！"),function(){c(b)});l(b.src).replaceWith('<a class="has-join-btn" href="#">'+h("已参加")+"</a>")}else m.tipWarn(a.getError())}):q.use("Box",{contentHtml:"evevtApplicants",actionMgr:true,cs:"win-apply win-fixed",closeable:true,title:"报名申请",appendTo:document.body,mask:true,autoCenter:true,onViewReady:function(){var a=this;this.jq("#contact,#note").keydown(function(){a.jq("#tips").removeClass("hidden");
a.jq("#wrong").addClass("hidden")})},onactiontrig:function(a){switch(a.data.e){case "sd":a=this.jq("#tips");var e=this.jq("#wrong");if(this.jq("#contact").val()==""){a.addClass("hidden");e.removeClass("hidden").html(h("请输入联系方式！"));break}if(l.trim(this.jq("#note").val())==""){a.addClass("hidden");e.removeClass("hidden").html(h("请填写备注"));break}if(o.calWbText(this.jq("#note").val(),100)<0){a.addClass("hidden");e.removeClass("hidden").html(h("备注长度超过100！"));break}var k=this;t.eventJoin({eid:b.get("eid"),
other:"2",contact:this.jq("#contact").val(),note:this.jq("#note").val()},function(s){if(s.isOk()){m.tipOk(h("参加成功！"),function(){c(b);k.close()});l(b.src).replaceWith('<a class="join-btn-disabled" href="#">'+h("已参加")+"</a>")}else m.tipWarn(s.getError())})}}}).display(true);break;case "sd":c(b,b.get("m1"),b.get("t"));break;default:b.stopPropagation(false)}}}})}).reg("event.eventinput",function(){return new g({ui:{actionMgr:true,exceedCS:"over-limit",onactiontrig:function(b){switch(b.data.e){case "sd":this.send(b.get("eid"),
b.get("a"),b);break;case "ic":q.use("emotion").setSelectionHolder(this.selectionHolder,this.checkText,this).showAt(b.src)}},onViewReady:function(){this.jqExtra("inputor","warn");var b=this;this.jqInputor.bind("keyup",function(){b.checkText()});this.selectionHolder=q.use("SelectionHolder",{elem:this.jqInputor[0]});this.checkText()},send:function(b,c,a){var e=this;a.lock(1);if(this.checkText())t.postReq(t.apiUrl("action","update"),{"extra_params[event_id]":b,doAction:c,text:this.jqInputor.val()},function(k){k.isOk()?
m.tipOk(h("发布成功"),function(){window.location.reload()}):m.tipWarn(k.getMsg(),function(){k.getCode()=="30000"&&e.jqInputor.val("#"+e.jq("p.title a").html()+"#")});a.lock(0)});else{a.lock(0);this.jqInputor.focus()}},checkText:function(){var b=l.trim(this.jqInputor.val()),c=o.calWbText(b);c>=0?this.jqWarn.html(h("您还可以输入{0}字",c)).removeClass(this.exceedCS):this.jqWarn.html(h("已超出{0}字",Math.abs(c))).addClass(this.exceedCS);return c>=0&&b}}})})})(Xwb,$);(function(q,l){var u=q.getCfg,t=q.request,o=q.util,m=this;q.on("pipe.start",function(g){o.ie6&&l("#logo").length&&l("#logo").fixPng();g||(g={});q.cfg=l.extend({},m.__gloCfg||{},g);q.use("action").bind(document.body);g.basePath&&t.init(g.basePath);if(q.getUid()){var h=g.remind,i=h?document.body:l("#xwbInnerNav")[0];i&&q.use("notice",{appendTo:i,remindType:h})}q.mod.shortlink.local=g.shortLink}).on("pipe.end",function(){if(q.cfg.wbList){var g=q.cfg.wbList,h=[],i;if(u("uid")){for(var b in g){h.push(b);
i=g[b];i.rt&&h.push(i.rt.id)}t.counts(h.join(","),l.noop);h=null}var c=q.ax.ActionMgr;q.mod.shortlink.from(g,function(){l(".feed-list ul>li").each(function(){var j=l(this),p=c.getRel(this,"w",this);if(p)if(p=g[p]){var r=p.shortlinks;r&&r.length&&q.mod.shortlink.renderWeiboShortlink(j,p,r)}})})}l("#xwb_search_form").each(function(){q.use("SearchEntry",{view:this}).display(true)});q.report.start();h=function(){q.report.report()};if(window.addEventListener)window.addEventListener("unload",h,false);else window.attachEvent&&
window.attachEvent("onunload",h);u("ads")&&q.mod.AdMgm.init(u("ads"));if(u("page")!=="ta"){var a=l("#new_wb_tips");a.length&&q.on("api.unread",function(j){if(j.isOk()){j=j.getData().unread[0];a.cssDisplay(!!j)}})}if(q.getUid()){var e=false,k=u("maxid"),s=function(){e=false;setTimeout(d,3E4)},d=function(){if(!e){e=true;t.unread(k,s)}};d()}l(".main-menu>li").slideMenu(">ul","menu-over");l("#gotop").each(function(){var j=l(document),p=l(this);l("#container");var r=true,w;p.css("bottom","95px");l(window).scroll(function(){if(j.scrollTop()==
0){if(!r){p.cssDisplay(false);r=true}w=false}else if(!w)if(r){p.cssDisplay(true);r=false}});p.click(function(){w=true;l("html,body").animate({scrollTop:0},150);return false})})});l(function(){l("#focus_index").each(function(){q.use("base",{actionMgr:true,view:this,onactiontrig:function(g){var h=g.data;switch(h.e){case "cls":l.cookie(g.get("cn"),1);this.display(0);break;case "do":g=h.op;if(g==1){g=q.use("postBox");q.use("postBox").display(true);g&&g.selectionHolder.insertText("#"+h.tp+"# ")}else g==
2&&h.ln&&window.open(decodeURIComponent(h.ln.replace(/\+/g,"%20")))}}}).display(true)});l("#xwb_today_topic").each(function(){l(this).find("p.feedback").substrText(80,1);l(this).find("div.column-item:first").removeClass("next");q.use("FadeBox",{view:this}).display(1)})});window.xwbPipe=q.ax.PipeMgr})(Xwb,$);
